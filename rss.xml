<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Tech Blog]]></title><description><![CDATA[Notes on tech by Matthew Curtis.]]></description><link>https://gatsby-starter-blog-demo.netlify.com</link><generator>GatsbyJS</generator><lastBuildDate>Fri, 13 Dec 2024 16:27:04 GMT</lastBuildDate><item><title><![CDATA[Korg Volca FM2 Full Cart SysEx]]></title><description><![CDATA[!! SENDING A CART WILL OVERWRITE THE PRESETS SAVED ON YOUR FM2 !! Korg flexes the FM2’s compatibility with the DX7 quite a bit: “completely…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/volca-fm2-cart/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/volca-fm2-cart/</guid><pubDate>Fri, 13 Dec 2024 03:25:23 GMT</pubDate><content:encoded>&lt;p&gt;&lt;strong&gt;!! SENDING A CART WILL OVERWRITE THE PRESETS SAVED ON YOUR FM2 !!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Korg flexes the FM2’s compatibility with the DX7 quite a bit: &lt;em&gt;“completely compatible with SYS-EX patches for the DX7”&lt;/em&gt; and &lt;em&gt;“full classic Sys-Ex compatibility”&lt;/em&gt; are right on the landing page for the FM2. However the manual is a bit more obtuse: &lt;em&gt;“sound files (SYS-EX/SYX) created on the Yamaha DX7 can be converted and loaded into the volca fm”&lt;/em&gt; and &lt;em&gt;“the MIDI IN jack can be used…to receive SYX (Yamaha DX7) sound data files”&lt;/em&gt; aren’t particularly useful.&lt;/p&gt;
&lt;p&gt;As I was writing an email to Korg I finally figured it out, and while it seems obvious now, I thought I’d share the process.&lt;/p&gt;
&lt;h2&gt;tl;dr&lt;/h2&gt;
&lt;p&gt;Just send the cart SysEx using something like &lt;a href=&quot;https://www.snoize.com/SysExLibrarian/&quot;&gt;SysEx Librarian&lt;/a&gt;.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Connect the FM2 to your MIDI interface&lt;/li&gt;
&lt;li&gt;Download a cart&lt;/li&gt;
&lt;li&gt;Drag it into SysEx Librarian&lt;/li&gt;
&lt;li&gt;Hit the “Play” button&lt;/li&gt;
&lt;li&gt;Go through the presets&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;It won’t be immediately obvious that anything happened because the current patch is in memory and loaded from the previous cart. When you change patches you’ll see the patches from the new cart.&lt;/p&gt;
&lt;h2&gt;A little more in-depth&lt;/h2&gt;
&lt;h3&gt;1. Connect the FM2 to your MIDI interface&lt;/h3&gt;
&lt;p&gt;Not all MIDI interfaces are created equally; the cheaper ones notoriously have trouble handling SysEx messages. MIDI interface out to FM2 MIDI in obviously.&lt;/p&gt;
&lt;h3&gt;2. Download a cart&lt;/h3&gt;
&lt;p&gt;This is about sending a full cart (32 presets as opposed to 1 preset) and there are plenty to choose from online. &lt;a href=&quot;https://asb2m10.github.io/dexed/&quot;&gt;Dexed&lt;/a&gt; comes with several and you can find a bunch at &lt;a href=&quot;https://yamahablackboxes.com/collection/yamaha-dx7-synthesizer/patches/&quot;&gt;Yamaha Black Boxes&lt;/a&gt;. The file type must be &lt;code class=&quot;language-text&quot;&gt;.syx&lt;/code&gt;.&lt;/p&gt;
&lt;h3&gt;3. Drag it into SysEx Librarian&lt;/h3&gt;
&lt;p&gt;Download, install, and open &lt;a href=&quot;https://www.snoize.com/SysExLibrarian/&quot;&gt;SysEx Librarian&lt;/a&gt; on Mac (&lt;a href=&quot;http://www.midiox.com/&quot;&gt;MIDI-OX&lt;/a&gt; might be a good option for Windows, as recommended by &lt;a href=&quot;https://www.sweetwater.com/sweetcare/articles/how-do-i-send-and-receive-sysex-on-pc-or-mac/#SysEx-MIDI-files-on-PC&quot;&gt;Sweetwater&lt;/a&gt;). Drag the &lt;code class=&quot;language-text&quot;&gt;.syx&lt;/code&gt; file into SysEx Librarian and make sure it’s set up to use your MIDI interface.&lt;/p&gt;
&lt;h3&gt;4. Hit the “Play” button&lt;/h3&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/8418e739e146429e26fa9bfcfd24482e/e9131/sysex-lib.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 60.13513513513513%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACCklEQVQoz52RXW8SQRSG+dEmpjHV3pteGG+88IoYUpVSrSItNSJt2igspeV7qXzstkBXapWyC8wu7ONhqbGJmphePHlnzpnz7juzoXTsOftHSbLlEpViieqnfWpahupRHr1Q4DibQctkyAgF2et6jWK5SjZfIZ8/RNM0isUiuVyOnZ0dQptbSepbb2l+PkA/62FtRLDSSc7zOXo5DWM3zVmlgtXv0zu3uOhb1I0LElmLvXSK+LsEpXKZl9Eo29vbhFIy0Ext0Y+/wCwc0u51MYwWZrtJq3lCtVTgRK/IvoHZatBq1KmWi9RrciPpHcuH9WqJWqXEx9QHQivhI1aTlyxF+zx+csCjpxpL699Yfv094MHbK+6/umR5vb8garG6ecq9NYO7az3uPDNY2fjKw/gFb3arhEx5L2/vPVc+2GqKY7Sx63Xs7vkCw2Q4GDIcuwxHClt0LOdGygvWzsRj6Exwp3DypUGoU8jjS3x3OsVV0gC8wQ+m3VM8eS+vI+oMpe/huu416prFWiklUz6NhhietdvMRiMmUlRyYN5UYq58HzWbiYLyvEV93v8L81nf/2XY7TIT/8nNAaX+5B9mC8PJb8NOp8NsnkSpG1f6P9S1BgklVGDYNoygYNs2tuPcCkdw5Vlqui5/2TSDdOPx+FbMZweDQaBBwkgkQiKRIB6P35pYLBZoOBzmJ6WyZp/s3mT/AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Location of important parts of SysEx Librarian&quot;
        title=&quot;Location of important parts of SysEx Librarian&quot;
        src=&quot;/tech-blog/static/8418e739e146429e26fa9bfcfd24482e/fcda8/sysex-lib.png&quot;
        srcset=&quot;/tech-blog/static/8418e739e146429e26fa9bfcfd24482e/12f09/sysex-lib.png 148w,
/tech-blog/static/8418e739e146429e26fa9bfcfd24482e/e4a3f/sysex-lib.png 295w,
/tech-blog/static/8418e739e146429e26fa9bfcfd24482e/fcda8/sysex-lib.png 590w,
/tech-blog/static/8418e739e146429e26fa9bfcfd24482e/e9131/sysex-lib.png 614w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Top left corner, it’s a big button that says “Play” on it. It’ll take a second to send the SysEx. If you have an indicator on your MIDI interface you should see activity on that, but the FM2 doesn’t hint that it’s receiving MIDI.&lt;/p&gt;
&lt;h3&gt;5. Go through the presets&lt;/h3&gt;
&lt;p&gt;This is where I got confused. SysEx Librarian send the &lt;code class=&quot;language-text&quot;&gt;.syx&lt;/code&gt;, my MIDI interface showed that it was sending the &lt;code class=&quot;language-text&quot;&gt;.syx&lt;/code&gt;, but nothing happened on the FM2 - the patch I had loaded from the old cartridge was still loaded after sending the new cartidge.&lt;/p&gt;
&lt;p&gt;I imagine what’s happening is that the patch is loaded into memory and hangs around regardless of what cart is loaded. When you change the patch, it’ll load them from the new cart and the in-memory patch will disappear.&lt;/p&gt;
&lt;h2&gt;Bonus: some carts I found online&lt;/h2&gt;
&lt;p&gt;I like to mirror things in case sites go down.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Finetales&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/2e13b7856d5ba1ad00623c831b9822fe/finetales1.syx&quot;&gt;1: EPs and bells&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/965917868cde7c09f8ea8953986a96d8/finetales2.syx&quot;&gt;2: plucks, basses, brass&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/8e0d5bb71759b6da4c49c332ed4045fd/finetales3.syx&quot;&gt;3: strings, pads, etc&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Yamaha Black Boxes&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Factory&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/4a0513cc8cf3b9ddfafb4cdcd9f9b4a9/rom1a.syx&quot;&gt;ROM1A Master&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/ddc88c9d55235f1546b499ad76431540/rom1b.syx&quot;&gt;ROM1B Keyboard &amp;#x26; Plucked&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/9e3da5e0b7c75834f95c1fcda25268a2/rom2a.syx&quot;&gt;ROM2A Orchestral &amp;#x26; Percussive&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/3b2a0479de029137cd32b6a8ed98ce9e/rom2b.syx&quot;&gt;ROM2B Synth, Complex &amp;#x26; Effects&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/d86d38f0db0b5158b9355a183467d96e/rom3a.syx&quot;&gt;ROM3A Master&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/e53fb9b59f50aaa67cd52c941d4b8b1f/rom3b.syx&quot;&gt;ROM3B Keyboard &amp;#x26; Plucked&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/00e4418d42bc4c5dc48ba3934a8a10fc/rom4a.syx&quot;&gt;ROM4A Orchestral &amp;#x26; Percussive&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/8fab437e457c807baf5f06d5198d9c6a/rom4b.syx&quot;&gt;ROM4B Synth, Complex &amp;#x26; Effects&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;VRC Voice ROMs&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/d75a1ac7a14c4701a75320d5f34601be/vrc101a.syx&quot;&gt;VRC101A Keyboard, Plucked &amp;#x26; Tuned Perc.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/77682e9dcd820b4b9b5e30d7a9287289/vrc101b.syx&quot;&gt;VRC101B Keyboard, Plucked &amp;#x26; Tuned Perc.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/6dd348a1bcab4280d283bb5fa6264194/vrc102a.syx&quot;&gt;VRC102A Wind Instrument&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/e9ca356aee89b859b50786cb2d121755/vrc102b.syx&quot;&gt;VRC102B Wind Instrument&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/e41cb92227dd6fabe9192d57ce4c36df/vrc103a.syx&quot;&gt;VRC103A Sustain&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/f59dee5f108bee8c51742e6dba2e2cb3/vrc103b.syx&quot;&gt;VRC103B Sustain&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/6bcfc4173b5a1c7741d815e0cef85846/vrc104a.syx&quot;&gt;VRC104A Percussion&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/53deea4d08fb00cc5b94199212c64764/vrc104b.syx&quot;&gt;VRC104B Percussion&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/5e0bcd0c67169157195bf4fe4355e1b9/vrc105a.syx&quot;&gt;VRC105A Sound Effect&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/8f58bf32a944bab0eef94dd633292422/vrc105b.syx&quot;&gt;VRC105B Sound Effect&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/2bfb353b9d18f6de0b9f97a18e4a353a/vrc106a.syx&quot;&gt;VRC106A Synthesizer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/2db2179f5b1d4d54d74c18ac0f8c2bb6/vrc106b.syx&quot;&gt;VRC106B Synthesizer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/9abac8ea417f81b41252957bf86fdcb1/vrc107a.syx&quot;&gt;VRC107A David Bristow Selection&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/6476e6f3dfcfee29491564fcb90b3bde/vrc107b.syx&quot;&gt;VRC107B David Bristow Selection&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/2b0914e424fe76143f373ea570315b63/vrc108a.syx&quot;&gt;VRC108A Gary Leuenberger Selection&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/6b42763f309de57cefbc73550e4f7dbf/vrc108b.syx&quot;&gt;VRC108B Gary Leuenberger Selection&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/a093d77caf59a4752e6042da7c446e75/vrc109a.syx&quot;&gt;VRC109A Studio 64&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/2ab2811b2e9b341333dc0c38e46b715e/vrc109b.syx&quot;&gt;VRC109B Studio 64&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/47821f812d008598a6231e99df056d9a/vrc110a.syx&quot;&gt;VRC110A Bo Tomlyn Selection&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/5f147c40495f9a301288b7e6020f65b0/vrc110b.syx&quot;&gt;VRC110B Bo Tomlyn Selection&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/f8dacea488f4e448db3aec93ab7534ff/vrc111a.syx&quot;&gt;VRC111A Bo Tomlyn Selection II&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/15e348209aa557e7b37953b71ff005e2/vrc111b.syx&quot;&gt;VRC111B Bo Tomlyn Selection II&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/0949a5eb06ace2e520d6b185781ed41f/vrc112a.syx&quot;&gt;VRC112A Live 64 - Akira Inoue&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/c2830c9df267e289b192d7b968a495e9/vrc112b.syx&quot;&gt;VRC112B Live 64 - Akira Inoue&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;GreyMatter E! Card&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/3d5439011d8d5c2e81a56382f390d6ce/greymatter2.syx&quot;&gt;Soundbank Disk #2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/bd9afa871cfd36195d2d27227486da85/greymatter5.syx&quot;&gt;Soundbank Disk #5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/tech-blog/547ebb965a86d8580693c549b48dc15a/greymatter7.syx&quot;&gt;Soundbank Disk #7&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Grandbot: Buttons]]></title><description><![CDATA[Disclaimer: I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I think I learned…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/grandbot-update-buttons/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/grandbot-update-buttons/</guid><pubDate>Fri, 15 Nov 2024 03:25:23 GMT</pubDate><content:encoded>&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/e7948c7067beba4bebeb0ce8453fddb3/c58a3/grandbot-buttons.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 66.89189189189189%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAABAACA//EABUBAQEAAAAAAAAAAAAAAAAAAAIA/9oADAMBAAIQAxAAAAECsdSnzaP/xAAaEAADAAMBAAAAAAAAAAAAAAABAgMAEiER/9oACAEBAAEFAgTpGvQXYeb4qhclyf8A/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8Bh//EABURAQEAAAAAAAAAAAAAAAAAAAAS/9oACAECAQE/AVP/xAAZEAADAQEBAAAAAAAAAAAAAAAAAREhAhD/2gAIAQEABj8Cs8qVNMRzD//EABkQAAMBAQEAAAAAAAAAAAAAAAABESExUf/aAAgBAQABPyFR8oMtdzwkGnpGOBPegiSSKH//2gAMAwEAAgADAAAAENcf/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARQf/aAAgBAwEBPxBfbC//xAAXEQADAQAAAAAAAAAAAAAAAAAAAREh/9oACAECAQE/EE9KP//EABwQAQEBAAIDAQAAAAAAAAAAAAERACFBMVFhgf/aAAgBAQABPxBY0RF7/M+kBVYm6g7DudePT5ycV4P0wQZWH3f/2Q==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Grandbot with six buttons for controlling his sequencer&quot;
        title=&quot;Grandbot with six buttons for controlling his sequencer&quot;
        src=&quot;/tech-blog/static/e7948c7067beba4bebeb0ce8453fddb3/1c72d/grandbot-buttons.jpg&quot;
        srcset=&quot;/tech-blog/static/e7948c7067beba4bebeb0ce8453fddb3/a80bd/grandbot-buttons.jpg 148w,
/tech-blog/static/e7948c7067beba4bebeb0ce8453fddb3/1c91a/grandbot-buttons.jpg 295w,
/tech-blog/static/e7948c7067beba4bebeb0ce8453fddb3/1c72d/grandbot-buttons.jpg 590w,
/tech-blog/static/e7948c7067beba4bebeb0ce8453fddb3/a8a14/grandbot-buttons.jpg 885w,
/tech-blog/static/e7948c7067beba4bebeb0ce8453fddb3/fbd2c/grandbot-buttons.jpg 1180w,
/tech-blog/static/e7948c7067beba4bebeb0ce8453fddb3/c58a3/grandbot-buttons.jpg 1500w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I &lt;strong&gt;think&lt;/strong&gt; I learned, but that doesn’t make it the truth.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Project originally inspired by the work of &lt;a href=&quot;https://twitter.com/MohitBhoite&quot;&gt;Mohit Bhoite&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;I’ve been having a lot of fun adding features to &lt;a href=&quot;https://github.com/handeyeco/Grandbot&quot;&gt;Grandbot&lt;/a&gt;’s generative sequencer and while each setting is adjustable with MIDI CC, it was becoming a pain in the ass to maintain the different tools I had for sending MIDI CC to Grandbot. I decided to make a menu system and add a new PCB with buttons for navigating the menu.&lt;/p&gt;
&lt;h2&gt;The PCB&lt;/h2&gt;
&lt;p&gt;The PCB is dead simple: 6 buttons. I added some pads on the back in case I wanted to add pull-up resistors, but the Arduino has built-in pull-up resistors so I don’t see the point. Debouncing the buttons has been a little bit of a pain (I’ll cover that in a bit), so I might eventually add hardware debouncing but that seems like it might be more trouble than it’s worth.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/983852102685fe347f93667e2e5d337c/94829/kicad-front.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 99.32432432432432%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAERklEQVQ4y5WT21NTVxSHU9o3C7XWdkQuCRAhXJKTc89JQkg44eJgFMRBpYxSZ+zF+tIZlSoj0hFICJBAgAAite20Y+30f/y6TsTRcfrQPqzZl7PPt3/rt9b2jQVi3A44DAVsTpzspeGTHur/azR0U3+qjzcMt9XCN6OO0rn5M1d7s/g+DuGr7/5f8VF9D9fMC3SVj5gOZfB9p7ncmZhluj2OT26tk0MfvImGd+bvrxt6BBii7mQft7pS3B6aZqbdwTdnDvBHm8Jsq45PPn4oh+vkx7p3x/p/WXtzL6NTEe4GdF52adz0GPesNAfdFjN+Q26UW090SYTeRs2G4/H9uXf20zDftpkcKg43PMZ9DxgyuSubmt/CbtaxmnTMJg2rxcBo1NA+V9C/iGKelflpBeOMWgvd2282eNAhwEiMmx7wgTHATo9NubGPaqtCqU2n0mWzE4pRalE5dNL8NXWJPy/nODD7+Xt6ghdplxeZLK+u5HieyLDaqlKNOMz69dcKn3VofB0f53trnNXeMIuuRnlEIx+KUlESvMidZz81yI6d4tfxsdq8mkhzNDTKrpWiKKB9Jf4WeBjUuW2Pc8cZp3xWodCh8jgQZalJZVuAe6JyW0vyTJRVYyn2+zOUQjYbhkGpJ8ZaRGcrpDHboh+nHJaPgT62/RGKhs5TM8yKHaEQ1tiM2BykU2yrCYENUO6NSdg15cVUlCd+hSVb4SAZ51ZAGvuBJkDDYiGjU0jo5PsN8rrNluwtpQyWnCirrsraOaPmVTGgSagUpFUW+xXyAaV2puIB/R5Q+vC5NUBeqvq4JcriaZWXuYv8nrvEymeStkDmpb+2+xICjFJsE2CrRFOUnRHxUk+x0q2zFjxOec5IU1FNnqSj5ONRCkmNdVOqbMVY7td46kjqrsK6KCz6VVbF1824wXJYpyg27I0lKDSqbMm32YDxWuGOeLLcabARNFk1BG5GWIlJlVWbYlD2uw3W2vVaymUpxuZgkoVzCgvtCsuqXOIXr8WGWf8xcDdkUWgWf+TDqsjOy23zTaIsaLMrKrbCcbajCal0goqkXhg0KUiFvVSXBwXY8g5wTtqmIkAPsiawFU3SlEMbrviWTEr1BtmTntuLp9lPZtiXRt4MO2xJ3xWbtVqR8qK8JONroCg8FENrFfQ8kij3xdjosuTHWK3vKp5XzkANWnVkHY2LaqcWFVHuratNYb7yGvsHPcPD/hzLrQbr3THW5Zb8mSglqWypXaCSYjloyZM0KXfG2OqwWZe363m7JuO6eLvS6XBfH5W3bOP70hzj9N5L6bnz/DYzRHkiI09PfJtyORgf4JeJNLtTWUpDDqWsw7MbLkcX3Bq01KFTbYlw37lA49ErrvcM4rseTPBNZ5pH8WGeXB1hYdLlp2vDLEwN8+iyy/xkljuXh3gk+4+vSFx3WZzMMZ8Z5cdElofJLHPJYe5lLjIZSvIPxkPNaUhtSdwAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Kicad design of the front of the PCB&quot;
        title=&quot;Kicad design of the front of the PCB&quot;
        src=&quot;/tech-blog/static/983852102685fe347f93667e2e5d337c/fcda8/kicad-front.png&quot;
        srcset=&quot;/tech-blog/static/983852102685fe347f93667e2e5d337c/12f09/kicad-front.png 148w,
/tech-blog/static/983852102685fe347f93667e2e5d337c/e4a3f/kicad-front.png 295w,
/tech-blog/static/983852102685fe347f93667e2e5d337c/fcda8/kicad-front.png 590w,
/tech-blog/static/983852102685fe347f93667e2e5d337c/94829/kicad-front.png 878w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/d93b51fa9d90f8e247b00e6750863f14/9c177/kicad-back.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 99.32432432432432%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEd0lEQVQ4y32Ua1NTVxSG40xtcay9jE6ntVYQBAIkEBMEAoRcFBGQay5ASEhOSE5CEAKKyE0qtioUMUggcp2OdTr9CX7qb3u6zol1HD/44Z21zz5rvXtd3r0Npa4UFb7HlDqTFP1g44vzVk5f+BxsH9ZfCLSYMk9aOH7liiOO4ar3EUV//8tl7zJffl2JQYfxvf0cCj5aTHFwTeco71vCUD+wiHXmhNLbc5z+rhrDuSpOfVOw/68//f7YajEVvcuUxl5R4kxhaPWv4EiccPX2PKe/FyeN4NuaD0Sfg+arEVb3P+Zy6yTny29haPEtY0+eUNYxx6mzZRi+EpwRFL23Zz76LvpkX9ZajLF3hZL2OX6q8wqhZGhPHGHyPcXkSVAjqHIXbLkzTklrXG92teyZbyQwulWKWxOUOFT5n6Ba/GpHNil2Z4RwEEOzEDYn9rGM5XCljvBMHL63RzSrh1xTDnQ4Zc+VOqYttU99LIctmsUez+MYP6A+kudiS5ILlZ2FDBvjx1QF92iM5gQH3FR3Gbybpyedp19sU3SH2tFt3ccxNscddYLumELb6AI/Zo4om8xTeWuen61+DI2iwc70cxzKEtejL+lU78uJe7gTezREd2WdE4iN7mP0b1Hl25RqdqkL5zDLAVfV15RG87TJHOy+FQxNOuFTXLFFbJFtOmJpLMEsN5J5GpWcBGqkWZzKMlbvA7pTM9xKCKIqXckM9jFJJrxAW0Kq61/A0OBd405qhRvRKQncoisUoG5oU6T0Gkt4Rw6RTCObdMancAVTeJR7tKtbcsBzOhKzYpdoj6hCmMXSu6gNZZXW+A51wQ2uje1gCTymZugF5lBOL0vDNSnZEnqJyf+M8pE94vNvGMy8oWJkF2tkB/Nolua4DKvvoQg78EimdSANz8sgMlhHfsMVXaQ7/ZCa0Ty1UrIt9JSBZIybowrelIInviyZ3md4ehxnME1nyIsnmaW+f0mb8iNdNjXBHO7ILFU98zSMLOKILmESQmt0D+e4ZDG0QbVvA7uyjl2m2+ifxja8inl4i2ZplWPiGGvvw4JsNMLq4C69qsp17zyO0Xt0xGf1rJsSh3TMvJXSd4TwD11/9eHnWCTO7H8icnqFW1qm6bdxYKGQoRZkCm5jUQ7pmf1LeraHKZTXSWwieEdE+hfYwBjYxq2u0RmbpEuJ0za+Jr3O45RL4Jx6IxnOFx6HNo1gZFsaLLclkcck5WkE5tAOdvWI9okDKXmdWt8TKgd+p8r/gooBaUFAhhdYpyN9jGd8v1CyZXCJ0tW3VIayukT6H/wjE83Kk/SEmsAr0eKeDCqL0fuC2qEtjH3PqLizRp1/nYruVRpkwpXhbS4u/El55xyGct8q507eUZ3c129Dk3qi3wxfOoOSiTMyNU1weppB6a//7jTK3AzhqQnCkwmCU2nCExNYM3nOHr2jok90eMk2zJXrY5S0xOQFiVPcovCLPYbJNYDFdRuzsweTowtjoxtzWxe1rm4snj7Mrl5Bj46ylghXGhQuWQP8B3KD/JZbNNe/AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Kicad design of the back of the PCB&quot;
        title=&quot;Kicad design of the back of the PCB&quot;
        src=&quot;/tech-blog/static/d93b51fa9d90f8e247b00e6750863f14/fcda8/kicad-back.png&quot;
        srcset=&quot;/tech-blog/static/d93b51fa9d90f8e247b00e6750863f14/12f09/kicad-back.png 148w,
/tech-blog/static/d93b51fa9d90f8e247b00e6750863f14/e4a3f/kicad-back.png 295w,
/tech-blog/static/d93b51fa9d90f8e247b00e6750863f14/fcda8/kicad-back.png 590w,
/tech-blog/static/d93b51fa9d90f8e247b00e6750863f14/9c177/kicad-back.png 880w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Obviously I also needed to expose these pins from the main Grandbot PCB.&lt;/p&gt;
&lt;h2&gt;The menu tree&lt;/h2&gt;
&lt;p&gt;90% of the work was adding the code to support a menu tree (&lt;a href=&quot;https://github.com/handeyeco/Grandbot/pull/4&quot;&gt;here’s the PR&lt;/a&gt;).&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I refactored existing settings into a Setting struct so that settings could be responsible for themselves when it came to things like managing their MIDI CC number, incrementing/decrementing, displaying their name/value, and “rolling the dice” during sequence generation. A lot of this work had to do with mapping 0-127 (the MIDI CC range) into finite steps that made sense for each parameter; for example most chance parameters map 0-127 to 0-99% whereas the MIDI out option needed to map 0-127 to 1-16.&lt;/li&gt;
&lt;li&gt;Then there’s the SettingManager which holds a reference to each setting. It triages MIDI CC, but it also maintains the menu state so it knows what parameter to update and when.&lt;/li&gt;
&lt;li&gt;I refactored my original button logic since I went from 1 to 6+1 buttons. There’s a Button struct, which handles the individual button state, and a ButtonManager struct, which manages things like button combos.&lt;/li&gt;
&lt;li&gt;Stepper is a utility struct for doing the basic math I was repeatedly struggling with.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The tl;dr of how this all works:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;There’s a &lt;code class=&quot;language-text&quot;&gt;menuStage&lt;/code&gt; variable that determines if we’re out of the menu (0), choosing a submenu (1), or in either the sequence submenu (2) or the settings submenu (3)&lt;/li&gt;
&lt;li&gt;There’s a &lt;code class=&quot;language-text&quot;&gt;menuIndex&lt;/code&gt; variable that determines where in the menu we are&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;So when we hit the increment or decrement button:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Look at &lt;code class=&quot;language-text&quot;&gt;menuStage&lt;/code&gt; to see which submenu we’re in&lt;/li&gt;
&lt;li&gt;Use &lt;code class=&quot;language-text&quot;&gt;menuIndex&lt;/code&gt; to get a reference to the Setting struct stored in that submenu’s array of setting references&lt;/li&gt;
&lt;li&gt;We tell the Setting to increment or decrement&lt;/li&gt;
&lt;li&gt;We ask the Setting what should be rendered on the 4D7S display&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;By offloading a lot of this logic to the Setting structs, we don’t have to maintain complicated if/else/switch logic and it’s a breeze to add new parameters to the menu.&lt;/p&gt;
&lt;h2&gt;Debouncing&lt;/h2&gt;
&lt;p&gt;Debouncing sucks and it sucks even more when trying to do button combos. My dream was to be able to enter/exit the menu with a combo and to use things like combos to trigger events or speed up increment/decrement actions. I made it happen, but it was a pain!&lt;/p&gt;
&lt;p&gt;I ended up using the method explained by &lt;a href=&quot;https://hackaday.com/2015/12/10/embed-with-elliot-debounce-your-noisy-buttons-part-ii/&quot;&gt;Elliot Williams on Hackaday&lt;/a&gt;. Basically what it’s doing is maintaining a history of button reads and only considers it a press/release when the history matches a certain expected state. &lt;a href=&quot;https://github.com/handeyeco/Grandbot/pull/8&quot;&gt;Here’s the PR&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;c++&quot;&gt;&lt;pre class=&quot;language-c++&quot;&gt;&lt;code class=&quot;language-c++&quot;&gt;#define BUTTON_MASK 0b11000111

void Button::read() {
  bool read = digitalRead(pin);

  // Debounce method tracks state over several reads
  history = history &amp;lt;&amp;lt; 1;
  history |= (read == false);

  pressed = false;
  released = false;

  // handle press
  if ((history &amp;amp; BUTTON_MASK) == 0b00000111) {
    pressed = true;
    history = 0b11111111;
  }
  // handle release
  else if ((history &amp;amp; BUTTON_MASK) == 0b11000000) {
    released = ignoreRelease ? false : true;
    ignoreRelease = false;
    history = 0b00000000;
  }

  held = history == 0b11111111;
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It works &lt;em&gt;reasonably&lt;/em&gt; well, but it can still be a little flaky. Some possible solutions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I used a bunch of analog pins on the Arduino for the buttons. I thought it would be nice to expose these pins because it meant that people could make their own custom Grandbot boards and they would be able to use the analog pins as both an analog and a digital input (because you can do &lt;code class=&quot;language-text&quot;&gt;digitalRead&lt;/code&gt; on analog pins). While this &lt;em&gt;is&lt;/em&gt; true, apparently analog pins can be slightly slower than digital pins when reading. I’m not confident this is part of the problem, but it’s just something I read about while researching the debouncing issues.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://hackaday.com/2015/12/09/embed-with-elliot-debounce-your-noisy-buttons-part-i/&quot;&gt;In part 1 of Elliot’s writing on debouncing&lt;/a&gt;, he talks about adding a resistor and a cap to each button to smooth the transitions from high to low. This wouldn’t be the worst thing ever - I could add 6*2 SMT pads to the back of the new PCB - but if you continue reading he also recommends Schmitt-trigger inverter on each button. A single 74HC14 would do the trick (I think) since it has 6 inverters on it…I might still do this, but it’s a very small PCB already and adding 12-19 more components would get crowded.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Confusingly it seems to get better or worse depending on some unknown variable. Ultimately though the software debouncing has been working well enough.&lt;/p&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Ultimately the new board has made playing with Grandbot even more fun and the refactored code has made adding features a breeze. Since adding the board:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Grandbot works with his own MIDI clock now&lt;/li&gt;
&lt;li&gt;I added a button combo for Drift mode (an endless Slip mode)&lt;/li&gt;
&lt;li&gt;I added a button combo for parameter randomization and reset&lt;/li&gt;
&lt;li&gt;There’s a 303-style legato parameter&lt;/li&gt;
&lt;li&gt;There’s a global output transpose setting&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I still have a lot of ideas to come!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[MiniDexed PCB]]></title><description><![CDATA[Disclaimer: I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I think I learned…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/minidexed-pcb/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/minidexed-pcb/</guid><pubDate>Sun, 29 Sep 2024 03:25:23 GMT</pubDate><content:encoded>&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/d1772ca83631c2e1e89c19a721659e51/c58a3/header.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 66.89189189189189%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQCAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABsXmiLxkkv//EABkQAAIDAQAAAAAAAAAAAAAAAAACAQMRQf/aAAgBAQABBQJ7ZFsw0sXZ7L6f/8QAFhEBAQEAAAAAAAAAAAAAAAAAABEx/9oACAEDAQE/AcV//8QAFhEBAQEAAAAAAAAAAAAAAAAAABES/9oACAECAQE/AbWX/8QAGhAAAgIDAAAAAAAAAAAAAAAAABEhMQFxkf/aAAgBAQAGPwJRtiyUWQS+n//EABsQAQADAAMBAAAAAAAAAAAAAAEAESExYXGB/9oACAEBAAE/IQ5BXCgVtr8j2SibHkGlWky3ZcHSo//aAAwDAQACAAMAAAAQA+//xAAXEQEAAwAAAAAAAAAAAAAAAAABEBEh/9oACAEDAQE/EAVa5H//xAAXEQEAAwAAAAAAAAAAAAAAAAABEBFB/9oACAECAQE/EECth//EABsQAQEBAQADAQAAAAAAAAAAAAERIQAxUYGh/9oACAEBAAE/EH5FjCvw17yeIjGLpLu9doh0Tz77Txv3hOdo2fvNREKiO//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Complete MiniDexed build with custom PCB&quot;
        title=&quot;Complete MiniDexed build with custom PCB&quot;
        src=&quot;/tech-blog/static/d1772ca83631c2e1e89c19a721659e51/1c72d/header.jpg&quot;
        srcset=&quot;/tech-blog/static/d1772ca83631c2e1e89c19a721659e51/a80bd/header.jpg 148w,
/tech-blog/static/d1772ca83631c2e1e89c19a721659e51/1c91a/header.jpg 295w,
/tech-blog/static/d1772ca83631c2e1e89c19a721659e51/1c72d/header.jpg 590w,
/tech-blog/static/d1772ca83631c2e1e89c19a721659e51/a8a14/header.jpg 885w,
/tech-blog/static/d1772ca83631c2e1e89c19a721659e51/fbd2c/header.jpg 1180w,
/tech-blog/static/d1772ca83631c2e1e89c19a721659e51/c58a3/header.jpg 1500w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I &lt;strong&gt;think&lt;/strong&gt; I learned, but that doesn’t make it the truth.&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;&lt;em&gt;&lt;a href=&quot;https://github.com/handeyeco/minidexed-pcb&quot;&gt;Link to the source files for the MiniDexed PCB.&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/probonopd/MiniDexed&quot;&gt;MiniDexed&lt;/a&gt; is a port of the open-source &lt;a href=&quot;https://asb2m10.github.io/dexed/&quot;&gt;Dexed synth VST&lt;/a&gt; (which itself is modeled after the &lt;a href=&quot;https://en.wikipedia.org/wiki/Yamaha_DX7&quot;&gt;Yamaha DX7&lt;/a&gt; 6-operator FM synth) to bare-metal Raspberry Pi. I have no involvement with the development of MiniDexed, but the project piqued my interest and I decided to try building one myself.&lt;/p&gt;
&lt;p&gt;Unfortunately, the hardware requirements aren’t very straight-forward: some people use 3 buttons, some use 5, and some use 0; you can use a USB audio interface or an external DAC or the built-in audio out (but only on RPi 4); hardware MIDI is optional, but there’s some debate what schematic works the best; etc. It’s designed to be customizable, but for beginners this might lead to analysis paralysis.&lt;/p&gt;
&lt;p&gt;Additionally there often seemed to be a mashup of custom PCBs (&lt;a href=&quot;https://diyelectromusic.com/&quot;&gt;diyelectromusic&lt;/a&gt; is the mecca for resources on those) and off-the-shelf modules. This felt a little too haphazard for my OCD, so I set out to build my own PCB.&lt;/p&gt;
&lt;h2&gt;Project Goals&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;I wanted as much as possible baked into the PCB. An LCD and Raspberry Pi hanging off were fine, but I wanted the main I/O firmly latched onto the PCB.&lt;/li&gt;
&lt;li&gt;I wanted good, built-in sound. This meant using a DAC for the audio.&lt;/li&gt;
&lt;li&gt;I wanted built-in MIDI in/out/thru just because it’s nice to have.&lt;/li&gt;
&lt;li&gt;I wanted an LCD for the screen (vs a tiny OLED) and buttons/encoder for input.&lt;/li&gt;
&lt;li&gt;I didn’t want to commit to doing a lot of work in MiniDexed code.&lt;/li&gt;
&lt;li&gt;Size wasn’t a huge factor, but I wanted it to be around the size of a &lt;a href=&quot;https://github.com/okyeron/shieldXL&quot;&gt;ShieldXL&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;One of the big deciding factors to how I approached this was the DAC. Increasingly DACs are hard to come by as THT components and the MiniDexed project seemed to be biased towards the SMT PCM5102A. Having never soldered SMT components, I decided this would be a good opportunity to try out a PCB assembly (PCBA) service. Overall it was a great success and having this skill really opens up the types of ICs I have access to in projects.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;From here I’ll go over the schematics and then talk about the manufacturing process. Where possible, I tried to conform to the recommendations on the &lt;a href=&quot;https://github.com/probonopd/MiniDexed/wiki/Hardware&quot;&gt;MiniDexed Hardware&lt;/a&gt; page.&lt;/p&gt;
&lt;h2&gt;Audio out (DAC)&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/587884d52494f147df22dc86763e0740/ee3fb/schematic_audio-out.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 69.5945945945946%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACFklEQVQ4y41TTW/UMBTM//81XECiCBYBBw4cKiS23S1tdpONP+LYcWwnKReGcbYLKv2Aw1Ok9zGeN29SjKPHcxFSj3mOmKeAYbDovIEPDumJ/uI5sGkaYK2AsQcMsYPxYgELsV9q8xz+E5DNeSCNA0S1RbX+gtYq9Mkw75l38IOBcxopHcGfBFyA2JRjvOWayXJtt+T72EKQbb05R1VewHL96V8M82DWSqqa7C4hZEmgjsAduqQQxx6B7KwT95idtnp05ayN7TXa/QadOhCEg9HCmD20lb91vOWxJtbywfJcCvYxhn/WHqKDNgJid0W279GoMxzqd5D1FvJwDWUrmFHC6B3M+gXc/huK5Vp3dDNY5MshUL/p+ICjTk31HZ15i5/4wPoKptqgNRJ6v0XrJbWUEOVnSqVRRDJxpBrIJqUMEhnHFfI64zzgevcVUpwR8BP1W0HzIIG9A2Upby5h1A7xx7j0F55gbcdXoqY+NbS+Rtvu6D8JyWj7FkqVHFqhsS/R1K+h5RV1dcv1216QbUXm9niUefGbhziU2G8+woRXBHhDXSr0waCj/7y3iF5BNRvmD5Drc9T0Z3NzQT+yRrYnPy5HyYADtYp8rTdrJF9iSsc/IUduzFfNkc2eDR3oT01Pnqx2slBxSmQWnsfwA8HDcN9jd7GY/Y7Asf6wp1h+peihhKM+DrKxXJ+6qv7hv/3X97H4BcByJNl2WaTyAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Schematic of the audio output circuit&quot;
        title=&quot;Schematic of the audio output circuit&quot;
        src=&quot;/tech-blog/static/587884d52494f147df22dc86763e0740/fcda8/schematic_audio-out.png&quot;
        srcset=&quot;/tech-blog/static/587884d52494f147df22dc86763e0740/12f09/schematic_audio-out.png 148w,
/tech-blog/static/587884d52494f147df22dc86763e0740/e4a3f/schematic_audio-out.png 295w,
/tech-blog/static/587884d52494f147df22dc86763e0740/fcda8/schematic_audio-out.png 590w,
/tech-blog/static/587884d52494f147df22dc86763e0740/efc66/schematic_audio-out.png 885w,
/tech-blog/static/587884d52494f147df22dc86763e0740/ee3fb/schematic_audio-out.png 1144w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The audio circuit is based around the PCM5102A DAC. The MiniDexed project recommends some cheap modules you can find on Amazon/eBay/Alibaba/wherever, so that’s where I looked first. There’s a great writeup about this module on &lt;a href=&quot;https://todbot.com/blog/2023/05/16/cheap-stereo-line-out-i2s-dac-for-circuitpython-arduino-synths/&quot;&gt;todbot&lt;/a&gt; which itself references &lt;a href=&quot;https://macsbug.wordpress.com/2021/02/19/web-radio-of-m5stack-pcm5102a-i2s-dac/&quot;&gt;macsbug&lt;/a&gt;. The important part is this schematic:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/f4e2b9d7d1c0b731840596a40a6910db/59680/pcm5102a_circuit_diagram-1.webp&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 93.24324324324323%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/webp;base64,UklGRsQAAABXRUJQVlA4ILgAAADQBACdASoUABMAPtFgqE+oJSOiKAgBABoJQBnLFTgrVJ1dmda0xNWJP6FjKAmeIAD+9hPeA9JInmgpLN/8dwg+V+KeLdzFt0NTet8RAZc5sN1f9+7HJqF5fn7m819NC2y7ttlgfG2SyASGHXqsjzjSZbzuBJi6P5332SkPXypJv6Joxt/DK1vL0rF3+XtcNLkT7IWt88iGO5kzJ3bPDCRaHOFsX+trNsaaucwH0GVy9aHPiz+o6WAA&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Schematic of the PCM5102A module&quot;
        title=&quot;Schematic of the PCM5102A module&quot;
        src=&quot;/tech-blog/static/f4e2b9d7d1c0b731840596a40a6910db/5ca24/pcm5102a_circuit_diagram-1.webp&quot;
        srcset=&quot;/tech-blog/static/f4e2b9d7d1c0b731840596a40a6910db/cbe2e/pcm5102a_circuit_diagram-1.webp 148w,
/tech-blog/static/f4e2b9d7d1c0b731840596a40a6910db/3084c/pcm5102a_circuit_diagram-1.webp 295w,
/tech-blog/static/f4e2b9d7d1c0b731840596a40a6910db/5ca24/pcm5102a_circuit_diagram-1.webp 590w,
/tech-blog/static/f4e2b9d7d1c0b731840596a40a6910db/59680/pcm5102a_circuit_diagram-1.webp 632w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;This module included a bunch of stuff I didn’t need:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;It supports both 5V and 3.3V and separates analog from digital circuits, so it uses two voltage regulators (the ME6211C33MSG)&lt;/li&gt;
&lt;li&gt;It has a bunch of jumpers to configure things that I didn’t care about&lt;/li&gt;
&lt;li&gt;It exposes a bunch of pins that I didn’t need exposed&lt;/li&gt;
&lt;li&gt;It has an LED which I didn’t want&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Also looking at the “Typical Applications” schematic in the &lt;a href=&quot;/tech-blog/750862398f8ea6ed08eb63ecf8fe224b/pcm5102a.pdf&quot;&gt;PCM5102A datasheet&lt;/a&gt; shows a similar (and luckily pared down) schematic:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/3cc5251ca4d19241f5c5d9d34630c0df/a3767/pcm5102a_datasheet_schematic.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 45.27027027027027%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNUlEQVQoz42S25KCQAxE+f/PowQtEFBLLiJeAbkJcU+q4svuw05VM4RJOp0eHPlZy7JI13UyjqM0TSPX61Vut5vul8tF+r6XYRjkP8vh8Xq9vjgcDlIUhR62bSur1Uoej4fUda0xOdM0qQgwz7O8328F70poSlB5PB7ldDppMURhGKpazrMs02ZlWeq3+/3+jauq0l0J6Q7ocj6ftZj4+XxKmqbaECsATWiGDeT9Gtk8owPvjLzf7/UQ31zXVVKKIWLhtYmgFhHUo9hhbohQgz/IzvP8SxgEgSYCSNlRCchFqV0ajRwCPCMBYsiSJFFyfIqiSL21GNiNU/vnyCYZg1FqftlYpgJiyAAxikyd3brDg4V83/dVYRzH4nmeqmPk7Xarqtfrtex2O403m43+AXzDd/ufPywvsNVEdKm6AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;PCM5102A schematic from the datasheet&quot;
        title=&quot;PCM5102A schematic from the datasheet&quot;
        src=&quot;/tech-blog/static/3cc5251ca4d19241f5c5d9d34630c0df/fcda8/pcm5102a_datasheet_schematic.png&quot;
        srcset=&quot;/tech-blog/static/3cc5251ca4d19241f5c5d9d34630c0df/12f09/pcm5102a_datasheet_schematic.png 148w,
/tech-blog/static/3cc5251ca4d19241f5c5d9d34630c0df/e4a3f/pcm5102a_datasheet_schematic.png 295w,
/tech-blog/static/3cc5251ca4d19241f5c5d9d34630c0df/fcda8/pcm5102a_datasheet_schematic.png 590w,
/tech-blog/static/3cc5251ca4d19241f5c5d9d34630c0df/efc66/pcm5102a_datasheet_schematic.png 885w,
/tech-blog/static/3cc5251ca4d19241f5c5d9d34630c0df/c83ae/pcm5102a_datasheet_schematic.png 1180w,
/tech-blog/static/3cc5251ca4d19241f5c5d9d34630c0df/a3767/pcm5102a_datasheet_schematic.png 1210w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;So I essentially just merged the two schematics I found. Overall, my understanding of what my final circuit is doing:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Hard codes the DAC configuration: FLT, DEMP, XSMT, FMT&lt;/li&gt;
&lt;li&gt;Runs 5V through a ME6211C33 for the analog 3.3V  to keep noise down (the digital 3.3V is just from the RPi)&lt;/li&gt;
&lt;li&gt;Kickback resistors for the I2S lines (shown in the RPi schematic since they need to be near the source)&lt;/li&gt;
&lt;li&gt;I believe those are RC filters on the audio output&lt;/li&gt;
&lt;li&gt;I believe the remaining capacitors are bypass caps&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;MIDI IO&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/9d0c1459e1b9017daf28a94b5baa7e40/5bf79/schematic_midi-io.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 75.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACgElEQVQ4y3VUy3LUMBDc//+XcKOKx4EqCg5AICGkAhuyi9feteWX3pIDl6Ylx5ukIIdZzcqjcXdPy6sQNP4XcVmjybl1I4axh5IaSum8Osea+Pjc6uEfv+TRwk6eq4HxCtPk4JlXokFZ9Sh+1airFt6b+YWMRw1jMGymoEyP6TZAijWKTyfoDzu0TQnLfVWdwhw+Ik5EN1TY1zewUcLYgYi7+4apmZsUBtVgECVu/0yQu0t0V68xjhXEWOP7j3OM6+dQu1foRgEbJLQfIF0LZfvcUCsF7xJCwh0GAdNfMN7CEE0kxfg7wkVFyiNMGGFVC9kfYP3MaKIshk0Tqmmy9wg1qVabLUL/kZq9RN3t7w4pFpjjYevY3Enm5qi1dj3CZPhMwlHrpOUq/RhSGIefGOvzPNG8x7cb3zH6fNCmlTHvM6ifJfquLrAr12jbKg9ztQxEO2qiOzazGVU6JPQwo+We0CPr5qmPtkUtbtDJCmqk9pQiDyYhXLwWWKg09YtzA60F6ut30Dxghj2a6/ewfC6aAmW9QXV2gubyBWsjhzRkP8bFNkmX3qTJzXnSztPIvruB55CsbqnxBo4WCYY24cucrmCbDQK1TVIklolZ1tBT1H7zgRpu5yFMJqMcvOOkbTZ2zzxwmp7Re4FWkuqdA5J9Fj/nhpb6NYc1JOkFokzUEyqx/Zw1MrJGsz3lXoeO4m/raxRfnkGs37CRP17T2dhJL4rcFGeQbZkb6kTTcML7C1JrYdnQ7r/Bcd/J2Y+6uYIqLrKZH97nVTKlJHxVfoWj+OFImcFrGPk8Tz7lif6toxsGaubyNf3n45A9Rw195O1g8VNfn5CNvnw8zJN1fwFDVnFPpQzVZAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Schematic of the MIDI IO circuits&quot;
        title=&quot;Schematic of the MIDI IO circuits&quot;
        src=&quot;/tech-blog/static/9d0c1459e1b9017daf28a94b5baa7e40/fcda8/schematic_midi-io.png&quot;
        srcset=&quot;/tech-blog/static/9d0c1459e1b9017daf28a94b5baa7e40/12f09/schematic_midi-io.png 148w,
/tech-blog/static/9d0c1459e1b9017daf28a94b5baa7e40/e4a3f/schematic_midi-io.png 295w,
/tech-blog/static/9d0c1459e1b9017daf28a94b5baa7e40/fcda8/schematic_midi-io.png 590w,
/tech-blog/static/9d0c1459e1b9017daf28a94b5baa7e40/efc66/schematic_midi-io.png 885w,
/tech-blog/static/9d0c1459e1b9017daf28a94b5baa7e40/5bf79/schematic_midi-io.png 966w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The MIDI spec requires an optocoupler on MIDI inputs (H11L1) and MIDI thru needs to be buffered (74HCT14). Since the 74HCT14 has 6 inverters and I only needed 2 for MIDI thru, I buffered the output too. Like the DAC circuit, this circuit is also a merger of a couple of schematics.&lt;/p&gt;
&lt;p&gt;MIDI in is derived from the &lt;a href=&quot;https://github.com/probonopd/MiniDexed/wiki/Hardware#classic-midi-input&quot;&gt;MiniDexed hardware page&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/19d7c427a74ed80305040abfbd8fc2fa/4d383/minidexed-suggested-midi.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 41.891891891891895%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7CAAAOwgEVKEqAAAABU0lEQVQoz2VSy07DMBDM//8FfABC4sqJM+LCpa1UoK80TsjDTvy2M6wbUjWwkqVdr3d2dsfZOI64PX8t3PjSGGhrF/m5Zq7PblITQAxwwcJHD20UTmUJ7fQlN0iFXitqEmGdQQx+AZosS4GwHp2duJhALLyBIUBDgDw/o+M1eJOj+XrG9+GFwBQkb3Da7+HmSZzDGCMBUlCVK+zen1AdcwIXFxBxyCGJzbZmBLJHs1uh/biDOD6ibSooAmUtQ2sGIqCp5gSvFDKvA4rXB7Tre/AyR1mcwamzKhnK7SeEE1BUYDQ12r1hYGuwoYclNpGm64RY7DSL3kNWZ8RUSF2TKc4h6vqy1jT+bGLQtFd/jV0/gG02xNJMe1yKQioS4DhGcHpQKfl7J6+PPbEKlJ9FCKR4VxQYiNR8l01yx0kQYpMA0k4MneTbYP8pOfs2BLRSLr7ND18ybZY1h279AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Recommended MiniDexed MIDI input circuit&quot;
        title=&quot;Recommended MiniDexed MIDI input circuit&quot;
        src=&quot;/tech-blog/static/19d7c427a74ed80305040abfbd8fc2fa/fcda8/minidexed-suggested-midi.png&quot;
        srcset=&quot;/tech-blog/static/19d7c427a74ed80305040abfbd8fc2fa/12f09/minidexed-suggested-midi.png 148w,
/tech-blog/static/19d7c427a74ed80305040abfbd8fc2fa/e4a3f/minidexed-suggested-midi.png 295w,
/tech-blog/static/19d7c427a74ed80305040abfbd8fc2fa/fcda8/minidexed-suggested-midi.png 590w,
/tech-blog/static/19d7c427a74ed80305040abfbd8fc2fa/efc66/minidexed-suggested-midi.png 885w,
/tech-blog/static/19d7c427a74ed80305040abfbd8fc2fa/c83ae/minidexed-suggested-midi.png 1180w,
/tech-blog/static/19d7c427a74ed80305040abfbd8fc2fa/4d383/minidexed-suggested-midi.png 1195w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;I think I also referenced &lt;a href=&quot;https://www.smbaker.com/raspberry-pi-midi-hat-building-a-raspberry-pi-midi-jukebox&quot;&gt;Dr. Scott M. Baker&lt;/a&gt;, though most MIDI thru/out schematics you find online are roughly the same:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/46e828912369d232ac192c5ee36acf57/fb1d2/midi-thru-out-reference.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 82.43243243243244%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAQABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe9NQoP/xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAWEAADAAAAAAAAAAAAAAAAAAABECD/2gAIAQEAAT8hgL//2gAMAwEAAgADAAAAEMPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBABAAIBBQAAAAAAAAAAAAAAEQAxIQEQQXGB/9oACAEBAAE/EFaxF1HPWxcsc+xn/9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Reference schematic for MIDI thru/out&quot;
        title=&quot;Reference schematic for MIDI thru/out&quot;
        src=&quot;/tech-blog/static/46e828912369d232ac192c5ee36acf57/1c72d/midi-thru-out-reference.jpg&quot;
        srcset=&quot;/tech-blog/static/46e828912369d232ac192c5ee36acf57/a80bd/midi-thru-out-reference.jpg 148w,
/tech-blog/static/46e828912369d232ac192c5ee36acf57/1c91a/midi-thru-out-reference.jpg 295w,
/tech-blog/static/46e828912369d232ac192c5ee36acf57/1c72d/midi-thru-out-reference.jpg 590w,
/tech-blog/static/46e828912369d232ac192c5ee36acf57/a8a14/midi-thru-out-reference.jpg 885w,
/tech-blog/static/46e828912369d232ac192c5ee36acf57/fbd2c/midi-thru-out-reference.jpg 1180w,
/tech-blog/static/46e828912369d232ac192c5ee36acf57/fb1d2/midi-thru-out-reference.jpg 1213w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;I know it’s a controversial take, but I prefer TRS MIDI over DIN MIDI. I think DIN is better when performing or if you keep your stuff plugged in long-term, but I don’t perform and I don’t keep my stuff plugged in. Also these days it’s super easy to find cheap, used 3.5mm aux cables. The jacks are also smaller and cheaper.&lt;/p&gt;
&lt;p&gt;My limited understanding of the schematic:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Resistors are limiting current&lt;/li&gt;
&lt;li&gt;Diode protects against reverse polarity&lt;/li&gt;
&lt;li&gt;Optocoupler protects against ground loops&lt;/li&gt;
&lt;li&gt;Buffer makes sure the digital signals have sharp edges&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Interface&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/bf18cc45d7d2047bda5c4e8afd802d7d/32ac3/schematic_interface.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 50.67567567567568%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABNUlEQVQoz4WSS3ICMQxE5/6HyEVygKyyzCpUqoCkGI9/kj9Dseq0PUCFGggLLSxZT622h1oFLTQHzLMiJ0Hwgrlqj0v9UbSeFiULShEMl0SII6GW4RHVQYtDrsuQ/2Apxy5GokCEwFYQ9Rh/vpAIqbP0yDXygmGjPoSWdicaxGCgyVJhxJCSRwgTnI5w/huRBadUSpXusEUQy9XvqOOgtkWUiWGRqfK68vGYqMbC7D4xmi3M+wvc5hWe4EgFOa9Xb0ApS13iRIVuUdgN5QU/7umdpScWsn+Dmg82Jg67v/IKqGdgm+69gbE7hMxC8ZhPRxothPuH/rW8ZkLYXwnKJfT80Kg9+KJ2v4E7e9YMf/Zdmk2ZvZef0oHXAwviDt3YZSW5+xi3r7zODX8P/XM/gdz6uB76C2W1/H7zdiZ0AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Schematic for the buttons and encoder&quot;
        title=&quot;Schematic for the buttons and encoder&quot;
        src=&quot;/tech-blog/static/bf18cc45d7d2047bda5c4e8afd802d7d/fcda8/schematic_interface.png&quot;
        srcset=&quot;/tech-blog/static/bf18cc45d7d2047bda5c4e8afd802d7d/12f09/schematic_interface.png 148w,
/tech-blog/static/bf18cc45d7d2047bda5c4e8afd802d7d/e4a3f/schematic_interface.png 295w,
/tech-blog/static/bf18cc45d7d2047bda5c4e8afd802d7d/fcda8/schematic_interface.png 590w,
/tech-blog/static/bf18cc45d7d2047bda5c4e8afd802d7d/efc66/schematic_interface.png 885w,
/tech-blog/static/bf18cc45d7d2047bda5c4e8afd802d7d/c83ae/schematic_interface.png 1180w,
/tech-blog/static/bf18cc45d7d2047bda5c4e8afd802d7d/32ac3/schematic_interface.png 1249w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;MiniDexed just recommends a modified KY-040 encoder. From the MiniDexed hardware page: “To improve precision, solder in 2 10nf capacitors: CLK to ground and DT to ground.”&lt;/p&gt;
&lt;p&gt;So pretty much it’s just:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;3 pullup resistors on the encoder (I maybe could have just used the internal pullups, but I was trying to conform with the module MiniDexed expects to avoid having to change the MiniDexed software)&lt;/li&gt;
&lt;li&gt;2 caps which I think are acting as bypass caps? Or maybe debouncing caps?&lt;/li&gt;
&lt;li&gt;The buttons are just using internal pullups&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;No major innovations here.&lt;/p&gt;
&lt;h2&gt;Screen&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/a75993e757f3e5f216cef3e0f1f77a7d/8efc2/schematic_screen.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 87.16216216216216%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACYElEQVQ4y62UWVPUUBCF+f+/RHzxQcsCSmWbEQQ0QEXHgcks2de7JjcBlGMnAzIwg2WVPpxKcpfvdvfp3LWqElhU3UgkMcfwaw5WcDT03dTq8RojITVDxJJuLhMZmMy78bWnQGMEtBLgjKMq240FYtpYNxpVLe/WSAiRIg4muKZxJw3gFwmuCL4EvN9gatGd7iQBDi6/I/anSJIJUuEj1xES6WFUDFCIEMGnPlzrEGXFVwAJYiiSLA/hhgSYXiBzNuHP3iDyNxAON5EHY2RVDJc54CaHf3mKaGpTRuwx0BiqR+Ag5i5G3gCWY8E53YdlvYC83cUt9qCy9+AUtWhBfAKhM6grAT+YIcuiB2CbZvt0vDGkYpBU6IJqJ1IfqtjGT4LN9DvMBq+QfLOQ1zSvYjRGkySVgoxRxXLKsuRUi7mTVz8MoosRQvctblqg2sJs9JrGTqEagZLWLjrfudxGVlPdakrX3A120ZZkyo2B0z+BfbZOEfYB9GDYDiYDu3PdrDB0rT2FUWqc2kBXDIoKq0mK2qW61hj1jmCfv6QIewSkGhY7cAP3dwstATnlfnx0gJOzAwRqCpeP4ZFaB73Kw/hwGzaZMo9wH4bvoWIZTKNWAwUBrS/HsOxjRNol56YIBIkcDCof7ucehvY6DEV3jR00YhcyT54H3qfMZIJUBQ+SpDJC6pMpow8IJhtI3C3o8CM0z6lXnwEumjJvgUXReE3PugSj9uEsJiMIZMRKWAd8buJBvDuMlSk4qX3/0/q/AIoOUujkPwKp51jigmf+/Nb5V2B763j0//ppuHQ3PtUv0VsDGYB/RFAAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Schematic for the LCD screen&quot;
        title=&quot;Schematic for the LCD screen&quot;
        src=&quot;/tech-blog/static/a75993e757f3e5f216cef3e0f1f77a7d/fcda8/schematic_screen.png&quot;
        srcset=&quot;/tech-blog/static/a75993e757f3e5f216cef3e0f1f77a7d/12f09/schematic_screen.png 148w,
/tech-blog/static/a75993e757f3e5f216cef3e0f1f77a7d/e4a3f/schematic_screen.png 295w,
/tech-blog/static/a75993e757f3e5f216cef3e0f1f77a7d/fcda8/schematic_screen.png 590w,
/tech-blog/static/a75993e757f3e5f216cef3e0f1f77a7d/8efc2/schematic_screen.png 828w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/probonopd/MiniDexed/wiki/Hardware#pinout&quot;&gt;Here’s MiniDexed’s information on the LCD.&lt;/a&gt; Nothing really innovative here either. I could have used an LCD with an I2C backback or I could have reverse-engineered the components on one of the &lt;a href=&quot;https://www.adafruit.com/product/181&quot;&gt;common 16x2 modules&lt;/a&gt;, but I went with the middle ground: use a module, but a fairly generic one.&lt;/p&gt;
&lt;p&gt;The trim pot controls the screen’s contrast. I think it might be backwards but it works.&lt;/p&gt;
&lt;h2&gt;Raspberry Pi&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/b9f1f2e1d3ca742e653c6c10812171c5/90712/schematic_rpi.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 90.54054054054053%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAAClUlEQVQ4y51U21LbMBTM/39OpxRCICHAdPrAtKWh0DC5OHES3SzLkmw54ZLtsQnpMENL6MN5kOd4tXt2jxpFkWGXCsEicxrGamib1OfX+hq7AZoawGUSjsBcplDSOWwueh9g9UPwCGWOpJAwQYM7Dl94Kgufm42CNwCrm0PpUPgUeRrBJyPw6DvU9Afi6BKc30KqCYxL6/7c/wOwArMkLaNmK6ZYhQ5Wdx1434J1VP4I6zWd5QUKZ5HTPyY1NcvGls2mqnNJzBibYsankOMrcLUPlh8h3HcBnIP7Y4hwiEW/DadTUmJfSs5pDlVV8wg0lwrQpAJMzqFGPyHUAfzdCbE6wxpnsGUHSdmCjM7hMyKwdH9Myb0B4zFYPEI8uCFQDVdokiuRUIlRj5juQYVjBAJ9XJ+SMW3IoglBgKlSUMliO6qGo2wJYrKIBhhdX8J4Ae05UnLSLFOwm2+Ys4+Y2BaS/Bh3D13MshYWeRPxdYsABZzXL2OjSZ6cR1gMfyHzFI1ckXsChpgKkszkPjjNMCvbtWRdtInxIfjgFLmxZFi+nX/j2YTwHFSa4XLpocQc0WwMMbisJVczBIE9kOQobWKc7WPSO4BkM3ARwxj5JPm12FSAbDHBbdQnyRcYxx9Ifqd2uFidgJF8RpLlsIPZbIQBKdOa/x2wYqwTXsdGDHuYLvZgV52a4ZKioyg2lctq2IVLn2Nj3169alOsinF/f4oHAnskhkuSnJDLZkUmxZ/hTVYD7rTLFaDXc6zK7lO42SdwRhFSTYCAS9tD7tw21Ds8DnQzhd0lM8roVwyuzjDodTHuf4Fgfdh0UY/n3a9NKD1th4EOCmmZQFiGVMaQtBDGm/95D5/iVG4qzZL6W/3gOv2i7zcMUkvyJyEGHgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Schematic for how the Raspberry Pi connects to things&quot;
        title=&quot;Schematic for how the Raspberry Pi connects to things&quot;
        src=&quot;/tech-blog/static/b9f1f2e1d3ca742e653c6c10812171c5/fcda8/schematic_rpi.png&quot;
        srcset=&quot;/tech-blog/static/b9f1f2e1d3ca742e653c6c10812171c5/12f09/schematic_rpi.png 148w,
/tech-blog/static/b9f1f2e1d3ca742e653c6c10812171c5/e4a3f/schematic_rpi.png 295w,
/tech-blog/static/b9f1f2e1d3ca742e653c6c10812171c5/fcda8/schematic_rpi.png 590w,
/tech-blog/static/b9f1f2e1d3ca742e653c6c10812171c5/90712/schematic_rpi.png 882w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The only things interesting here are the kickback resistors for the I2S signal to the DAC. I read that they’re supposed to be close to the sending side of the signal, so that’s why they’re part of the RPi side of things.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Manufacturing Notes&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;When laying out the PCB, I took a lot of care to try and separate the audio out functionality from the rest of the board to avoid noise from digital signals&lt;/li&gt;
&lt;li&gt;I used JLCPCB’s PCBA service. The boards cost $9 for 5 and the assembly (which included the SMT components) cost $57 for 5; so about $13/ea before shipping.&lt;/li&gt;
&lt;li&gt;Overall going through the process of making pick-and-place files was straight-forward. I &lt;em&gt;almost&lt;/em&gt; made a mistake by using an incorrect footprint, but caught it while triple-checking everything. &lt;a href=&quot;https://www.youtube.com/watch?v=VejO8rDdhzo&quot;&gt;Notes and Volts have an instruction video&lt;/a&gt; on designing a PCB for pick-and-place assembly.&lt;/li&gt;
&lt;li&gt;Originally I tried panel mount Cherry switches because that’s what I had. PCB mount switches look and feel &lt;strong&gt;much&lt;/strong&gt; nicer.&lt;/li&gt;
&lt;li&gt;Originally I used an RPi 4 but it was concerningly hot so I downgraded to a 3.&lt;/li&gt;
&lt;li&gt;To keep the height down I soldered the LCD directly into the PCB rather than use headers. I hope I don’t come to regret this.&lt;/li&gt;
&lt;li&gt;I ended up laser-cutting some acrylic panels for the top/bottom. It’s the &lt;code class=&quot;language-text&quot;&gt;acrylic-faceplates.svg&lt;/code&gt; file in the repo, but they might need tweaking depending on the laser cutter.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Things I would change:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I need to redo my 3.5mm jack footprint. The jacks have two plastic legs that I think are meant to brace the jack when plugging/unplugging, but I originally thought they were little standoffs so I didn’t make holes for them.&lt;/li&gt;
&lt;li&gt;Figure out how to keep the height low without soldering the LCD into the PCB.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;That’s all I can think of. I had to make some modifications to the MiniDexed config, but that’s outlined on &lt;a href=&quot;https://github.com/handeyeco/minidexed-pcb&quot;&gt;the Github page for the PCB&lt;/a&gt;. Overall pleased with the sound of this thing and happy that I didn’t make any major mistakes on my first PCBA project.&lt;/p&gt;
&lt;p&gt;Anyway, thanks to all the folks who have contributed to the Dexed/MiniDexed lineage; it’s wonderful to see so many people come together to make cool, open-source music projects.&lt;/p&gt;
&lt;h2&gt;Random Pictures&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/198de7da189c096829c64e35c6e56f88/4ef49/front-layout.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 65.54054054054055%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAADC0lEQVQ4y12TyU9bZxTFnUbqoC5I6aYRarCN3/i9ET8PeMI2BkSatklxREBJl1VTxS5gg/EANo4dog6LrtplpPb//PUC3aSLo/O9+753dO6598WWvgywH4T4cRt1XxHqHuoLRZBycZaUwGFVztpymvtLaT5eMPlowfgfTD4UvrfoEdv0KkxLWeZVg2nBYr5hC9s3PMnajLOKq7pJr1whbZaJLWjcWUgJtPcQk9on92xi23GPqe8wjFwmeZc39YjJmsNF5DAIHDmHXG1mOPdcwgdZ7nxmc3fR4INFk7ufmzd8C4NPF11itZTPpGgy2VphUFth3Egyqgs2EwxyJmcrAQM9YGR4/BCssxdW+T5h8TzlcLCseL7i8CJps2+leZJ5SOyh7vO6pNNSFoeaTddUtA3FK93iRFec6i4n8tyVD2dlk1nFpC/nC8vjqugL+wx16VDu9FSW2JY4uCronCiXI9OTon/Dr0yXM8dn5IYM3YCeFjCta5xvpGgvu8xKinkjzS87ir5829UUx1YkQ4kHzLyA1+U8l8Uc/bUsk1KOXjaiZbn0HI+h54tbyboqgjWNdtyVjBXDvMObDY++7XIqgh0rIw4lw5GjZCAZRuk0PdfnZ9uTly4vU4pDQce0OQ5kC0TsQly2JLuhIyZKESNvla7cOTXs/wRNn0vf4yzlSfjiSMLviZuu5tISbguOpN6SbbioyfBqOseS+6/bJSa5DG8bRVmtSDK26Ngi2Ei4nBuOtJqjUy9zKmH3vJDORoXDMBJ3Hoe1Au18gYnsY389xTCT491P3/Lni50b/v3rKscJg871UBpxxblu87LaYH/nOwYytU6Uo/moyY9RWfLx2N/+ioPSI2bbBr1qQlpb5V3rMX8f7fJP9ynTSv5W0EyLoLbKWPKYi6u3fshEMrwUkbnURrZPT6Y9VoF0Ifta8RnXfPrym/5WW+OvZoM/dsqMZL2G0tlJuE4ssIrs+QX2DJdndsC+oJl02BVc89OkumVZ5l09T9OucJDweJYIOEjK/WskfPb0DN/4W/wLtz3ImoO9VbcAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Front CAD view of PCB&quot;
        title=&quot;Front CAD view of PCB&quot;
        src=&quot;/tech-blog/static/198de7da189c096829c64e35c6e56f88/fcda8/front-layout.png&quot;
        srcset=&quot;/tech-blog/static/198de7da189c096829c64e35c6e56f88/12f09/front-layout.png 148w,
/tech-blog/static/198de7da189c096829c64e35c6e56f88/e4a3f/front-layout.png 295w,
/tech-blog/static/198de7da189c096829c64e35c6e56f88/fcda8/front-layout.png 590w,
/tech-blog/static/198de7da189c096829c64e35c6e56f88/efc66/front-layout.png 885w,
/tech-blog/static/198de7da189c096829c64e35c6e56f88/4ef49/front-layout.png 890w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/ab4c5deaa53da6218f70135e80c1fd7d/eac55/back-layout.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 66.21621621621621%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAADJ0lEQVQ4y2WSWU9bVxSFDWrUPqRpySC1qiIloWC4eGQIxYEwGDxSTxjbeMADwZZsgk0dJ4ES4jJdG9s4pkJVW1XqP/26fVWpD31YWvvce87aa5+zdHceGhn8Ws/g0Nj/Id/vPJpgSHHx3YRTw9Coh8eGVe7rvRo/0Hv4VlnjoeLh/rgD3WcPJtDdGxaMCL7/D1/J+u4zvvjGgjGq4s/V8GYOscXOCOYqOFKH+LJV1oTXM1Xs2TpK4LgvqDDw5VMG7j3TMPgvD/Sb3H3C548MzEYuce/8giN7hi16InyKJyecU4XrONJ11jIXKM536B4vZhh1VRldKaO3Vxheltp+oNUjqxXGQ0csJLrMJW+Zz/3N6nadYGabQDZHMJvFnxZOp3AkS1hdu+j09jJTsR6Tm9eYw12Wt0+ZjrQxhnrS+T3J/X1mU39iS3ZZ2vmdlVe/MbNRZy5+xXyyiS3R4mVSlb015oL76EaWikxtdpiVe3ImCqwk3guqGAMq7u0y2VKS6fgfLOf/Yil7KwI9zMEGs/EbnkflXKzLczHk2Tlixv+mL1hiOnotP5ssRYvMR2rYwlUM/gbu9AHxfELcdvkh3hEhFVPgQvgS60YDo++MmWiLaRE1h9qMu476gnuYQi3ZqDLhazAT/og1dMn4egNnskhsd5vl5Efmt47FdVMTsoZUzCLcZ4P3Ayb/mVab3GV0in2PF1sdXsSuWEl/YiHe1UYxBtoi+Jr0XhbTxo0cusQSagpUbWRzsF83RPBEzEij4DmTbnmUcREMF3qEdtqEdzukite83Goy5muznq2QKKRknHO545q4U8XJuTR8J/d+iuHHCyYDVWYix5q44jpEN7xYkrC2CeRa+HJtovkOsUJburYlyGXS+QijEUlA4RxLoI4hcI4h38Qc+SDuZJ2+wvJK3PsvmHC9FYfOCtboJ8nXNfHiDaF8j8zrX9nI3+LdPSFS+gmjvyUjqdq4/bvq19bQlcSrw7QkZCoskIc1+X6WYC+kGXVW0a9UsPnesOCvsRis4d58i8Vb46l0tTgPUNYqEn4Ju6BfGx0HUpc1jAkUd40n9jz/AA8z9+lZIYUIAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Back CAD view of PCB&quot;
        title=&quot;Back CAD view of PCB&quot;
        src=&quot;/tech-blog/static/ab4c5deaa53da6218f70135e80c1fd7d/fcda8/back-layout.png&quot;
        srcset=&quot;/tech-blog/static/ab4c5deaa53da6218f70135e80c1fd7d/12f09/back-layout.png 148w,
/tech-blog/static/ab4c5deaa53da6218f70135e80c1fd7d/e4a3f/back-layout.png 295w,
/tech-blog/static/ab4c5deaa53da6218f70135e80c1fd7d/fcda8/back-layout.png 590w,
/tech-blog/static/ab4c5deaa53da6218f70135e80c1fd7d/efc66/back-layout.png 885w,
/tech-blog/static/ab4c5deaa53da6218f70135e80c1fd7d/eac55/back-layout.png 887w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/96c816daf2093ac90da8a594164bfef8/dba9a/front-preview.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 62.83783783783784%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC80lEQVQ4yz1T204TURSd38FemHY67fQ+03agpRcoWBRTQFp7v3NHguiTDz4YYmJiMCbqk0CA0jRtI1pQ7IsPfNJyn6P4sLP3OXNm7bXWPkfIvchjdnMaqa0kkpszWH62gMR6ApnnacQpz+/MYXHvIeafPsCno48Yfh9iMBigP+ij1+uh2+2i0+mg3W7j9OwUQrAWhL9ow0TVCZ0iVGGhYLKqwJmzIkh1rOGFlBVx+OU9bn/fYvRrhNHNCDc/bnB9dY3htyEuv16i3+tDmGiE4CnI8BUVhKpeRFpBXgcqbih5GZ6yG3orBNOyEQefDzD8eYWLwQU6A2LVb+Ose4aTzgmOzo9wfH4MIbU9gxixma4piFMkGy5aO3C/6Ya3KMO8ImJ8ZZyHWvVDbwRhzVoh52RYshKkJzZe2yiH6iEIsWYQrowJxiUzzI/ZjyIMS0YelqwFlszfMK9YECyzpi7exEKgk3UPfCUF4/SdNREpC+FGAM68RB1k8kmCUnDAmrHycFCtkHxnyQkLMdDJ3xny8x41Z15PNlTEWyrtM1ArYUgQPGUf1LqK8HqYvNKh1TRee8oeDqoUFLhLLn5YI4ZRYmhcNpO/NkQafkw1VbjyMmcsUQixtQj3IEBM7Xk7Z8n8YDJNSyZug0wHXTmJs5pt+YmhCTKdnaBhaXWNS2VgTLYwt5UgT8zkoYkbzzYZiHHRyAFZGKgeSxvgzRErAmV+JneT0IgEUzO1EeEEJCbZV/Fz9KlmCHpN5UPRqj7EV3XYMhKXzb4FaMKhshMJkuwqe7Hzbhv1gzpW36zyzAbI1An+qgoLgaT3FhBdi0KkD+GmTutHcBac/FCaXkqMXo1atCNcssNKA9x8u4Hdw13sf9hH5mXmvzqB3R0xI8JGPvL7RLLuZIvUyEwDYGEg6V4yP1pzY4yu1PROApXXFRReFeCteDkgm4GQ2krxiWokN1inZ0gW2HN2OHIOnu9qW9ZGVmh0sXVqTHt5ulJ5hWf7v7Ve1/EH8FsNyxgBm3wAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Front preview view of PCB&quot;
        title=&quot;Front preview view of PCB&quot;
        src=&quot;/tech-blog/static/96c816daf2093ac90da8a594164bfef8/fcda8/front-preview.png&quot;
        srcset=&quot;/tech-blog/static/96c816daf2093ac90da8a594164bfef8/12f09/front-preview.png 148w,
/tech-blog/static/96c816daf2093ac90da8a594164bfef8/e4a3f/front-preview.png 295w,
/tech-blog/static/96c816daf2093ac90da8a594164bfef8/fcda8/front-preview.png 590w,
/tech-blog/static/96c816daf2093ac90da8a594164bfef8/dba9a/front-preview.png 652w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/314ead0bfe459966efcb613109139631/a6d36/back-preview.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 62.83783783783784%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAADAUlEQVQ4y01S204aURSdv2mNch0YBhhmuA1XLyOCKCqCVu6DoNZb1Go1TdMP6DcYE4sxhIBp1IagT31of2h1z6FN+rCzz8nZZ621195c566D+/t7dLtd9Ho99Pt9DAYDDB4GeH56xuXXSywcplC6Wsfc/hzmKYrnOczsTY/z7gyWj1JYOEghd5wD9zB4wOP3R/Z5+GOI0XCE19ErXkYv+P3zF/QvTbi3bIg23FCqApSKE+GaiEjDg5juQZQiWHMhVPfAvsmDu/52jevONW7ub3DbvUWn18Fd/47F0/AJ9c91+Cs+JNtxhPUg5Kob2k4cc+0oyzPtMCK6gsR2CK6SAM5ddsO6YQX/jqdsg23Tzs52ytN7CaiNECK1MKkIkKoQtJYCbduDhZaE6YaI5d0gNN2LGJ2jzSA4S9HCkM1FK8n3wlcRGLCDQFcPVGJWIZW8VBxCshWFr+aFhd6VqgxPyQNfVYG/rpANAt2d4Aw1UkVCpOpkPoTqIlzvDJUO5I9idFcIUEKsqUKpyXCQTzypDzUCcFJNohVn4DL5KxotG4DeihfODQviTR8CZLiVVDu2HMi+D0Ok7C67IGwJzBrDChsptBQsLKQy/d10wlwws864qfUpxmgtkqqijVidsNPZSsX5wyixi1B1CXYi5v8LA9QI8/oYyMCQq15wsi4jtB1EcjeBOE3NW/ZQyy5WmCHDI3qA+cs+/R3WP6VGGHUWuhvtq7ofXOokheWLZSxdLKHwqQDtWBsXUKur+yoNSUSwLpHxEtsAH62N2lQg0AAMMD/dA/RmkFiJmHPSw+LZItKnaSydLyF/lYfaVondhkxbgZvec6c5zNIKmQomBGgYxfM8+cYz3zJHaaT2Z8lPM+wb9vHa+Jt+ZD9kkTnLYOVyBbmPK1DIiuyeCp6Y36y8xeTaJFM0lZ/CxOoETOsm1rLx32QMhNQZg+NkGjlPbNqRhvRJGtmzLNYu1zB/PI/kThJKQ0GAfBRLIvkksE9KXYZUlWiFHBBoiK6SC/6Gn3Y1ij9NTA1YLbTsygAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Back preview view of PCB&quot;
        title=&quot;Back preview view of PCB&quot;
        src=&quot;/tech-blog/static/314ead0bfe459966efcb613109139631/fcda8/back-preview.png&quot;
        srcset=&quot;/tech-blog/static/314ead0bfe459966efcb613109139631/12f09/back-preview.png 148w,
/tech-blog/static/314ead0bfe459966efcb613109139631/e4a3f/back-preview.png 295w,
/tech-blog/static/314ead0bfe459966efcb613109139631/fcda8/back-preview.png 590w,
/tech-blog/static/314ead0bfe459966efcb613109139631/a6d36/back-preview.png 650w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/e30909d6b94a1f30ab4b2b0b1d707ac7/d2602/front-manufactured.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAQBAgMF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAv/aAAwDAQACEAMQAAABnBhArqFQL//EABkQAAMAAwAAAAAAAAAAAAAAAAECAwAEE//aAAgBAQABBQKtWVxtZN+iXiWYa5yKc5//xAAWEQEBAQAAAAAAAAAAAAAAAAACARD/2gAIAQMBAT8BhWf/xAAVEQEBAAAAAAAAAAAAAAAAAAAQIf/aAAgBAgEBPwGH/8QAGRABAQEAAwAAAAAAAAAAAAAAAQAREiJB/9oACAEBAAY/AkLsbcpS8sb/xAAaEAEAAwEBAQAAAAAAAAAAAAABABEhMWFB/9oACAEBAAE/IV8w8lZ0X8yEAK8ZVFsB20cGFu8n/9oADAMBAAIAAwAAABBfz//EABcRAAMBAAAAAAAAAAAAAAAAAAABITH/2gAIAQMBAT8QYqFlP//EABcRAAMBAAAAAAAAAAAAAAAAAAABITH/2gAIAQIBAT8QwN2H/8QAGRABAQADAQAAAAAAAAAAAAAAAREAITFR/9oACAEBAAE/EBbjkJZocdRngUaTHRlUpeYtbGdeambqrx45SIFcbc//2Q==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Front manufactured view of PCB&quot;
        title=&quot;Front manufactured view of PCB&quot;
        src=&quot;/tech-blog/static/e30909d6b94a1f30ab4b2b0b1d707ac7/1c72d/front-manufactured.jpg&quot;
        srcset=&quot;/tech-blog/static/e30909d6b94a1f30ab4b2b0b1d707ac7/a80bd/front-manufactured.jpg 148w,
/tech-blog/static/e30909d6b94a1f30ab4b2b0b1d707ac7/1c91a/front-manufactured.jpg 295w,
/tech-blog/static/e30909d6b94a1f30ab4b2b0b1d707ac7/1c72d/front-manufactured.jpg 590w,
/tech-blog/static/e30909d6b94a1f30ab4b2b0b1d707ac7/a8a14/front-manufactured.jpg 885w,
/tech-blog/static/e30909d6b94a1f30ab4b2b0b1d707ac7/fbd2c/front-manufactured.jpg 1180w,
/tech-blog/static/e30909d6b94a1f30ab4b2b0b1d707ac7/d2602/front-manufactured.jpg 4032w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/f7371c3b32d7ec34b277679a89566802/d2602/back-manufactured.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQBAgP/xAAVAQEBAAAAAAAAAAAAAAAAAAACAf/aAAwDAQACEAMQAAABuluqW8SC/wD/xAAbEAEAAgIDAAAAAAAAAAAAAAACAQMEEgARE//aAAgBAQABBQJZElLInuhyhdStvDlVWh//xAAXEQADAQAAAAAAAAAAAAAAAAABAhAS/9oACAEDAQE/AcsZ/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAEh/9oACAECAQE/AcV//8QAGxAAAgEFAAAAAAAAAAAAAAAAAAEREBIyQVH/2gAIAQEABj8CatMmOXsfHSD/xAAZEAEBAQEBAQAAAAAAAAAAAAABEQAhYTH/2gAIAQEAAT8hmJxn3WeHg5AR9ZT0pdbbK5lSNbzf/9oADAMBAAIAAwAAABCoD//EABcRAQEBAQAAAAAAAAAAAAAAAAEAESH/2gAIAQMBAT8QDaEDnb//xAAXEQEBAQEAAAAAAAAAAAAAAAABABEh/9oACAECAQE/EBiN5f/EABsQAQADAQADAAAAAAAAAAAAAAEAESExQWHR/9oACAEBAAE/EAQo9l7TEqXlbFEfLiBV5RLEjBWJ6ilvwEeRsYuHMPk//9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Back manufactured view of PCB&quot;
        title=&quot;Back manufactured view of PCB&quot;
        src=&quot;/tech-blog/static/f7371c3b32d7ec34b277679a89566802/1c72d/back-manufactured.jpg&quot;
        srcset=&quot;/tech-blog/static/f7371c3b32d7ec34b277679a89566802/a80bd/back-manufactured.jpg 148w,
/tech-blog/static/f7371c3b32d7ec34b277679a89566802/1c91a/back-manufactured.jpg 295w,
/tech-blog/static/f7371c3b32d7ec34b277679a89566802/1c72d/back-manufactured.jpg 590w,
/tech-blog/static/f7371c3b32d7ec34b277679a89566802/a8a14/back-manufactured.jpg 885w,
/tech-blog/static/f7371c3b32d7ec34b277679a89566802/fbd2c/back-manufactured.jpg 1180w,
/tech-blog/static/f7371c3b32d7ec34b277679a89566802/d2602/back-manufactured.jpg 4032w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Grandbot: Arp]]></title><description><![CDATA[Disclaimer: I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I think I learned…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/grandbot-update-arp/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/grandbot-update-arp/</guid><pubDate>Thu, 02 May 2024 03:25:23 GMT</pubDate><content:encoded>&lt;p&gt;&lt;em&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I &lt;strong&gt;think&lt;/strong&gt; I learned, but that doesn’t make it the truth.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Project originally inspired by the work of &lt;a href=&quot;https://twitter.com/MohitBhoite&quot;&gt;Mohit Bhoite&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Code references the state as of &lt;a href=&quot;https://github.com/handeyeco/Grandbot/releases/tag/2024-05-01&quot;&gt;this tag&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;So I put Grandbot down for awhile, explored other hobbies, and found my way back to tinkering with electronics. I started looking at open source projects for synths and learned how to design PCBs for my own projects. Realizing I could make a custom PCB for Grandbot (who had been living in a breadboard for years) while also realizing that Grandbot still had a lot of spare memory, I thought I would make Grandbot play synths using MIDI.&lt;/p&gt;
&lt;p&gt;I’m not going to waste time explaining &lt;a href=&quot;https://github.com/handeyeco/Grandbot&quot;&gt;Grandbot&lt;/a&gt;, &lt;a href=&quot;https://en.wikipedia.org/wiki/MIDI&quot;&gt;MIDI&lt;/a&gt;, &lt;a href=&quot;https://en.wikipedia.org/wiki/Synthesizer&quot;&gt;synthesizers&lt;/a&gt;, &lt;a href=&quot;https://www.soundonsound.com/techniques/making-most-arpeggiators&quot;&gt;arpeggiators&lt;/a&gt;, or the &lt;a href=&quot;https://github.com/handeyeco/Grandbot/blob/f3aa1b55b50c097ed3ffdcc1509db3f21eb60274/circuit/ALPHA-grandbot-midi/grandbot-midi-schematic.png&quot;&gt;circuit&lt;/a&gt; (based on &lt;a href=&quot;https://www.pjrc.com/teensy/td_libs_MIDI.html&quot;&gt;this&lt;/a&gt; and &lt;a href=&quot;https://www.notesandvolts.com/2015/02/midi-and-arduino-build-midi-input.html&quot;&gt;this&lt;/a&gt;). I’m going to jump straight into explaining how Grandbot’s new generative, pattern-based arpeggiator works.&lt;/p&gt;
&lt;h2&gt;Concept&lt;/h2&gt;
&lt;p&gt;Most arps have preset patterns: up, down, up-down, etc. Occasionally arps will have a random setting that’s usually chaotic fun albeit a little unmusical. The idea behind Grandbot’s arp is essentially: what if we used randomness to generate a sequence and then repeat it to make it more musical. However, as opposed to sequences that are musical intervals relative to a root note, this arp basically stores array indexes to retrieve individual notes from an array of active notes.&lt;/p&gt;
&lt;p&gt;Okay some pseudocode (using &lt;a href=&quot;https://audiodev.blog/midi-note-chart/&quot;&gt;MIDI note numbers&lt;/a&gt; to represent notes):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Random arp&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// randomly plays one of the four pressed notes&lt;/span&gt;
pressed_notes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;67&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;71&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    note &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pressed_notes&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;note&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Sequence, relative to a root note&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// loops 60 71 64 67&lt;/span&gt;
sequence &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
pressed_note &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;60&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;interval &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; sequence&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pressed_note &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; interval&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Grandbot&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// loops 60 71 67 60&lt;/span&gt;
indexes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
pressed_notes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;67&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;71&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;index &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; indexes&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;active_notes&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;index &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; active_notes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So that’s the basic idea: it’s not random notes and it’s not a sequence of intervals. It’s a randomly selected sequence of indexes used to access an array of notes.&lt;/p&gt;
&lt;h2&gt;The data&lt;/h2&gt;
&lt;p&gt;The above pseudocode is all well-and-good, but I wanted to do a couple of other things with the arp:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Allow for octaves: we’ll use +/- numbers as note offsets (+12 up an octave, -12 down an octave)&lt;/li&gt;
&lt;li&gt;Allow for variation in note lengths: we’ll track when a note should start using &lt;a href=&quot;https://en.wikipedia.org/wiki/MIDI_beat_clock&quot;&gt;MIDI clock pulses&lt;/a&gt; (24 pulses per quarter note)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Let’s make the pseudocode a little more realistic:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;current_note &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;
current_pulse &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;

pressed_notes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;67&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;71&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

indexes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
offsets &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
start_pulses &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

total_length &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;84&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;handleClock&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    current_pulse &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;current_pulse &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; total_length
    step_index &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; start_pulses&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;indexOf&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;current_pulse&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// return early if we&apos;re not on a new step&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;step_index &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;current_note&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;stop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;current_note&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// wrap the index in the sequence&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// around the length of pressed_notes&lt;/span&gt;
    note_index &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; indexes&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;step_index&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; pressed_notes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length

    &lt;span class=&quot;token comment&quot;&gt;// get the note and apply the octave offset&lt;/span&gt;
    current_note &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; pressed_notes&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;note_index&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    current_note &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; offsets&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;step_index&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;current_note&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;That should loop &lt;code class=&quot;language-text&quot;&gt;60 71 55 60&lt;/code&gt; (&lt;code class=&quot;language-text&quot;&gt;60 71 67 60&lt;/code&gt; before the octave transform). It should play it in a &lt;code class=&quot;language-text&quot;&gt;quarter-eighth-quarter-quarter&lt;/code&gt; pattern (in pulses: &lt;code class=&quot;language-text&quot;&gt;24 12 24 24&lt;/code&gt; from 0-83 pulses).&lt;/p&gt;
&lt;h2&gt;Generating a sequence&lt;/h2&gt;
&lt;p&gt;At this point we have most of what we need to generate a new sequence, we just need to add some thresholds for randomness and do the thing. Grandbot stores these randomness threshold values using 7-bit numbers (0-127; since that’s what &lt;a href=&quot;https://en.wikipedia.org/wiki/MIDI#Messages&quot;&gt;MIDI messages&lt;/a&gt; use).&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;octave_chance &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;
max_pressed_notes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;
possible_lengths &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;// 16th&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 8th&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;24&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;// Quarter&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

indexes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
offsets &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
start_pulses &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

total_length &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;84&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;generate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    new_length &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
    step &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;new_length &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; total_length&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// get a random length from the array of options&lt;/span&gt;
        note_length &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;possible_lengths&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// get a random number between&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// 0 (inclusive) and 16 (exclusive)&lt;/span&gt;
        index &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;max_pressed_notes&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// get a random octave up or down&lt;/span&gt;
        offset &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;127&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; octave_chance&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                offset &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
                offset &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

        indexes&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;step&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; index
        offsets&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;step&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; offset
        start_pulses&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;step&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; new_length
        new_length &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; note_length
        step &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Besides handling the actual MIDI messages (I used &lt;a href=&quot;https://github.com/FortySevenEffects/arduino_midi_library&quot;&gt;Arduino MIDI library&lt;/a&gt;), that’s pretty close to all we need.&lt;/p&gt;
&lt;h2&gt;Visualizing the note wrapping&lt;/h2&gt;
&lt;p&gt;Okay, so let’s try to make the structure of this a little easier to grok.&lt;/p&gt;
&lt;p&gt;Say for each step we pick a random index (in this example &lt;code class=&quot;language-text&quot;&gt;max_pressed_notes&lt;/code&gt; will be 7) but only press one note. Even if the random index &lt;em&gt;never&lt;/em&gt; lands on the one note being pressed, it will &lt;em&gt;always&lt;/em&gt; play that note.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/tech-blog/be0b82c52aa5d58c7e8572175a2fb35c/one.svg&quot; alt=&quot;Sequence of notes if only one note is pressed&quot;&gt;&lt;/p&gt;
&lt;p&gt;Now if we do this for a couple of notes, sometimes the index will land on a pressed note and sometime it will have to wrap.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/tech-blog/8382d56f9f7ab5ec3c578ba49887f576/three.svg&quot; alt=&quot;Sequence of notes if three notes are pressed&quot;&gt;&lt;/p&gt;
&lt;p&gt;For the last one we press all seven notes available and get the full range of the sequence.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/tech-blog/e6a0303c669e8d7688e9f0ac66d92b84/seven.svg&quot; alt=&quot;Sequence of notes if all notes are pressed&quot;&gt;&lt;/p&gt;
&lt;p&gt;So even though the sequence is the same for all three example, we get three very different results:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;With only one notes pressed, we always get that one note&lt;/li&gt;
&lt;li&gt;With only a couple of notes pressed, we sometimes land on a pressed note and sometimes we have to wrap&lt;/li&gt;
&lt;li&gt;With all notes pressed, we always land on a pressed note and never have to wrap&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;All of this is happening before we transform the notes with varying rhythms and offsets (i.e. octaves). So even if we only press one note, we could still have a lot of interesting variations.&lt;/p&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;The real code for the arp does a lot more, for example:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Rests&lt;/li&gt;
&lt;li&gt;Fifths&lt;/li&gt;
&lt;li&gt;Ratchets&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;There’s also a fun feature called “Slip” that gently transforms the existing sequence by randomly swapping notes. If you’d like to know more about the project, it’s all &lt;a href=&quot;https://github.com/handeyeco/Grandbot&quot;&gt;open source&lt;/a&gt;! Sharing is caring!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Grandbot: MIDI & Misc]]></title><description><![CDATA[Disclaimer: I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I think I learned…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/grandbot-update-midi/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/grandbot-update-midi/</guid><pubDate>Wed, 01 May 2024 03:25:23 GMT</pubDate><content:encoded>&lt;p&gt;&lt;em&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I &lt;strong&gt;think&lt;/strong&gt; I learned, but that doesn’t make it the truth.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Project originally inspired by the work of &lt;a href=&quot;https://twitter.com/MohitBhoite&quot;&gt;Mohit Bhoite&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Code references the state as of &lt;a href=&quot;https://github.com/handeyeco/Grandbot/releases/tag/2024-05-01&quot;&gt;this tag&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Just a couple of random thoughts about Grandbot.&lt;/p&gt;
&lt;h2&gt;Custom PCB&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/8299933cf0839392f31cd687a1f09883/e628c/grandbot.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 99.32432432432432%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEm0lEQVQ4yzVVZ08jZxD2j0kEBjeMe6+4gHvBZdfrXnDBHWMwBsxFyUUXcSdFkRIl9/X+5ZNnN5cPo3nL7Lwz8zwzq2rum8iusyjcF1DdlbD9PMP4lz5aj3ks36qYU1YfRIqAhbIWMHgpI7vJI3+fR2FbwPW2iNw6h8q2AlV5W8aXr1/gGXrhHliQnXuQnHlgaWphrv0Ia10Ni3QES+0IrpYW7rYWjo4BmroWGkkDXUMHx40D73+/Q/alyqwzcA1c8E/8MHXMsPYdivhvgxi9T5HYpNH7NETlVURoFuF5GHbam7tmnLfPYela4Bv74LnxIHIbgSq5SuCkdgLnjRPGlhGGhl4x9AxdKDxm4Bk4kFjFcbWMwsg7C200VTXtDDjn2tQ2wTv2MGIN/CM/VKlVSgk9OA3CM/YqL3oZbXYRQH5iQ3YsiwW5iRXFqQOlmQvRGyuOqqcwtM5h6trgGLqhresZBB1mNhnYBnb46exiFkJofoHILIjha06R/j6F3lMSo4O8z1LnlX37MYHe7opnaYh3IUSGVnQeLqESnqvQNs+QGZuRHFmgaZwhdMsIlyHExk5ERw5qh6LjExdiFHl9NSV4lP5bCbm7KEJjN8r3CdmhALVwTFACSspqQc3ih4mcXJczomhURN88h7bx//5MkVNJz4yiuH5IIjYPobRNQyW+CDgWT5BkzSITN2ujRnxxgdu3HAZPcQz2V+jvYsp6uL+kvlTOuo9xdLdhtJ8STDlIOp2i+xD/L2VD24zKwok0C38sGeEnr8p3YaS2WRTXYaZoR3HpR5oR5NYRxFiv9NRNQqcgbsIwNI3o/NRF6i4LVfY+iwARLpEi19sEMssLpKZeNFn46j6n6OI6hOYuAWGfR/0pjfImggYjFB4SSC1COK1p8Pu3P9A8NKAqPBRIVAekbRTSJoTKyo8iO6WyDqLKtcB0KqsAqkRS/H5fvoug/RDD5JCBuefE6vMI4nOeTAlAJR0kuEcudocdbjL+rGXCD6Uj6Fn0E1Gr8EstnBIQPXRkg8w9jaSDloAYCJCfAH79dsD7PytEl1dQlTgQDE0DAqSKrU+S0rG6cqx0jHPgRPdX1maTQuvnFtzsHp2kVbrEwIf0dR0stC+QYtmFDxfzGIfDrgxj26h0ip2X1q5VcainQ3vPBvFNRGwRRfW1qtxp6VAvO2OU8qPmjgXp1QUCQzu8Qx9R3gtM2c3o7IzOQSPySzxV+lrHD8+YovZ7VPJeR0caUcMHDcq5g12WJPr+aQg+TixVep1m/Wyo3UdQXnghsugSqSCDUF360NgQHFKmvPCjTlAEGSgCJq18kPiNnU5yyyD8/XO4bugwd5fD5TKB600MfZJUYGrtpxRGJHP9KQPxUEV3d8k+jaK8v0bzOYcaH0stI2i9VVB5LnEi2RGfhhGZRgnKfQmf/voNNs5CZ9/EF91w9ExwdvRwDZ0o7zKoMeL2NoL8KqgMU0/XgPkugNkujPVLDKaWAR///ATZl6r72uXiGvlNgcXN8neQQYbjPE2R9YSDdcb2nL9UsD4ItCvSLoMGaz/9OELvQxsF/g5K2xKknYR/AflPIiNg8CCRAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Grandbot&amp;#39;s custom PCB&quot;
        title=&quot;Grandbot&amp;#39;s custom PCB&quot;
        src=&quot;/tech-blog/static/8299933cf0839392f31cd687a1f09883/fcda8/grandbot.png&quot;
        srcset=&quot;/tech-blog/static/8299933cf0839392f31cd687a1f09883/12f09/grandbot.png 148w,
/tech-blog/static/8299933cf0839392f31cd687a1f09883/e4a3f/grandbot.png 295w,
/tech-blog/static/8299933cf0839392f31cd687a1f09883/fcda8/grandbot.png 590w,
/tech-blog/static/8299933cf0839392f31cd687a1f09883/e628c/grandbot.png 619w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Grandbot was looking a little sad in the breadboard and I kept accidentally unplugging things. I thought it was time to move him into a permanent home, so I downloaded &lt;a href=&quot;https://www.kicad.org/&quot;&gt;KiCad&lt;/a&gt; and &lt;a href=&quot;https://www.youtube.com/playlist?list=PLEBQazB0HUyR24ckSZ5u05TZHV9khgA1O&quot;&gt;learned&lt;/a&gt; how to make my own PCBs.&lt;/p&gt;
&lt;p&gt;After a couple rounds of mistakes, I ended up in a good place. Gerber files are part of the &lt;a href=&quot;https://github.com/handeyeco/Grandbot&quot;&gt;source&lt;/a&gt; now.&lt;/p&gt;
&lt;h2&gt;MIDI&lt;/h2&gt;
&lt;p&gt;After learning a little about how MIDI works, I thought it would be fun to make Grandbot &lt;a href=&quot;https://handeyeco.github.io/tech-blog/grandbot-update-arp/&quot;&gt;play synths&lt;/a&gt;. In order to do that I needed to have MIDI in and out, so I added an add-on MIDI board.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/d1e0a7070715b0fec691c075e0a23bd9/2a195/grandbot-midi.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 99.32432432432432%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEaklEQVQ4y1VV2VYiSRSsn+l+cEEQ2aHYqqCgqGIZFjdkB2VRKWVTQXRaT/c5Y//ATP/C/GJMZDnzMA/3ZJKVeTNuRORFGrwOUF6Ucfp0iuK8iOZLA4P3gT1vbBs4fjzGzccNrJ9T1B5qqD/XUV6WMeVv66eFyrJi7xHjxfoCUm1Vw8dfH4hP4thv7sHZccEz8HK+j+h1FM62E+7eEecxHPXcCI1CcHcP4b8KIDyW4eo44b/04+PPDzupJG5LThKITWI46LiRmQRQtmTsNZ1IWSoc7UNkxwGYEz92mwdQbpNw9bzIjP0wxj5+d0MeRaBcK9CmGiRzZuLL2RfI4wgCAw/CjMQoAC/RmIucPUavfIgx/P0j6DMNwUufvSZfcj+RRicydi52EB/HIZ1uThHnrQrLm73qRBdBmohmL1lcvpKr5wyK0zD06xDmXGtt8tyXg3kbhnYdxubNgHmXxG7DwRxJSL33HupvF3CTO20chDoJI2VHCLFhABrH5DgEVQSRi7lYi4+CvDgID8v39r04aB0gKRK2vrVgrvJ2aXkrZh80rQQMKw6Fc7GmW0lkbiLQp1EY9yoK9wmoRGdMY1BYrkyhHEwoeJTOt+eIkL/gVQjVFzGPIzs3kb7PInGrQOWYW5pQ7jSkZzqMVQH6Mo840URv0+hti6hvK9hnQvVGhTT4PkDluWoj7G1yUIY+5G5kGLcy0QZRsKLIEXGWHOo3REW+8lMZCe4rEak8DFFML76efUXiOgGp89ZG4aGAo/YBQh0HAn0PQkJtKilUD3YPEOQBmXzKV36E7dEHH70ZI6c79T0c0lrN35soLouQ6i91mjaOwl0Cx4s0GoskmqsUmkuFPCZwstJwzug+aWg/ptBhtB5S6D6mUZ6pdkI3/fvr71+42PKldN+7aH1vw6S/CgudSA/t290tJ0uI4fy5/GnmpgN+IvbRi35W4eYLkkdh5Mirhwk9XKuta3wpD2UcDXxIj/yorbLIThPwsPzo0M8IoUDeTjYlRJjMT2uFL702JT7uiVHh1rbMajIULIvhH0NIpWUJ+409quRisihG6zTOWbYoMU1xdpsuUqCixxIvSEOb5YrfbYagqUwbnVKkEnXo/+hDar42obNUnTckaZPUXQb5xxKtk4M8iSIzy7AJRMlzgt9VaLSRPI7BoHVkNpQG0Y2fDJo6Cs3KUJRt3T4klC4+FnmAZK/LqG4qyNPwJj0YYukR8mUsDPvilJWyR9VKozKjkPMUfauh/lqnsZ/PiejzYHVTtRPXnmuorCsoPZXsuTpVkL5LE5mMCi+q0rdiv8HI8RWV6AaF3y9/DNgP2TSzd1noc/1/IdBm7jMI8AU52i5E2N4UItJ4UFwqLtDnfEVEHRhS7XsdJ+sTSNVl1W6wgUGAwuzbj1yEi4q62Eg1CmNSLOFHgx1GNGBn+3OPo+Wwm60I0WBL8xKk/msflUUFv/FHYVawW78d9ryEMXm5fTnD/TfGWx3Vh+N/v33u+++MACb+Av4BQJYiwMl8ikwAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Grandbot&amp;#39;s custom MIDI PCB&quot;
        title=&quot;Grandbot&amp;#39;s custom MIDI PCB&quot;
        src=&quot;/tech-blog/static/d1e0a7070715b0fec691c075e0a23bd9/fcda8/grandbot-midi.png&quot;
        srcset=&quot;/tech-blog/static/d1e0a7070715b0fec691c075e0a23bd9/12f09/grandbot-midi.png 148w,
/tech-blog/static/d1e0a7070715b0fec691c075e0a23bd9/e4a3f/grandbot-midi.png 295w,
/tech-blog/static/d1e0a7070715b0fec691c075e0a23bd9/fcda8/grandbot-midi.png 590w,
/tech-blog/static/d1e0a7070715b0fec691c075e0a23bd9/2a195/grandbot-midi.png 620w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;One inspiration was &lt;a href=&quot;https://www.pjrc.com/teensy/td_libs_MIDI.html&quot;&gt;PJRC’s design for Teensys&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/9b3bb532ad21aacc5ea6c9a9277f5b34/82158/teensy-midi.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 32.43243243243243%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA0ElEQVQY01WQyQ6DMAxE8/9fxwEhgcQiAWJJgBL2re1TfGnnENmTsWcS9Xb4/OA8z6ZphmGw1vZ9XxSF1vrlsG0b/Lquy7I8z6NkgIoTtm3bcRzzPJ+mad/3eZ7jOIaktQ7ixDpuVdd12gG3qqrqumZA1NjiICkoruvCnBpZkiTUKoqiIAhQlGWJ+r5vdhtjULObFJ7nsQsP44AtYt/30SsuwjDEjZX0JGeGdx7HweNxE08BDMNcZVlGNEWPVF4OC4WaCPyN/AXM5x+kS9OU2F/84lQecqU8tAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Teensy&amp;#39;s MIDI schematic&quot;
        title=&quot;Teensy&amp;#39;s MIDI schematic&quot;
        src=&quot;/tech-blog/static/9b3bb532ad21aacc5ea6c9a9277f5b34/fcda8/teensy-midi.png&quot;
        srcset=&quot;/tech-blog/static/9b3bb532ad21aacc5ea6c9a9277f5b34/12f09/teensy-midi.png 148w,
/tech-blog/static/9b3bb532ad21aacc5ea6c9a9277f5b34/e4a3f/teensy-midi.png 295w,
/tech-blog/static/9b3bb532ad21aacc5ea6c9a9277f5b34/fcda8/teensy-midi.png 590w,
/tech-blog/static/9b3bb532ad21aacc5ea6c9a9277f5b34/82158/teensy-midi.png 696w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The other was &lt;a href=&quot;https://www.notesandvolts.com/2015/02/midi-and-arduino-build-midi-input.html&quot;&gt;Notes and Volts design for Arduino&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/34dd6c8dd199c93388d669fc71f17e01/7fee5/n-and-v-midi.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 69.5945945945946%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjUlEQVQoz42SV2/CQBCE/f//Cq8gjBAIkE0xvUYU03szosmm5hN2LsZRouyDdd7dmZudPenpisfjwXc2m8Xj8Xq93u/32+12s9kcjUaiervdRL8kYMT9fufc7XYDgUA+n/f7/eVyORaLFYtF8lRXqxV5u80B28jn72FXN5sNQlqtlsg4N0O2Xq+r1SpfwzBKpVKn09F1HfGca7VapVIZDoeLxUJRlMPh8A0ej8eJRIIJVVVlPLiROplMYIELAA2yLMN1PB7hEkql7XarKGomk5lOp5ZlNRqNXC6HSZqm9Xo9G0MJC4HBiKKPVyBWMk0znU7TBwv/+/2eAjqXyyXchUIhGAz6fD7YUYQu2lgHVWx3ZHMhKYjn8znc4XB4MBjQh72Mk0wmQ6EQjqCCpNcw8S+2FYlEotEodIwN4Hw+YwE3Z7PZN/DPVSGJcbBAZACjnOnAv+357w3bj+d0OnGnW7MDpnZ5hfUV1+vVLUc8291u5wXjMI+OTWC79gpGdTfZh1QqhbVe8D8DgR5rPgHwRAuWrmbXLAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Notes and Volts MIDI schematic&quot;
        title=&quot;Notes and Volts MIDI schematic&quot;
        src=&quot;/tech-blog/static/34dd6c8dd199c93388d669fc71f17e01/fcda8/n-and-v-midi.png&quot;
        srcset=&quot;/tech-blog/static/34dd6c8dd199c93388d669fc71f17e01/12f09/n-and-v-midi.png 148w,
/tech-blog/static/34dd6c8dd199c93388d669fc71f17e01/e4a3f/n-and-v-midi.png 295w,
/tech-blog/static/34dd6c8dd199c93388d669fc71f17e01/fcda8/n-and-v-midi.png 590w,
/tech-blog/static/34dd6c8dd199c93388d669fc71f17e01/7fee5/n-and-v-midi.png 781w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Some thoughts on the design:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;MIDI In is buffered and sent to MIDI Thru&lt;/li&gt;
&lt;li&gt;MIDI In is also sent to the RX pin on the Nano&lt;/li&gt;
&lt;li&gt;The Nano’s TX pin is sent to the MIDI Out&lt;/li&gt;
&lt;li&gt;Using MIDI TRS to save space&lt;/li&gt;
&lt;li&gt;The 6N138 optocoupler is per the MIDI spec to isolate the MIDI In circuit from the outside world&lt;/li&gt;
&lt;li&gt;The 74HC14 inverters are also recommended by the spec, I believe to tighten up the HIGH/LOW signals to prevent noise in the signal&lt;/li&gt;
&lt;li&gt;The jumper is to bypass the 74HC14 is not using MIDI Thru (making the 74HC14 optional)&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The switch is because the Nano shares it’s serial TX/RX lines with it’s USB connection&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Both USB and MIDI are serial&lt;/li&gt;
&lt;li&gt;The Nano only has one serial connection&lt;/li&gt;
&lt;li&gt;Programming Grandbot while MIDI was active caused connection issues&lt;/li&gt;
&lt;li&gt;The switch breaks the MIDI connection when set to PROG&lt;/li&gt;
&lt;li&gt;This is also true for &lt;a href=&quot;https://www.sparkfun.com/products/12898&quot;&gt;Sparkfun’s MIDI Shield&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Gerber files for the MIDI board are also part of the &lt;a href=&quot;https://github.com/handeyeco/Grandbot&quot;&gt;source&lt;/a&gt; now.&lt;/p&gt;
&lt;h2&gt;Arduino Nano vs Arduino Nano Every&lt;/h2&gt;
&lt;p&gt;I built this whole project using a cheap Arduino Nano clone. It was never really a problem until I got to the Arp/MIDI at which point I couldn’t use &lt;code class=&quot;language-text&quot;&gt;Serial.print&lt;/code&gt; anymore because the serial connection was being used by MIDI. Despite not having a way to debug, &lt;strong&gt;&lt;em&gt;I still continued to use the Nano&lt;/em&gt;&lt;/strong&gt; because I am dumb. Talk about painful troubleshooting!&lt;/p&gt;
&lt;p&gt;Turns out there’s a thing called an Arduino Nano Every that works as a drop-in replacement for the Nano, but with additional serial ports and a ton more memory. I only looked into it at the end of the Arp feature when I surpassed the Nano’s memory limits. Ironically I had been using the Nano Every footprint in KiCad the whole time - I just thought it meant “every Nano.” 🤦&lt;/p&gt;
&lt;p&gt;My understanding is the Nano Every uses different TX/RX connections for USB and pins 1/2 (the pins I had been using for MIDI). That should mean:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I can &lt;code class=&quot;language-text&quot;&gt;Serial.print&lt;/code&gt; while debugging MIDI&lt;/li&gt;
&lt;li&gt;I don’t need the switch on the MIDI board&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I haven’t confirmed yet though.&lt;/p&gt;
&lt;p&gt;Anyway, the positives:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Official Nano Every is cheaper than the official Nano&lt;/li&gt;
&lt;li&gt;More memory means more steps in the arpeggiator&lt;/li&gt;
&lt;li&gt;Separate serial lines for MIDI and debugging&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The negatives:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Nano clone is cheaper than official Nano Every&lt;/li&gt;
&lt;li&gt;If you’re not using the MIDI board, a Nano clone would be fine&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So right now I’m trying to continue support for both Nano and Nano Every.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Inkscape Tips for Technical Drawing]]></title><description><![CDATA[While working on Grandbot, I had the idea that I would laser cut acrylic for a make-shift enclosure. I’m no fan of Adobe and their business…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/inkscape-notes/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/inkscape-notes/</guid><pubDate>Thu, 11 Apr 2024 21:25:23 GMT</pubDate><content:encoded>&lt;p&gt;While working on &lt;a href=&quot;https://github.com/handeyeco/Grandbot&quot;&gt;Grandbot&lt;/a&gt;, I had the idea that I would laser cut acrylic for a make-shift enclosure. I’m no fan of Adobe and their business model (so Illustrator was out) and most of the alternatives were also prohibitively expensive, so I landed on &lt;a href=&quot;https://inkscape.org/&quot;&gt;Inkscape&lt;/a&gt;: an open-source vector illustration software.&lt;/p&gt;
&lt;p&gt;The software is meant to be for making art and several people online said that using Inkscape for precision work would end in heartache. However I found a few tricks that helped during the process and I’m happy to say that I’ve designed several acrylic enclosures using Inkscape without any issues.&lt;/p&gt;
&lt;p&gt;My local library has an Epilog Zing 24 so I figured I’d use that. The PCB was designed in another wonderful open source software called &lt;a href=&quot;https://www.kicad.org/&quot;&gt;KiCad&lt;/a&gt;; I used its measuring tool to figure out where all my cuts would need to be.&lt;/p&gt;
&lt;p&gt;I just needed to learn a couple things about Inkscape and start drawing.&lt;/p&gt;
&lt;h2&gt;Display Mode&lt;/h2&gt;
&lt;p&gt;The way to tell the Epilog Zing to cut (vs engrave) is to set the stroke-width to 0.001. Unfortunately this makes it virtually impossible to see the design (since the lines were too small).&lt;/p&gt;
&lt;p&gt;Setting &lt;code class=&quot;language-text&quot;&gt;View &gt; Display Mode &gt; Outline&lt;/code&gt; allows me to see the lines of my design regardless of how small the lines are.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 451px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/e86fbe7169b17dd0853aa77e7598a7b7/38070/display-outline.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 108.78378378378379%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsTAAALEwEAmpwYAAAD9UlEQVQ4y5VUSU9bVxj1b2mWpJtk0cCmbIqRzQwGqQFqzBTaRaUmhFaJgJCEwXjC8zw/zyPYxgZbSQhJlTZRumnV/prT77vwXJfSSl0c3af73jv3nPN931V0b/yGL3b+gDn1DrHcKUqtj/BIdURyL1A8eY948RWaP/6OdOUtGue/IlF+jXLzAyovfkGyfAap+BKl0/diL0nvFK2TKnxuJzKpJI5rVTRPGzh/1UK9eohSPkt7NdTrDTQaDRzX66gdH6NKe7UardUaTk5O0Wy20Gy1xKrYDJxh3V7CI2sJm64KjNI5NoJvse5/iceuOla+XcPMzDSmZ7+Cbn4Bi0vLmF9YFODn3t5e3L59C93d3ejp6YFC+eQdtIYzTOvP8eXea2itH/H5+s/o2/oJ6q03MHjSMJnN2N4zIpZII1+qIJMvI5UtoFiuQqUewCc3buDmzU/R1dUFRTaThMPphMfjgdvtRqGQR/WoRBEkEI2EEAxFsL1rwNPnu3C4fbA7PfCHokhl8kjnihif0ODWpcLP7tyBIp7MwmJzElwwW52IxFOISGmEogn4glFI9H7fdIAdvRH7RguR70NvMMPp8SNfPMLS8j0MDQ1hYmIC4+PjUCTSOezsGS5+otV8YIfV4UY8kREKolIKB3TYLhGaLHZSVkCMDmT7pcMaFhaXoFKpMDIyguHhYSiCkTg2t54LwjCp4lNzxUMB/pmJ2WIoIonceC+TLyFKTryBsCiMWq0mwtELwkgsAbc3CH8wgmyhjCwFzmsmVwKr52cTqdaTXS4CqyofHSOdLUJK5bB8b4UIVRgdvSTkn1id0WIT2XBmvMeWvP4QHq9vYOXrbyirFXx3fxUPVtdw/8FDrD5cw/c/PMLU1JTIkC0zFFIyg2c7ehG2jCdPt0V2PrKkmZxEX18fBgYG0N/f3wEllEolBgcHhTImFQo5F18gQmrCgsDjC4ls2FKMSLVzOoyNjWGSiK+DRqMRFZahYIt7+yYYzTbRCgVqXM7RYnVQxR1YoImQW+Iq+CBe/0aYoGD5Rya0O72iCLnCoQBXdE6nE3bYmrzK6Nxnu+2i2KjvWJ2TJsFqd8HlDYi2Sabz0Onm2x/LwXdCJvurKCmaBONllak1bDRa3HuiDylfmVCupEwuk3QSCoVJmkmPL4hgOC4Uxqnq3GecY5LUX0fYuf6DkBXynBpMVjGrrNRNljM0doz/rZCDF/kRApcjxqN20TZpUZROwv/KsG2Zq+tweUUfFsoVuvOOxOgx8Rz14Qh9KFfzKuTGbhMGwjGqrFvMs9Ptp2tLEoSMLF0CbPmq1evQJpyZncXdu9NtzNBVr9XOCczSM08CN++/tY0M+f2f5z0/i9icrwAAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;An example of the outline display mode&quot;
        title=&quot;An example of the outline display mode&quot;
        src=&quot;/tech-blog/static/e86fbe7169b17dd0853aa77e7598a7b7/38070/display-outline.png&quot;
        srcset=&quot;/tech-blog/static/e86fbe7169b17dd0853aa77e7598a7b7/12f09/display-outline.png 148w,
/tech-blog/static/e86fbe7169b17dd0853aa77e7598a7b7/e4a3f/display-outline.png 295w,
/tech-blog/static/e86fbe7169b17dd0853aa77e7598a7b7/38070/display-outline.png 451w&quot;
        sizes=&quot;(max-width: 451px) 100vw, 451px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;Bounding Box&lt;/h2&gt;
&lt;p&gt;I’m not sure the bounding box setting made a huge difference, but I thought it was worth mentioning. What this does is change the reference point for where you’re positioning elements: visual bounding box includes the stroke width in calculating a shape’s position whereas geometric bounding box does not.&lt;/p&gt;
&lt;p&gt;If you’re positioning things before changing the stroke width and getting confused as to why your x/y position is changing, it’s probably because you need to switch to geometric bounding boxes.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Preferences &gt; Tools &gt; Bounding box to use&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/a9717c12cd9131fd0fac059062550973/0786c/bounding-box.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACZ0lEQVQoz3WRW08aYRCG9480iMS27C5yUFNg0e5yloOweEhMFERNmvSmN73uX2iNBNPGNAhKBLGxDWIFBKq2TY/ihXf9L2+/+VLsRdOLJ/PtZOadeWeF9dwVHuV/4tn2BY6OO3jb/IzWZR+dTzdonffRPL/Cae8HWhd9tBlnH6/xvvcdbVbT6HzFSfcbzi6vOV/6vyDU63UUiyUUS7vYr9ZQrhygUiig06yh3q6j2+mg1+v+pdvFBxYpT7HdbuGk0UDz9BSNxjGEcuUQ+ZfbeL2zh9qbd9jMv8J8IoFseg5Lq0vIZrKYX1hAKjWL2dl/SbDa6elpxGIxRKNRCKW9fWzktrDFREvlCnYZD70+SHY37BOTsIy5Yborwmi4g6GhIRgMhluMRiOGh4dhMplYNPEoFJng840cXmzmmVgV+weHCIbCcDhVmJnoiOUBRIcCkQY4xqC43XC5XHA6nbDb7RgdHYXVauXQW6jWjlAollEolUHvndIeAqEI7msZTOhPIUWeYMT/GAZPGhbbBNxMMBgMclRV5aKyLMNisXCEdGYFK9lVLC+nsba2jsxKFoqiQJbMmEsloSfisFtlyOI92Gw2+BNLCIfDiEQi8Pv9fFtJkiCKIhcWNK+GmZkZxOMxdtgoPyzZkSQZHo+HN6uqdmtvamqS56LRCDRNYxu7+AKK4obD4YAQCoWQ0lNIJpMc+ms01Ww2Y3x8HLqu84HURDmr1Qav18vEVC5I1v0+H6+lOwohNo2aSIig5oEgxcXFRb4RFdONyBbZG9gcQN/cMhXrfzYbCJJlKvKxyYFAgAsNGgbH/x+/Aa41yb6yFqOgAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Bounding box setting in preferences&quot;
        title=&quot;Bounding box setting in preferences&quot;
        src=&quot;/tech-blog/static/a9717c12cd9131fd0fac059062550973/fcda8/bounding-box.png&quot;
        srcset=&quot;/tech-blog/static/a9717c12cd9131fd0fac059062550973/12f09/bounding-box.png 148w,
/tech-blog/static/a9717c12cd9131fd0fac059062550973/e4a3f/bounding-box.png 295w,
/tech-blog/static/a9717c12cd9131fd0fac059062550973/fcda8/bounding-box.png 590w,
/tech-blog/static/a9717c12cd9131fd0fac059062550973/0786c/bounding-box.png 663w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;XML Editor&lt;/h2&gt;
&lt;p&gt;No matter what I did, the stroke never really ended up being exactly 0.001. Luckily SVG is just XML and XML is relatively straight-forward to edit manually.&lt;/p&gt;
&lt;p&gt;To view the SVG output, you can go to &lt;code class=&quot;language-text&quot;&gt;Edit &gt; XML Editor...&lt;/code&gt;. Digging through the markup will show you the individual elements and their styles. Inkscape also seems to save things as SVGs which you can open in a text editor. Personally I opened the SVG in VS Code and did a find-and-replace: something like find (regex) &lt;code class=&quot;language-text&quot;&gt;stroke-width=&quot;\d\.?\d&quot;&lt;/code&gt; replace &lt;code class=&quot;language-text&quot;&gt;stroke-width=&quot;0.001&quot;&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/9a11bdb502c1090210b1c73841490a6b/e185b/xml-editor.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 86.48648648648648%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAADoklEQVQ4y12U228bRRjF9z9BPKDYXl92fdldJ7bXwYkSCBURiD7whAoIBA8IwQslDS2ICpBSlUBTx6ndOL6v1+v7vXarNLiQtgkBids/c/hmclHah59m7NGcPfN9Z0b4JHGIVHUP3dEjVHt7qBHV7kM0+r+gMZigOZygv/sUDyZ/ond/H/cnRxjtHWDv8V/49fBfPDr4B5OnxJO/8dvhfxC6nTYarTY6/XvoD0fE+IQRuoN7aHYGGJfTqPcz6Pd6qFVNtNst1Os1mltoNuoYDgfYe7iL2xsbELKFMhgFw4JRqaNsNU7GOgrlKm78eAvzi4t45fVlLC4tIxjS4fP54Pf7nyEYDEL2eiFspXaQvJuBVWtxoVOYcL5YwXffr2FGj0FSQvAEpiHLKpyiA1MOO2w2OxwOB402qKoKXdchpLazSCTTMKtNlJnQCabZQMPqYfOnJELhMG2YQTQahl9hTlRyKUMJyPDKElwuNzweibsUCqUKdrJFZHIGDLPG3XGxchdjYxfmugWNjqRoESzOz2NhLoywMg1d8SIWkaEF3HCRY9E+RR9VILDj3lzfQJ6ET11alSb65gj7+ceoXa9Bjr2LqbkPoL/5EfQ3PoZ/4UPYZ9+Hfe49vDR7CS9G3sEL4UuQIxeohnRcJsjGeCKFbL6MmtXBwBjj98IRqter8KtRTLkDsEtB2CSNUI/xqPSfBlHW+DygzUBIZwpgjTHO1c8yyWFphKPSH2j80ITi80N02OB2iXA7HRzXc7B1VQlAyFFkmGi+aILVs0jxsSotDMpjHOQO0VvrU5006qYNTqcTIsdFjTiH2w1RdEJRVOpyOov1n+PYiN/hgqwxltVCxxxi33iC5loLsYW3ob28hNjsAsJ+BT5ZhtP1rKgoijw6AnO2vZPnDkskxiNTaaBmtjG0HqAUN6HPLUOJvIrp6BKmg1EEZ8KQvD4qgQtucsdg7rngdiaPza27nDhxezPJnTLRXK6Mmzdu4cJrS5iN0g3xyvBRhBgyuQwEAhw299ItOXZIm1kNmcts3uDxYYI5cmyYdSTubOOtixcRiejwSBJ3wgI8T5lkY5hCHwqFqH7KsSC7x0yMkSFBfvVYwIkK5TKeSNKmCCRJOquVx+Phzk5FGGcO2aYiPQJlOmK9Sa9Js3sG+72VSvPHwG63c0HmkMHu8HnYOvuA8OXKKr64vMJZuXIVq19dwxVi9erXuPbNt/j0s8+5oOtcA56HOWbrmqbhf7i/F/VcC7PeAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;An example of manually editing the SVG in the XML editor&quot;
        title=&quot;An example of manually editing the SVG in the XML editor&quot;
        src=&quot;/tech-blog/static/9a11bdb502c1090210b1c73841490a6b/fcda8/xml-editor.png&quot;
        srcset=&quot;/tech-blog/static/9a11bdb502c1090210b1c73841490a6b/12f09/xml-editor.png 148w,
/tech-blog/static/9a11bdb502c1090210b1c73841490a6b/e4a3f/xml-editor.png 295w,
/tech-blog/static/9a11bdb502c1090210b1c73841490a6b/fcda8/xml-editor.png 590w,
/tech-blog/static/9a11bdb502c1090210b1c73841490a6b/e185b/xml-editor.png 691w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;That’s it for now. It was otherwise pretty straight-forward to design my stuff in Inkscape and the laser cutting worked without a hitch. Very grateful to the maintainers and contributors of Inkscape and thrilled to live in a world where we have these tools freely available to us. Also very grateful to my local library for having a freggin’ laser cutter available!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Databending with Web APIs]]></title><description><![CDATA[An example of an image that was databent using my web-based databending application. Databending with Web APIs This repo hosts this blog…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/databend/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/databend/</guid><pubDate>Sat, 24 Feb 2024 03:25:23 GMT</pubDate><content:encoded>&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/d2c7ee658c299cd6400a5235cded5c34/00d43/graffiti_application.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 66.89189189189189%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAADUUlEQVQ4yw2SWVcaaQBE+dnzNpkzJ2POLOpJ4rgMOIooIIIsCjYgyt4sLSA0DQEUgiibC+4E/W54r4dbVVd3l0zy5Oxw6ZLx/KVg2dgVWyYfTn0Mz3KAtKFOdVaj80HhyBXAHJI5LqcZ2FWk33IE54KEP4VY/5AlO19C11/Li8u5mqh8qQtpqSrWt6vI9qq49JWoL+UpLse4WqrSMVd5coQ58bnpH3vBKHP+e4b02gk5RcW7MeDMVka3YxxR3+lT/f8Gm71NMNcnk+two0LT8kT5nyrXc2WSR0XacgctInNnzvJuPWa0FaTo19DUNgeFEf6DB3QbXkFx4YHIvIbXfolHbuFONamfPdN03ZLXy7x+LdL35+k787R3M7QSXS43FUaGDIq5TjozIJ6/Q968Q5ewD4jaiiR8fdzeLttTilC+x/DsFdV2i/pfmMetDNrWPremAEN3louVe1r6E06/xrDN1VHOe/gzQ9LWIbpe4BzZ3GTXMmE31cUvXZBIdrmLP3PlGdCYlenov/GwH2AS9DFyxujNlhkZs+RWI7hnkhSSJapqi4y3gq4WqXGw18cutcm36rhWG8iGAQ/KhPH+gPrnAr71HB3nHk/HPl7XNHJ/nnJlDZE1Rzj8qE0rt6mUK1TcOXRKoYAnUKcWP6Afz/JttclwucZ9tEtLGuDfVAkb0rzse3n2hEA65eVQ4934nbZBJfSxi+ysUlJTOJQ0OtPfKpaURjfqo+fx87hYAnOJrK/AmvEcm14huiIxth7x7o/w2tG4Td+gLIxozFTI/1omEQ+TSeSQwuqU8FOWtLnIYDVM3+DnxZSZUpyh2MsEHDmizjCapTf17UoEFu/FpvqDYuqGE/2A8vKlYDUveq0UyZgyVegQ3fnnCg1HhonNxqNk5NWv8uqqsLv1HdOXEsHQIbG9kXC6nvBsvImVzLOIlcdcG16E8u+QvEUjrmWFkkgKRTqeiu0YE99r8OwvMHFUeDNdcL1XwTtzSnC/RLSpCVd0QrA0EeW3d+HmDe8J4nR+zMEvTRE46ohAJY6UuCCUGgtdyAqH0anE0gR2gIUbBu4SnqUakjWPW18X87vTFYaPovHjWXimkZ00wrw3xvzHkVjcPhPOo6ywyi/iePrZT6WFZqyz3y+cAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Image that has been databent with my custom databend application&quot;
        title=&quot;Image that has been databent with my custom databend application&quot;
        src=&quot;/tech-blog/static/d2c7ee658c299cd6400a5235cded5c34/fcda8/graffiti_application.png&quot;
        srcset=&quot;/tech-blog/static/d2c7ee658c299cd6400a5235cded5c34/12f09/graffiti_application.png 148w,
/tech-blog/static/d2c7ee658c299cd6400a5235cded5c34/e4a3f/graffiti_application.png 295w,
/tech-blog/static/d2c7ee658c299cd6400a5235cded5c34/fcda8/graffiti_application.png 590w,
/tech-blog/static/d2c7ee658c299cd6400a5235cded5c34/efc66/graffiti_application.png 885w,
/tech-blog/static/d2c7ee658c299cd6400a5235cded5c34/00d43/graffiti_application.png 1000w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;An example of an image that was databent using my &lt;a href=&quot;https://handeyeco.github.io/databend/&quot;&gt;web-based databending application&lt;/a&gt;.&lt;/p&gt;
&lt;h1&gt;Databending with Web APIs&lt;/h1&gt;
&lt;p&gt;This repo hosts this blog post and a simplified example:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/handeyeco/databend-blog&quot;&gt;Source&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://handeyeco.github.io/databend-blog/&quot;&gt;Demo&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It’s based on the work for a web application that builds a UI around this concept:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/handeyeco/databend&quot;&gt;Source&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://handeyeco.github.io/databend/&quot;&gt;Application&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Intro&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Databending&quot;&gt;Databending&lt;/a&gt;, like circuit bending, is a way of creatively breaking technology to generate unique and unexpected results. In circuit bending, the idea is to mess around with the underlying electronics: modding, jumping, and shorting to find interesting ways to break circuits. In databending the idea is to break things in the data layer.&lt;/p&gt;
&lt;p&gt;Computers operate in 1s and 0s. We might see an “a” in a text file, but a computer will see “01100001”. The fact that we’re just dealing with numbers is important to databending: when we run an audio file through an EQ or an image through a filter, we might think the application has some sense for what a song or a picture is, but ultimately it’s just doing math. So what happens when we run an image through an EQ? Or an audio file through an image filter? That’s one sure-fire way to break things!&lt;/p&gt;
&lt;p&gt;A common example of databending (and how I learned about it) is to take the free audio software &lt;a href=&quot;https://www.audacityteam.org/&quot;&gt;Audacity&lt;/a&gt;, use its “raw data” import option to load in an image, run some audio effects over the image, and export the bits back out as an image file. Here’s an example of an image bent with Audacity:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/1cbd3e47a52f647f28fe577c3e9b587a/00d43/graffiti_audacity.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 66.89189189189189%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAADiElEQVQ4yw2SWVOaBwBFP3dj3Y3RiEtcqmka3I0UrRuuiETAjYALuDBiBAGLKAoogqKCyxgJVqdpko5tMunkoZ3pS1/6x059uK935txzhZF6ObUvFIjNAWRzC+zseBiyHvHQasYb2CUWjRA6vuHu3R80m45oeaqlTGams1XPl+NLVtd8zHjsWC7DzIQiCC8Vagrtt5SHYuRHoog1LoSza4ToHaHoV2xXH1nctGE/v6BmbIT+wWWUBheS8QH8TjW+rVVaaqvIfC6iY0uCsLosYzgUZskVRbQ+T2X1U2pOb0k9OqF795Spg0NUtnXskVY29hsZ8pfzbEiEVyvlT7+Jfy8Wkbe1kZWRQan5GwSt2UCW45JczwU5piB5jV24Q+P4f/VRtnPE2lYfxoCeSU8RC45eps9F1Kkz2Ohv5L1PzZWtj1fdz/nucRVlzjwE6T1CjvOceo2TjOlDHr6c5SpswP/+DQZLGNOem25tLxtni+y+XaPdJSVsleDfbibizuZ0R4FC0kBZQR4FP6UjTAxYeKYPkeLdJqn/hGSThx9inyi1eTGqTFjWTpCZfaiCB/ReXdCh7yOsKMFtK+fgdRG/eDuZ0FaTlZ1O9vh9oXXYzlhTgDTPBg+kE/cmj3EHf6PEEMTYN4MpGGYodk37z9d0Bj5gHRzhk6MBjaOHWaWBD0ExstF6ku83zJ2MQ7BUKKkRH5Eos5KmmSfr4nfKbx0I803U9/Uw+faakcAmUxMx1g1etqd0nNTNUuxxI3Hd0HgeIFu5QEF1D5WqHxEWXcOs3l8ls3KZ9FM/OQE71cEalN5+6h0D1B2cUXcbQCc/x2Y8JNY7irdCS44/yCPbR3J3PyNMHTMq1+K8uUFQbGxx0Kskqn3M/ryYu2kRhvECGow9tLzKJ0U5RfxZhKoTJ+3aKMOGCIcFOoocbyjZ/EzxQgyhopfZZTuv90IIcs0Svsbv+Wu6mduxdr7aVZjbE0lVldLmaEUvNyGd2+PJ+hZK5RE6rYt9kY586xdSV/4mfXSFxEIJlvP/CF3/gzCnVeGrSyHYn8iu4gHvxuLYrBVo8qehGZnGkFnJWMcqVrUSTXwCu8nZTBV/S5y7maSlBuLVYjKqulgZW2ZpSIewfjVIUJqAV/+IJZ2IHb3A3mA8XaYk1BorjtYF1DNu5hpEDAsCivt0VSaQNJpI3KyAMJNK4QstK/ObGPWT/A+i6hAJC7lb1wAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Image that has been databent with Audacity&quot;
        title=&quot;Image that has been databent with Audacity&quot;
        src=&quot;/tech-blog/static/1cbd3e47a52f647f28fe577c3e9b587a/fcda8/graffiti_audacity.png&quot;
        srcset=&quot;/tech-blog/static/1cbd3e47a52f647f28fe577c3e9b587a/12f09/graffiti_audacity.png 148w,
/tech-blog/static/1cbd3e47a52f647f28fe577c3e9b587a/e4a3f/graffiti_audacity.png 295w,
/tech-blog/static/1cbd3e47a52f647f28fe577c3e9b587a/fcda8/graffiti_audacity.png 590w,
/tech-blog/static/1cbd3e47a52f647f28fe577c3e9b587a/efc66/graffiti_audacity.png 885w,
/tech-blog/static/1cbd3e47a52f647f28fe577c3e9b587a/00d43/graffiti_audacity.png 1000w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;(&lt;a href=&quot;https://unsplash.com/photos/green-and-yellow-abstract-painting-WKQt_X-SKFI&quot;&gt;Original image source&lt;/a&gt;; &lt;a href=&quot;https://www.youtube.com/watch?v=cXjwJPz4qi0&quot;&gt;Audacity databending tutorial&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;It’s fairly easy to do, but it’s also fairly easy to do irreparable damage to the image file. That’s because in most files there’s a section of the bits devoted to the data and there’s a section of the bits devoted to metadata (the header). Running the header through the databending process can result in a file that can’t be opened because at a certain point applications can’t understand enough of the metadata to open the file.&lt;/p&gt;
&lt;p&gt;It’s also a long-ish iteration cycle. Audacity isn’t showing a preview of the image you’re destroying because it doesn’t know it’s working with an image; Audacity is just doing math with a bunch of bits you handed it.&lt;/p&gt;
&lt;h2&gt;The thing I made&lt;/h2&gt;
&lt;p&gt;As a kid I enjoyed breaking photos with Audacity to make pseudo-generative art and then I became a web developer. So after rediscovering databending, I decided to make my own application to speed up the process. In modern browsers we have a few tools that are relevant to this project:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API&quot;&gt;Canvas API&lt;/a&gt;: an API for working with images&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API&quot;&gt;Web Audio API&lt;/a&gt;: an API for working with audio&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://tonejs.github.io/&quot;&gt;Tone.js&lt;/a&gt;: a library that takes the very low-level building blocks from the Web Audio API and abstracts them into higher-level audio tools (like BitCrusher and PitchShift).&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;With these tools, I made the &lt;a href=&quot;https://github.com/handeyeco/databend&quot;&gt;databend&lt;/a&gt; project. It uses the Canvas API to convert an image into a bunch of numbers, runs the numbers through different audio effects provided by Tone.js, and then converts the resulting audio data back into an image.&lt;/p&gt;
&lt;p&gt;It doesn’t muck with the headers because it’s just manipulating the actual image/audio data. It knows its job is to destroy images, so it provides some previews of how the image will look on the other side of the process.&lt;/p&gt;
&lt;h2&gt;How it works&lt;/h2&gt;
&lt;p&gt;The code here will be based on the demo in &lt;code class=&quot;language-text&quot;&gt;index.html&lt;/code&gt; (&lt;a href=&quot;https://handeyeco.github.io/databend-blog/&quot;&gt;shown here&lt;/a&gt;). To see the full application code, check out its &lt;a href=&quot;https://github.com/handeyeco/databend&quot;&gt;Github repo&lt;/a&gt;.&lt;/p&gt;
&lt;h3&gt;From image to audio&lt;/h3&gt;
&lt;p&gt;The first step is getting image data. We do this by creating a Canvas context, rendering an image with it, and then pulling out the image data.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// pretend you have an image object&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// like by using `new Image()`&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; width&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; height &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; image

&lt;span class=&quot;token comment&quot;&gt;// Create a canvas twice the height of the image&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// so we can show before/after&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; imageMount &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getElementById&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;image-mount&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; canvas &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;canvas&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
canvas&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;width &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; width
canvas&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;height &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; height &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
imageMount&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;appendChild&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;canvas&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Draw the original image&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; context &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; canvas&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getContext&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;2d&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;drawImage&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;image&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; width&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; height&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Get the image data&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// this is confusing: getImageData returns an object&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// containing a property called data&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; imageDataContainer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getImageData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; width&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; height&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; imageData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; imageDataContainer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;data&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;(&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/getContext&quot;&gt;getContext&lt;/a&gt;, &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/drawImage&quot;&gt;drawImage&lt;/a&gt;, &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/getImageData&quot;&gt;getImageData&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;So what do you have at this point? You’re now the proud owner of a &lt;code class=&quot;language-text&quot;&gt;Uint8ClampedArray&lt;/code&gt; representing the image. It’s a 1D array that describes each pixel with four values: red, green, blue, and alpha (transparency). Each value is represented as a number between 0 and 255. So one pixel of fully opaque &lt;a href=&quot;https://www.color-hex.com/color/4682b4&quot;&gt;steelblue&lt;/a&gt; and one pixel of fully transparent &lt;a href=&quot;https://www.color-hex.com/color/fa8072&quot;&gt;salmon&lt;/a&gt; would be:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// R, G, B, A, R, G, B, A&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;70&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;130&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;180&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;250&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;128&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;114&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Audio works with floats between -1 and 1, so we need to do a conversion:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;number&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; inMin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; inMax&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; outMin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; outMax&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;number &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; inMin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;outMax &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; outMin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;inMax &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; inMin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; outMin&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Convert image (0 to 255) to audio (-1 to 1)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;convertImageDataToAudioData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;imageData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; audioData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Float32Array&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;imageData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; imageData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        audioData&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;imageData&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; audioData
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;Through Tone.js&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;I didn’t say this earlier, but thank you to the maintainers of and contributors to Tone.js. It’s just a gem of a library.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;At this point we have a Float32Array that looks enough like audio that we can pass it to Tone.js. In the application code, things gets a little convoluted here. I wrap each Tone.js module in a wrapper that allows me to apply a dry/wet mix.&lt;/p&gt;
&lt;p&gt;I also add an option to split the color channels before running the data through Tone.js: remember that the array is sorted as [R, G, B, A], this option creates four arrays ([R], [G], [B], [A]), runs them individually through the audio effects, and then merges them again on the other side. It’s hard to explain this, but think about a delay: a delay takes information from one position in the array and applies it to another position. By processing all the colors together, information from the red color might affect the blue color or alpha values. By splitting them, red will only affect red. Also it gives me the ability to only apply the effect to one color at a time.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Anyway&lt;/em&gt; here’s what it looks like in the demo when we run the data through Tone.js (without all of that added complexity):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;processAudioData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;audioData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; audioContext &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Tone&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getContext&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// Create offline renderer so we don&apos;t have to wait for the &quot;audio&quot; to &quot;play&quot;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// before we get a buffer back that we can either manipulate more&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// or convert to an image&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; rendered &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; Tone&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Offline&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// Create a one channel Web audio buffer to load audio data into&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; buffer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; audioContext&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createBuffer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; audioData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; audioContext&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sampleRate&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; buffering &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; buffer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getChannelData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// Fill the buffer with our data&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; audioData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            buffering&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; audioData&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;


        &lt;span class=&quot;token comment&quot;&gt;// Create the Tone buffer module to play the audio data&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; bufferNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Tone&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ToneBufferSource&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;buffer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// Create some effects that will process the audio data&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; phaser &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Tone&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Phaser&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token literal-property property&quot;&gt;frequency&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; chebyshev &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Tone&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Chebyshev&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token literal-property property&quot;&gt;order&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// Connect all the pieces together,&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// including sending the data to the destination (output)&lt;/span&gt;
        bufferNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;phaser&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        phaser&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;chebyshev&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        chebyshev&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;toDestination&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// Start the buffer playing&lt;/span&gt;
        bufferNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; audioData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; audioContext&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sampleRate&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; audioContext&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sampleRate&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// Pull the raw data out of the updated buffer&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; processedAudioData &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; rendered&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getChannelData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; processedAudioData
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;(&lt;a href=&quot;https://tonejs.github.io/docs/14.7.77/fn/getContext&quot;&gt;Tone.getContext&lt;/a&gt;, &lt;a href=&quot;https://tonejs.github.io/docs/14.7.77/fn/Offline&quot;&gt;Tone.Offline&lt;/a&gt;, &lt;a href=&quot;https://tonejs.github.io/docs/14.7.77/ToneBufferSource&quot;&gt;Tone.ToneBufferSource&lt;/a&gt;, &lt;a href=&quot;https://tonejs.github.io/docs/14.7.77/Phaser&quot;&gt;Tone.Phaser&lt;/a&gt;, &lt;a href=&quot;https://tonejs.github.io/docs/14.7.77/Chebyshev&quot;&gt;Tone.Chebyshev&lt;/a&gt;, &lt;a href=&quot;https://tonejs.github.io/docs/14.7.77/Destination&quot;&gt;Tone.toDestination&lt;/a&gt;, &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/BaseAudioContext/createBuffer&quot;&gt;createBuffer&lt;/a&gt;, &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/AudioBuffer/getChannelData&quot;&gt;getChannelData&lt;/a&gt;, &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/AudioNode/connect&quot;&gt;connect&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Steps:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Since we don’t actually want to listen to the audio, we create an offline Tone instance. Besides saving us from harsh noise, it also speeds up the process since it can run as fast as possible to render audio (rather than have to play the audio at a normal speed).&lt;/li&gt;
&lt;li&gt;We create a &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/AudioBuffer&quot;&gt;Web Audio API buffer&lt;/a&gt; and populate it with the data we generated in the image-to-audio step.&lt;/li&gt;
&lt;li&gt;We create a Tone.js ToneBufferSource (using the Web Audio buffer) and some effects, connect them, and start the buffer playing.&lt;/li&gt;
&lt;li&gt;Tone.Offline returns a promise containing the buffer which contains the data we’ll convert back into an image.&lt;/li&gt;
&lt;li&gt;Once it’s all processed, we pull out the raw data from the buffer: another Float32Array.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This is where the bulk of the experimentation happens. Here you can tweak the settings for the effects or replace them with any number of other Tone.js modules. For each new module, just make an instance using the constructor and add connections using &lt;code class=&quot;language-text&quot;&gt;.connect&lt;/code&gt;. Dig through the original application code to see how I added dry/wet mixes (although some effects have this built in) and the option to process individual colors.&lt;/p&gt;
&lt;h3&gt;From audio to image&lt;/h3&gt;
&lt;p&gt;From here we’ll scale the audio data (from -1 to 1) back to image data (from 0 to 255) and drop the updated pixels back into the Canvas context:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Convert audio (-1 to 1) to image (0 to 255)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// (mutates the original imageData array with the new data)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;convertAudioDataToImageData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token parameter&quot;&gt;imageData&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; audioData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; audioData&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        imageData&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;scale&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;audioData&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Draw the modified image data&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// (offset by the height of the image,&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// so it doesn&apos;t overlap the &quot;before&quot; image)&lt;/span&gt;
context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;putImageData&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;imageDataContainer&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; height&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;(&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/putImageData&quot;&gt;putImageData&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;Here’s the same image from the Audacity experiment, databent by playing around with the demo code in this repo:&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/4890c354eb5f723d06e99504289310de/00d43/graffiti_databend.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 66.89189189189189%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACj0lEQVQ4yy2S61LaUBSFef8HaH/0X5+grdOZTp2249RbqcpFQQUFgigBglyFEMha/Y42M2f2ycnJ2ntdChqO7GVfbt7Ld2d251A+OrHbj/J6LO9mcjKXPxzLxbpdrcj313K1Y+1Puc+9Rs3+VpX3Si44K0saWZ2p9XRLPZYOitJ0zppKs5nUon5vWZVnqcd7yt27hXS5krJHyQNpMJEasQra9mxzOHqQkqX0HMt/aVBifzqzhoA9sFqZNdhZM78+Wm2kRxrsAMtp7q3FcUGztrVe0aRv9QDuA9zM7Xhp/aJrvLH6qRRtpToLEkpzaUyzOwC3IzkHdMvdjaGcPtBvIrcurXJH6nKhklrLJ6kdW/dtqcYEhwDsA9AAdMqki9xKXpguAIa6snZhwrRrpQh7HlnNmhUxZdRjKiZ+SaSLrvQTykXAzgewWEv8r0zWI5M/Y1zQEHweQ/lMmrTtq4jOVWgBdtmVY4CTWPpxb/0eS9WhVHpARwCZRPmL1WJfXrxRdjiDsnTFy5W9eqJA+bxBJIKOONhGx1NqVJejExqeM1nH3mDYgG97jPpnCVYKHA2cBMpjK6tJq7pVK9ldQPv8EAFUxkmypuRInh+QyyJ6I9EN5+9G0pcq0yNDlmEKWmc3TDgGIAg8RQ/EMfZ7CZU1VJa53CHYaQX62Eu1+TaiyREaF8lwE/MyDHtpSvM2gBPc3YVsE48ecYj4IcRqgJtxWADml/KmjnZobaYpD633LfvHqd1MoDs35sAkAbCB7QkqtwDt8q3skDW7Qg1na6oBEzrqNdLoh3Zfye4ndLxeoemCGEF9OgKwtPgPROcD1iF7PDGmKmZ/+wyd0CEI/xYN09937D9y/Bm5ggRDzLqI/A/9sdxHuePZWwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Image that has been databent with Audacity&quot;
        title=&quot;Image that has been databent with Audacity&quot;
        src=&quot;/tech-blog/static/4890c354eb5f723d06e99504289310de/fcda8/graffiti_databend.png&quot;
        srcset=&quot;/tech-blog/static/4890c354eb5f723d06e99504289310de/12f09/graffiti_databend.png 148w,
/tech-blog/static/4890c354eb5f723d06e99504289310de/e4a3f/graffiti_databend.png 295w,
/tech-blog/static/4890c354eb5f723d06e99504289310de/fcda8/graffiti_databend.png 590w,
/tech-blog/static/4890c354eb5f723d06e99504289310de/efc66/graffiti_databend.png 885w,
/tech-blog/static/4890c354eb5f723d06e99504289310de/00d43/graffiti_databend.png 1000w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;This isn’t the most performant way to do this. It’s laggy and front-end JavaScript is probably the last place we want to be processing large numbers of bits. I’m sure WASM or Web Workers or C++ would be a better alternative. I am glad I made this though; it highlights how far web APIs have come and how many tools we have available to us on the front-end. Plus I used this to make art that landed me on the cover of a zine I admire!&lt;/p&gt;
&lt;p&gt;Anyway, hope this helps someone. Happy hacking!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Concurrent Arduino]]></title><description><![CDATA[For a more fleshed out example, you can see how Grandbot uses this behavior as of this tag for his light and voice. In an effort to create…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/concurrent-arduino/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/concurrent-arduino/</guid><pubDate>Wed, 27 May 2020 21:25:23 GMT</pubDate><content:encoded>&lt;p&gt;&lt;em&gt;For a more fleshed out example, you can see how Grandbot uses this behavior as of this &lt;a href=&quot;https://github.com/handeyeco/Grandbot/tree/2020-05-27&quot;&gt;tag&lt;/a&gt; for his &lt;a href=&quot;https://github.com/handeyeco/Grandbot/blob/2020-05-27/src/Light.cpp&quot;&gt;light&lt;/a&gt; and &lt;a href=&quot;https://github.com/handeyeco/Grandbot/blob/2020-05-27/src/Voice.cpp&quot;&gt;voice&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;In an effort to create smooth RGB LED transitions in Arduino in a way that didn’t completely block the main thread, I explored tweening using a repeatedly called update method in the class controlling my LED. Unfortunately part of my project, a buzzer playing a little melody, also blocked the main thread and broke my LED tweening. This was an existing bug that also blocked interaction with the project, so it was an opportunity to learn more about keeping the main thread free while improving the project.&lt;/p&gt;
&lt;p&gt;In this post I’ll talk about creating long-running yet non-blocking transitions for RGB LEDs and also cover a strategy for playing melodies with the Arduino &lt;code class=&quot;language-text&quot;&gt;tone&lt;/code&gt; function without blocking the main thread.&lt;/p&gt;
&lt;h2&gt;RGB LED transition&lt;/h2&gt;
&lt;p&gt;A naive first try at an LED transition might look like this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; currR &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; currG &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; currB &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; g&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ...write to LED...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;transitionComplete&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    currR &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; nextR &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;
    currG &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; nextG &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;
    currB &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; nextB
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sign&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Gets called once&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; nextR &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; nextG &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; nextB &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;transitionComplete&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    currR &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sign&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;nextR &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; currR&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    currG &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sign&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;nextG &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; currG&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    currB &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sign&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;nextB &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; currB&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;currR&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; currG&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; currB&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This should transition the LED correctly between two states, but unfortunately the &lt;code class=&quot;language-text&quot;&gt;while&lt;/code&gt; loop blocks the main thread preventing the Arduino from doing anything other than transitioning the LED.&lt;/p&gt;
&lt;p&gt;The solution that worked for me was setting the next state in a separate method and creating a frequently called &lt;code class=&quot;language-text&quot;&gt;update&lt;/code&gt; method that tweens between two states. Tweening is a technique in animation that is used to transition between two states based off of an animation length and the current progress.&lt;/p&gt;
&lt;p&gt;There’s a lot more to keep track of and some &lt;em&gt;math&lt;/em&gt;, but it’s an effective way to transition the LED.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; prevR &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; prevG &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; prevB &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; nextR &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; nextG &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; nextB &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Find the difference between the two states&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; deltaR &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; nextR &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; prevR&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; deltaG &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; nextG &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; prevG&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; deltaB &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; nextB &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; prevB&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Animation should last 2 seconds and start now&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; animationLength &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
unsigned &lt;span class=&quot;token keyword&quot;&gt;long&lt;/span&gt; animationStart &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;millis&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; g&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ...write to LED...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Gets called repeatedly in the main loop()&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// Determine how long the animation has run&lt;/span&gt;
  unsigned &lt;span class=&quot;token keyword&quot;&gt;long&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;millis&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; elapsed &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; animationStart&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Determine progress through the animation&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// capped at 1 (100%)&lt;/span&gt;
  float progress &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;float&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; elapsed &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; animationLength&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  float capped &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;progress&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Tween&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; r &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; prevR &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;capped &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; deltaR&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; g &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; prevG &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;capped &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; deltaG&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; b &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; prevB &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;capped &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; deltaB&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; g&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then we can create a swirling effect by adding a conditional to the &lt;code class=&quot;language-text&quot;&gt;update&lt;/code&gt; method.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Can be called repeatedly in the main loop()&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  unsigned &lt;span class=&quot;token keyword&quot;&gt;long&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;millis&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; elapsed &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; animationStart&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  float progress &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;float&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; elapsed &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; animationLength&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  float capped &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;progress&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; r &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; prevR &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;capped &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; deltaR&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; g &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; prevG &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;capped &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; deltaG&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; b &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; prevB &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;capped &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; deltaB&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; g&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token builtin&quot;&gt;process&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    prevR &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; nextR&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    prevG &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; nextG&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    prevB &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; nextB&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    nextR &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    nextG &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    nextB &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    deltaR &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; nextR &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; prevR&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    deltaG &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; nextG &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; prevG&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    deltaB &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; nextB &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; prevB&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    animationStart &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; now&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This frees up the thread, but created two new problems:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;I change the next color state with a user interaction (pressing a button) which creates a hard transition when starting a new animation during a currently running animation. It’s not a huge problem, so I haven’t dived into fixing this.&lt;/li&gt;
&lt;li&gt;If something &lt;em&gt;else&lt;/em&gt; is blocking the main thread, two seconds can pass and the whole animation is skipped over. This was the case with my buzzer code as it played a little melody when a user interacted with the project. So I needed a way to play the melody in a non-blocking way!&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;Non-blocking melody&lt;/h2&gt;
&lt;p&gt;This was a little more tricky and the melody will have a slightly less precise rhythm. The upside however is that a user can continue to interact with the project while a melody is being played; a bonus feature for fixing the LED transition problem.&lt;/p&gt;
&lt;p&gt;Most examples for working with &lt;code class=&quot;language-text&quot;&gt;tone&lt;/code&gt; go something like this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; tonePin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Gets called on user interaction&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// play 2kHz for 2 seconds&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;tone&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;tonePin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;delay&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// play 4kHz for 1 second&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;tone&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;tonePin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;delay&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token function&quot;&gt;noTone&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;tonePin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;But of course this will block the thread for 3 seconds - a lifetime for a process to run.&lt;/p&gt;
&lt;p&gt;My alternative solution requires a lot of code and definitely needs some refinement, but has been working for my basic needs:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; tonePin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// -1 means we haven&apos;t started the melody&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; currNoteIndex &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// Timestamp when we started the last note&lt;/span&gt;
unsigned &lt;span class=&quot;token keyword&quot;&gt;long&lt;/span&gt; noteStart &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;boolean&lt;/span&gt; playing &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; melodyLength &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// Array of frequencies&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; melody&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4000&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// Array of times (beats)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; rhythm&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Gets called on user interaction&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  playing &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  currNoteIndex &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Gets called repeatedly in the main loop()&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;playing&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  unsigned &lt;span class=&quot;token keyword&quot;&gt;long&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;millis&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
 
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// If we&apos;re just starting the melody...&lt;/span&gt;
    currNoteIndex &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// ... or we&apos;ve been playing the current note too long...&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; noteStart &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; rhythm&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;currNoteIndex&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// ...bump the note index.&lt;/span&gt;
    currNoteIndex&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// If the next note exists, play it...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;currNoteIndex &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; melodyLength&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;tone&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;tonePin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; melody&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;currNoteIndex&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      noteStart &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; now&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// ...otherwise stop playing.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;noTone&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;tonePin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      playing &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So the secret here is that &lt;code class=&quot;language-text&quot;&gt;tone&lt;/code&gt; doesn’t need the thread to run, people just tend to block the thread to keep track of how long we’ve been playing the tone. If we don’t care too much about precision we can start the tone, do other things, and check in regularly to see if we need to stop or change the tone.&lt;/p&gt;
&lt;p&gt;Obviously the code is chaotic and the way I’m managing the arrangement of notes/beats isn’t ideal, but this could all probably be cleaned up. For my own project I made the note/beat arrays pretty big and just rewrote the values when the melody needed to change.&lt;/p&gt;
&lt;p&gt;Unfortunately this created its own issue: since the button-press played a melody and the melody was blocking, the melody acted as a sort of debounce for the button. Now that the melody is non-blocking, the button-press is a little more jittery.&lt;/p&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;So the basic idea is pretty straight-forward, we have a master loop and several “services” (as feature-specific classes) that each have their own loops that run and release the thread as quickly as possible. With this paradigm we can start “multitasking” on a single thread!&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  light&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  sound&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// ...other things...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[Note to Self - Nano Clone on High Sierra]]></title><description><![CDATA[I bought a couple of Arduino Nano clones and had some trouble getting them set up with my computer. Turns out Nano clones often use a…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/nts-nano-clone/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/nts-nano-clone/</guid><pubDate>Wed, 27 May 2020 01:25:23 GMT</pubDate><content:encoded>&lt;p&gt;I bought a couple of Arduino Nano clones and had some trouble getting them set up with my computer. Turns out Nano clones often use a replacement for the FT232 USB-to-serial chip called the CH340. These chips don’t have drivers on OSX High Sierra by default and the drivers provided by the clone manufacturer didn’t work for me.&lt;/p&gt;
&lt;p&gt;I eventually had to download drivers and follow the instructions from this &lt;a href=&quot;https://github.com/adrianmihalko/ch340g-ch34g-ch34x-mac-os-x-driver&quot;&gt;Github&lt;/a&gt; repo. Super sketchy and I probably have a virus now, but at least my Nano clone works.&lt;/p&gt;
&lt;p&gt;Switching from an Uno to a Nano I had to update my &lt;code class=&quot;language-text&quot;&gt;platformio.ini&lt;/code&gt; config:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ini&quot;&gt;&lt;pre class=&quot;language-ini&quot;&gt;&lt;code class=&quot;language-ini&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;; before&lt;/span&gt;
&lt;span class=&quot;token section&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token section-name selector&quot;&gt;env:uno&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token key attr-name&quot;&gt;platform&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token value attr-value&quot;&gt;atmelavr&lt;/span&gt;
&lt;span class=&quot;token key attr-name&quot;&gt;board&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token value attr-value&quot;&gt;uno&lt;/span&gt;
&lt;span class=&quot;token key attr-name&quot;&gt;framework&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token value attr-value&quot;&gt;arduino&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;; after&lt;/span&gt;
&lt;span class=&quot;token section&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token section-name selector&quot;&gt;env:nanoatmega328new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token key attr-name&quot;&gt;platform&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token value attr-value&quot;&gt;atmelavr&lt;/span&gt;
&lt;span class=&quot;token key attr-name&quot;&gt;board&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token value attr-value&quot;&gt;nanoatmega328new&lt;/span&gt;
&lt;span class=&quot;token key attr-name&quot;&gt;framework&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token value attr-value&quot;&gt;arduino&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;There were some people who said to use the old bootloader, but that didn’t work for me. Anyway, wanted to save this for future me. Keep fighting the good fight future me!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Grandbot Update - Light]]></title><description><![CDATA[Disclaimer: I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I think I learned…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/grandbot-update-light/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/grandbot-update-light/</guid><pubDate>Fri, 15 May 2020 03:25:23 GMT</pubDate><content:encoded>&lt;p&gt;&lt;em&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I &lt;strong&gt;think&lt;/strong&gt; I learned, but that doesn’t make it the truth.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Project originally inspired by the work of &lt;a href=&quot;https://twitter.com/MohitBhoite&quot;&gt;Mohit Bhoite&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Code references the state as of &lt;a href=&quot;https://github.com/handeyeco/Grandbot/tree/2020-05-15&quot;&gt;this tag&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;The past week has been a big one for the newly named Grandbot project. I finally got to a place where I felt it was time to take a deep dive into C++ and implemented a bunch of new features while learning more about electronics and Arduino programming. Even though the hardware side of things is fairly straightforward, I’m breaking this post into several parts since the code is exponentially more complex now.&lt;/p&gt;
&lt;p&gt;I added an RGB LED to let Grandbot emote via light. Red means he’s unhappy, otherwise he generates random colors.&lt;/p&gt;
&lt;h2&gt;Adding an RGB LED&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/b095b8d4a63caf2817d402c6e26d02d2/44af6/schematic.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 60.13513513513513%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAMCBf/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB68bTywF//8QAGBABAQADAAAAAAAAAAAAAAAAAAEREkH/2gAIAQEAAQUCdVrMv//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABYQAAMAAAAAAAAAAAAAAAAAAAAgQf/aAAgBAQAGPwIq/wD/xAAcEAACAgIDAAAAAAAAAAAAAAAAAREhEDFxkcH/2gAIAQEAAT8hb5HKr2QnNiTsdn3H/9oADAMBAAIAAwAAABDML//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAQEBAQADAAAAAAAAAAAAAAERIQBBcaH/2gAIAQEAAT8QZCBR8A3q9SipX7c6fCeycAIvMwcHKm84oGHf/9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Schematic of the build&quot;
        title=&quot;Schematic of the build&quot;
        src=&quot;/tech-blog/static/b095b8d4a63caf2817d402c6e26d02d2/1c72d/schematic.jpg&quot;
        srcset=&quot;/tech-blog/static/b095b8d4a63caf2817d402c6e26d02d2/a80bd/schematic.jpg 148w,
/tech-blog/static/b095b8d4a63caf2817d402c6e26d02d2/1c91a/schematic.jpg 295w,
/tech-blog/static/b095b8d4a63caf2817d402c6e26d02d2/1c72d/schematic.jpg 590w,
/tech-blog/static/b095b8d4a63caf2817d402c6e26d02d2/a8a14/schematic.jpg 885w,
/tech-blog/static/b095b8d4a63caf2817d402c6e26d02d2/fbd2c/schematic.jpg 1180w,
/tech-blog/static/b095b8d4a63caf2817d402c6e26d02d2/44af6/schematic.jpg 2110w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;figcaption&gt;Schematic of the build&lt;/figcaption&gt;
&lt;h3&gt;Components&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Common cathode RGB LED&lt;/li&gt;
&lt;li&gt;3x 220 Ohm resistors&lt;/li&gt;
&lt;li&gt;Arduino Uno&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Component notes&lt;/h4&gt;
&lt;p&gt;An RGB LED is really just three LEDs in one container with a shared cathode. So just like with a regular LEDs, we need current-limiting resistors that will depend on your specific LED. In my case I used 220 Ohm resistors, but you should look into what your LED needs.&lt;/p&gt;
&lt;h3&gt;Code&lt;/h3&gt;
&lt;p&gt;This is just the general idea, not the complete code. There’s a link above to the full codebase.&lt;/p&gt;
&lt;p&gt;We pass the pins for the different colors to the Grandbot constructor and the constructor initializes an instance of the Light class. Whenever Grandbot updates the expression, he updates the light.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// main.cpp&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Needs PWM pins&lt;/span&gt;
&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;token macro-name&quot;&gt;redPin&lt;/span&gt; &lt;span class=&quot;token expression&quot;&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;token macro-name&quot;&gt;greenPin&lt;/span&gt; &lt;span class=&quot;token expression&quot;&gt;&lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;token macro-name&quot;&gt;bluePin&lt;/span&gt; &lt;span class=&quot;token expression&quot;&gt;&lt;span class=&quot;token number&quot;&gt;9&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// ...set other pins...&lt;/span&gt;

Grandbot gb &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;dataPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; clockPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; loadPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; voicePin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; redPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; greenPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; bluePin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Grandbot.cpp&lt;/span&gt;

&lt;span class=&quot;token class-name&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; dataPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; clockPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; loadPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; voicePin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; redPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; greenPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; bluePin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;lc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;LedControl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;dataPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; clockPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; loadPin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;voice&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Voice&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;voicePin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;redPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; greenPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; bluePin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// ...initializing stuff...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setExpression&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  expression &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Expressions&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getExpression&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mood&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;writeExpression&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  light&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mood&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The Light class is pretty basic right now:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Light.h&lt;/span&gt;

class &lt;span class=&quot;token class-name&quot;&gt;Light&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  private&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Keeps track of the LED pins&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; red&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; green&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; blue&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; rValue&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; gValue&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; bValue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  public&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;Light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; redPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; greenPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; bluePin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; mood&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Light.cpp&lt;/span&gt;

&lt;span class=&quot;token class-name&quot;&gt;Light&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; redPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; greenPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; bluePin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  red &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; redPin&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  green &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; greenPin&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  blue &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; bluePin&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Constructor sets the pins as outputs&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;pinMode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;red&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;OUTPUT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;pinMode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;green&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;OUTPUT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;pinMode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;blue&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;OUTPUT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Light&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; rValue&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; gValue&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; bValue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// Use analog write (PWM)&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// so we don&apos;t just have HIGH and LOW values&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;analogWrite&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;red&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; rValue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;analogWrite&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;green&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; gValue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;analogWrite&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;blue&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; bValue&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Light&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; mood&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; r &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; g &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; b &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;256&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mood&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Off when sleeping&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// (another reason to boot into sleep mode)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Random blue-ish when happy&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; g&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Random color when neutral&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;r&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; g&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Pure red when unhappy&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;write&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;255&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;Code notes&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;It’s probably the most basic of the new features.&lt;/li&gt;
&lt;li&gt;Just like Voice, we use a switch based of the current &lt;code class=&quot;language-text&quot;&gt;mood&lt;/code&gt; (stored as an int) to make color selections.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;I would like to do more with this feature. The main improvement I’d like in this department is to add a transition - which would require keeping track of current state and future state, transitioning between the two with some sort of &lt;code class=&quot;language-text&quot;&gt;void transition()&lt;/code&gt; function that can be called continuously in Grandbot’s &lt;code class=&quot;language-text&quot;&gt;update&lt;/code&gt; method.&lt;/p&gt;
&lt;p&gt;I would also like to have a more specific color palette. For instance I’d like to be able to pick a magenta-ish color. Right now the randomness usually results in green-ish and blue-ish colors.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Grandbot: Play]]></title><description><![CDATA[Disclaimer: I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I think I learned…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/grandbot-update-play/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/grandbot-update-play/</guid><pubDate>Fri, 15 May 2020 02:25:23 GMT</pubDate><content:encoded>&lt;p&gt;&lt;em&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I &lt;strong&gt;think&lt;/strong&gt; I learned, but that doesn’t make it the truth.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Project originally inspired by the work of &lt;a href=&quot;https://twitter.com/MohitBhoite&quot;&gt;Mohit Bhoite&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Code references the state as of &lt;a href=&quot;https://github.com/handeyeco/Grandbot/tree/2020-05-15&quot;&gt;this tag&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;The past week has been a big one for the newly named Grandbot project. I finally got to a place where I felt it was time to take a deep dive into C++ and implemented a bunch of new features while learning more about electronics and Arduino programming. Even though the hardware side of things is fairly straightforward, I’m breaking this post into several parts since the code is exponentially more complex now.&lt;/p&gt;
&lt;p&gt;As I mentioned in the last two posts, Grandbot now has “moods” that affect his sounds, expressions, and lights. So how is a mood set? By playing with him of course! Right now the only way to interact with him is with a push button, but hopefully in the future he’ll be more interactive.&lt;/p&gt;
&lt;h2&gt;Adding a button&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/3dd729ae92ad38af6b9fbd4ae2b2a157/6951b/schematic.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 52.02702702702703%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAgABBf/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB6wZzchH/xAAYEAACAwAAAAAAAAAAAAAAAAAAARAxQf/aAAgBAQABBQIdqNP/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAXEAADAQAAAAAAAAAAAAAAAAAAESAx/9oACAEBAAY/AtFP/8QAGxAAAgIDAQAAAAAAAAAAAAAAAREAMRAhQWH/2gAIAQEAAT8hRd4RCia8jLZncv/aAAwDAQACAAMAAAAQi+//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAdEAEAAgICAwAAAAAAAAAAAAABABEhMUFRYXGR/9oACAEBAAE/EAGqDxRiBE7t235i2F9IY+Rl2nL7n//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Schematic of the build&quot;
        title=&quot;Schematic of the build&quot;
        src=&quot;/tech-blog/static/3dd729ae92ad38af6b9fbd4ae2b2a157/1c72d/schematic.jpg&quot;
        srcset=&quot;/tech-blog/static/3dd729ae92ad38af6b9fbd4ae2b2a157/a80bd/schematic.jpg 148w,
/tech-blog/static/3dd729ae92ad38af6b9fbd4ae2b2a157/1c91a/schematic.jpg 295w,
/tech-blog/static/3dd729ae92ad38af6b9fbd4ae2b2a157/1c72d/schematic.jpg 590w,
/tech-blog/static/3dd729ae92ad38af6b9fbd4ae2b2a157/a8a14/schematic.jpg 885w,
/tech-blog/static/3dd729ae92ad38af6b9fbd4ae2b2a157/fbd2c/schematic.jpg 1180w,
/tech-blog/static/3dd729ae92ad38af6b9fbd4ae2b2a157/6951b/schematic.jpg 1950w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;figcaption&gt;Schematic of the build&lt;/figcaption&gt;
&lt;h3&gt;Components&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Push button&lt;/li&gt;
&lt;li&gt;10k Ohm resistor&lt;/li&gt;
&lt;li&gt;Arduino Uno&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Component notes&lt;/h4&gt;
&lt;p&gt;There’s not much to this one. As far as I understand it, the resistor is a pull-down resistor to prevent the pin from floating when the button is not pressed.&lt;/p&gt;
&lt;h3&gt;Code&lt;/h3&gt;
&lt;p&gt;The code is pretty rough right now, but hopefully the idea is there. I’m not going to show everything, just the button-related stuff.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// main.cpp&lt;/span&gt;

&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;token macro-name&quot;&gt;playPin&lt;/span&gt; &lt;span class=&quot;token expression&quot;&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// ...set other pins...&lt;/span&gt;

Grandbot gb &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;dataPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; clockPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; loadPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; voicePin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; redPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; greenPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; bluePin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Used to track the transition&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// between on and off&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; lastPlayState &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;setup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;pinMode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;playPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;INPUT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// Get current state of button&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; playing &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;digitalRead&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;playPin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Do different things if button state changed&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;playing &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; lastPlayState &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    gb&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    lastPlayState &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;lastPlayState&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;playing &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; lastPlayState &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    lastPlayState &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;lastPlayState&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As I mentioned a previous post, Grandbot’s &lt;code class=&quot;language-text&quot;&gt;esteem&lt;/code&gt; is based on how often he’s played with, his &lt;code class=&quot;language-text&quot;&gt;mood&lt;/code&gt; is based off his &lt;code class=&quot;language-text&quot;&gt;esteem&lt;/code&gt;, and everything else is based on his &lt;code class=&quot;language-text&quot;&gt;mood&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Grandbot.cpp&lt;/span&gt;

class &lt;span class=&quot;token class-name&quot;&gt;Grandbot&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    private&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// -1 = uninitialized&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;//  0 = sleeping&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;//  1 = happy&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;//  2 = neutral&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;//  3 = unhappy&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; mood &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// between 0 (unhappiest) and 9 (happiest)&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; esteem &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;updateEsteem&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;updateMood&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        unsigned &lt;span class=&quot;token keyword&quot;&gt;long&lt;/span&gt; lastPlayTime &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    public&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We want to encourage regular interactions throughout the day, rather than just playing a bunch all at once. So we only bump &lt;code class=&quot;language-text&quot;&gt;esteem&lt;/code&gt; once for every hour of play (3,600,00ms).&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Grandbot.cpp&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  unsigned &lt;span class=&quot;token keyword&quot;&gt;long&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;millis&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  unsigned &lt;span class=&quot;token keyword&quot;&gt;long&lt;/span&gt; thresh &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; lastPlayTime &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3600000LL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// If last play was at least an hour ago,&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// bump esteem&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;now &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; thresh&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    lastPlayTime &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; now&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Max esteem is 9&lt;/span&gt;
    esteem &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; esteem &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token function&quot;&gt;updateMood&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  voice&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;emote&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mood&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;updateMood&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; last &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; mood&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; next&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;esteem &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    next &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;esteem &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    next &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    next &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  mood &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; next&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token function&quot;&gt;setExpression&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;last &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; next&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Known bug, double emote&lt;/span&gt;
    voice&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;emote&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mood&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;That’s the code to make him happier. The code to make him sadder (from being ignored):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Grandbot.cpp&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Gets called every loop in main.cpp&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  unsigned &lt;span class=&quot;token keyword&quot;&gt;long&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;millis&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// ...sleep related stuff...&lt;/span&gt;
  
  &lt;span class=&quot;token comment&quot;&gt;// If he&apos;s not sleeping or initializing&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mood &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;now &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; nextExpressionChange&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;updateEsteem&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;setExpression&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      nextExpressionChange &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getNextExpressionChange&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// ...blinking related stuff...&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// ...more sleep related stuff...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;updateEsteem&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  unsigned &lt;span class=&quot;token keyword&quot;&gt;long&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;millis&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  unsigned &lt;span class=&quot;token keyword&quot;&gt;long&lt;/span&gt; thresh &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; lastPlayTime &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;21600000LL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// If he hasn&apos;t been played with in the last 6 hours&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;now &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; thresh&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Need to update this&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// or he&apos;ll quickly go from 9 to 0&lt;/span&gt;
    lastPlayTime &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; now&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// Minimum esteem is 0&lt;/span&gt;
    esteem &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; esteem &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;updateMood&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So if you play with him once an hour, his esteem will go up by 1 to a max of 9. If you ignore him for six hours, his esteem will go down by 1 to a min of 0. These values need to be stored somewhere else so they’re easy to change.&lt;/p&gt;
&lt;p&gt;The bug I ran into was that he kept waking up unhappy. I intentionally skipped updating esteem while he was sleeping, but as soon as he woke up &lt;code class=&quot;language-text&quot;&gt;lastPlayTime&lt;/code&gt; was greater than 6 hours ago. So when he wakes up:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;wakeup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// So he doesn&apos;t wake up angry&lt;/span&gt;
  lastPlayTime &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;millis&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// ...wakeup stuff...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It’s not a perfect solution, but it works well enough for me.&lt;/p&gt;
&lt;h4&gt;Code notes&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;The code really needs refactoring. Even though it works as I would hope, it’s a little hard to follow and uses some “magic numbers.”&lt;/li&gt;
&lt;li&gt;There’s a known bug where if you play with Grandbot and he changes moods, he’ll emote twice. Not the worst thing in the world.&lt;/li&gt;
&lt;li&gt;Trying to find the right balance for threshold times is an art not yet mastered. I think six hours is too long, so I’ll probably lower that and tweak the esteem-to-mood numbers.&lt;/li&gt;
&lt;li&gt;I only update esteem when updating expressions (&lt;code class=&quot;language-text&quot;&gt;nextExpressionChange&lt;/code&gt;) because the timing isn’t that important and I don’t want to run it every loop. It’s placing is a little confusing, so I may make a new variable like &lt;code class=&quot;language-text&quot;&gt;nextEsteemUpdate&lt;/code&gt; or rename &lt;code class=&quot;language-text&quot;&gt;nextExpressionChange&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;I’d like to add more interaction that contributes to his mood. Sensing movement, reacting to date/time, and maybe even making mini-games to play with people. For now though, this is a good start on giving Grandbot his own identity. More and more he’s controlling his own feelings and I’m just trying to keep up!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Grandbot: Voice]]></title><description><![CDATA[Disclaimer: I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I think I learned…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/grandbot-update-voice/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/grandbot-update-voice/</guid><pubDate>Fri, 15 May 2020 01:25:23 GMT</pubDate><content:encoded>&lt;p&gt;&lt;em&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I &lt;strong&gt;think&lt;/strong&gt; I learned, but that doesn’t make it the truth.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Project originally inspired by the work of &lt;a href=&quot;https://twitter.com/MohitBhoite&quot;&gt;Mohit Bhoite&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Code references the state as of &lt;a href=&quot;https://github.com/handeyeco/Grandbot/tree/2020-05-15&quot;&gt;this tag&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;The past week has been a big one for the newly named Grandbot project. I finally got to a place where I felt it was time to take a deep dive into C++ and implemented a bunch of new features while learning more about electronics and Arduino programming. Even though the hardware side of things is fairly straightforward, I’m breaking this post into several parts since the code is exponentially more complex now.&lt;/p&gt;
&lt;p&gt;This post is about using a passive buzzer to let Grandbot sing randomly generated melodies.&lt;/p&gt;
&lt;h2&gt;Adding a buzzer&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/ed9ed32c3a0583776b3f7c48032eae34/c8451/schematic.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 47.2972972972973%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECAwX/xAAWAQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAdSDM1lQf//EABgQAQADAQAAAAAAAAAAAAAAAAEAEBEh/9oACAEBAAEFAuzVdtn/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAXEAADAQAAAAAAAAAAAAAAAAAAIDFR/9oACAEBAAY/AqYv/8QAGxAAAgIDAQAAAAAAAAAAAAAAABEBMUFRYZH/2gAIAQEAAT8hejwStpw6lk4Jssf/2gAMAwEAAgADAAAAEOsv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBABAAICAwEAAAAAAAAAAAAAAQARITFRYXHh/9oACAEBAAE/EGwShdP1BTkHo+5ljALkKmkaZvn/2Q==&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Schematic of the build&quot;
        title=&quot;Schematic of the build&quot;
        src=&quot;/tech-blog/static/ed9ed32c3a0583776b3f7c48032eae34/1c72d/schematic.jpg&quot;
        srcset=&quot;/tech-blog/static/ed9ed32c3a0583776b3f7c48032eae34/a80bd/schematic.jpg 148w,
/tech-blog/static/ed9ed32c3a0583776b3f7c48032eae34/1c91a/schematic.jpg 295w,
/tech-blog/static/ed9ed32c3a0583776b3f7c48032eae34/1c72d/schematic.jpg 590w,
/tech-blog/static/ed9ed32c3a0583776b3f7c48032eae34/a8a14/schematic.jpg 885w,
/tech-blog/static/ed9ed32c3a0583776b3f7c48032eae34/fbd2c/schematic.jpg 1180w,
/tech-blog/static/ed9ed32c3a0583776b3f7c48032eae34/c8451/schematic.jpg 1974w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;figcaption&gt;Schematic of the build&lt;/figcaption&gt;
&lt;h3&gt;Components&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Passive buzzer&lt;/li&gt;
&lt;li&gt;220 Ohm resistor&lt;/li&gt;
&lt;li&gt;Arduino Uno&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Component notes&lt;/h4&gt;
&lt;p&gt;I’m using a passive buzzer that came with a kit, but I can’t find any part number for it. The datasheet says it’s capable of handling 3-12V and its resistance is “16R” (16 Ohms?)&lt;/p&gt;
&lt;p&gt;From this thread &lt;a href=&quot;https://forum.arduino.cc/index.php?topic=16262.0&quot;&gt;this thread&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;According to the buzzer documentation, the ‘coil resistance’ is 42R +- (plus or minus) 6.3&lt;/p&gt;
&lt;p&gt;ohms law: voltage = current * resistance&lt;/p&gt;
&lt;p&gt;Other turn-arounds of this formula:&lt;/p&gt;
&lt;p&gt;resistance = voltage / current&lt;/p&gt;
&lt;p&gt;current = voltage / resistance (we’re using this one)&lt;/p&gt;
&lt;p&gt;Arduino voltage is 5 volts from USB (correct? does this change with plug up to 12v?)&lt;/p&gt;
&lt;p&gt;5 volts / 42R = .119A, or 119mA: That’s 79mA too much current.&lt;/p&gt;
&lt;p&gt;To fix:&lt;/p&gt;
&lt;p&gt;100R resistor + 42R buzzer = 142R&lt;/p&gt;
&lt;p&gt;5v / 142R = .0352Am, or 35.2mA: That’s less than the 40mA of the Arduino AVR: Success!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So for me &lt;code class=&quot;language-text&quot;&gt;5V / 16R = .312A&lt;/code&gt;. 312mA &gt; 40mA, so I need to limit the current. I added 220 Ohms: &lt;code class=&quot;language-text&quot;&gt;5V / (16R + 220) = .021A&lt;/code&gt;. 21mA &amp;#x3C; 40mA, so we’re good to go! I could have used less resistance, but I’m fine with the buzzer being a little quieter.&lt;/p&gt;
&lt;h3&gt;Code&lt;/h3&gt;
&lt;p&gt;This is just the general idea, not the complete code. There’s a link above to the full codebase.&lt;/p&gt;
&lt;p&gt;The code uses an array of pitches and the Tone library to create little melodies based on Grandbot’s mood. I want to improve the different mood sounds, but right now he plays the same two low frequencies when unhappy, a random note when in a neutral mood, a series of random notes when happy, and a random Major 7th chord when going to sleep.&lt;/p&gt;
&lt;p&gt;It’s all pretty straightforward, the only tricky part was getting true randomness. Arduino’s &lt;code class=&quot;language-text&quot;&gt;random&lt;/code&gt; function is a pseudorandom number generator, so Grandbot kept playing the same tunes. The solution was to use a floating analog pin as a seed.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// main.cpp&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Pin connected to buzzer&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// (needs to be a PWM pin)&lt;/span&gt;
&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;token macro-name&quot;&gt;voicePin&lt;/span&gt; &lt;span class=&quot;token expression&quot;&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Leave unconnected&lt;/span&gt;
&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;token macro-name&quot;&gt;randomPin&lt;/span&gt; &lt;span class=&quot;token expression&quot;&gt;A5&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// ...set other pins...&lt;/span&gt;

Grandbot gb &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;dataPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; clockPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; loadPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; voicePin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; redPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; greenPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; bluePin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;setup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;randomSeed&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;analogRead&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;randomPin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then we have a &lt;code class=&quot;language-text&quot;&gt;Voice&lt;/code&gt; class:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Voice.h&lt;/span&gt;

class &lt;span class=&quot;token class-name&quot;&gt;Voice&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  private&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; m_voicePin&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    static const &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; pitches&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;playMajor7th&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;playRandomSequence&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;playRandomNote&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; note&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; note&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; duration&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  public&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;Voice&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; voicePin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;feedback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;emote&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; mood&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This has some helper functions for using Tone:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Voice.cpp&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Voice&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; note&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;note&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;75&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Voice&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; note&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; duration&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;tone&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m_voicePin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; note&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;delay&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;duration&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;noTone&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;m_voicePin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;An array of pitches:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Voice.cpp&lt;/span&gt;

const &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; Voice&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;pitches&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; 
  &lt;span class=&quot;token number&quot;&gt;1047&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
  &lt;span class=&quot;token number&quot;&gt;1109&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
  &lt;span class=&quot;token number&quot;&gt;1175&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ...etc...&lt;/span&gt;
  &lt;span class=&quot;token number&quot;&gt;4435&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
  &lt;span class=&quot;token number&quot;&gt;4699&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; 
  &lt;span class=&quot;token number&quot;&gt;4978&lt;/span&gt; 
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Some internal sound making fun:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Voice.cpp&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Voice&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;playMajor7th&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; duration &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;250&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Pick the chord&apos;s starting note&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; start &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Step through the Major 7th intervals&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pitches&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;start&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; duration&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pitches&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;start&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; duration&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pitches&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;start&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; duration&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pitches&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;start&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; duration&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Voice&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;playRandomSequence&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; len &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;random&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; len&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;playRandomNote&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Voice&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;playRandomNote&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; rand &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; note &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Voice&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;pitches&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;rand&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;note&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I’ve since found a better way to get a random entry from an array in C++ (by first determining array length), but this has been working for now.&lt;/p&gt;
&lt;p&gt;Last in this file are two public methods:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Voice.cpp&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Chirp when we want feedback&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// (not currently in use)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Voice&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;feedback&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;playRandomNote&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Play a melody based on mood (stored as an int)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Voice&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;emote&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; mood&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;switch&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mood&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Sleeping&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;playMajor7th&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Happy&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;playRandomSequence&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Neutral&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;playRandomNote&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Unhappy&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Grandbot stores an instance of Voice and calls it from time-to-time.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token class-name&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; dataPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; clockPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; loadPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; voicePin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; redPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; greenPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; bluePin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;lc&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;LedControl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;dataPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; clockPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; loadPin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;voice&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Voice&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;voicePin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Light&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;redPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; greenPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; bluePin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Initializing stuff&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;updateMood&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; last &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; mood&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; next&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// ...determine next mood...&lt;/span&gt;

  mood &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; next&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;last &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; next&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    voice&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;emote&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mood&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ...sleep stuff...&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// So we don&apos;t play a sound&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// if we reset at night&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;lastMood &lt;span class=&quot;token operator&quot;&gt;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    voice&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;emote&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mood&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// ...playful stuff...&lt;/span&gt;

  &lt;span class=&quot;token function&quot;&gt;updateMood&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  voice&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;emote&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mood&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;Code notes&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;I should probably have a separate Pitch file.&lt;/li&gt;
&lt;li&gt;Randomly selecting things should be done by determining the array length, rather than using a hard-coded value.&lt;/li&gt;
&lt;li&gt;I’d like to add more functions for specific chords and then auto-generate small chord progressions. I also think this is a good foundation for a game to play with Grandbot (like Simon).&lt;/li&gt;
&lt;li&gt;The instance of Voice created in the Grandbot constructor is made with an initializer list. The compiler threw an error because I didn’t have a default constructor for Voice, so I just initialized it in the initializer list. I’m not sure if there was something else I should have done.&lt;/li&gt;
&lt;li&gt;I’m considering creating the class instances outside of Grandbot and handing them to Grandbot’s constructor rather than creating them in the constructor. The downside is I wouldn’t be able to run to Grandbots on one Arduino that way. 🤷‍♀️&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Really love his random sequences. The Major 7th chord is pretty, but the random sequence makes it seem like he’s trying to communicate. I do want to make the neutral response better though, it’s a little boring right now.&lt;/p&gt;
&lt;p&gt;Another problem is that using &lt;code class=&quot;language-text&quot;&gt;delay&lt;/code&gt; for note length blocks the thread. For instance the sleep melody is 4 notes at 250ms; that means nothing else can happen for the 1 second it’s playing that tune. Not sure if there’s a pay to pass this functionality to an external IC like I did with multiplexing the 4D7S display.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Grandbot: Sleep]]></title><description><![CDATA[Disclaimer: I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I think I learned…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/grandbot-update-sleep/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/grandbot-update-sleep/</guid><pubDate>Fri, 15 May 2020 00:25:23 GMT</pubDate><content:encoded>&lt;p&gt;&lt;em&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I &lt;strong&gt;think&lt;/strong&gt; I learned, but that doesn’t make it the truth.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Project originally inspired by the work of &lt;a href=&quot;https://twitter.com/MohitBhoite&quot;&gt;Mohit Bhoite&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Code references the state as of &lt;a href=&quot;https://github.com/handeyeco/Grandbot/tree/2020-05-15&quot;&gt;this tag&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;The past week has been a big one for the newly named Grandbot project. I finally got to a place where I felt it was time to take a deep dive into C++ and implemented a bunch of new features while learning more about electronics and Arduino programming. Even though the hardware side of things is fairly straightforward, I’m breaking this post into several parts since the code is exponentially more complex now.&lt;/p&gt;
&lt;p&gt;This post is about putting Grandbot to sleep when it gets dark.&lt;/p&gt;
&lt;h2&gt;Adding a photoresistor&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/1332512bf33072f49df30ccd80ee79e7/e018a/schematic.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 59.45945945945946%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB1JMua5MP/8QAGBABAAMBAAAAAAAAAAAAAAAAAQARIRD/2gAIAQEAAQUC2WkGXjz/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAXEAADAQAAAAAAAAAAAAAAAAAAICFB/9oACAEBAAY/AsKv/8QAGxABAAICAwAAAAAAAAAAAAAAAQARITFBUXH/2gAIAQEAAT8huW+zOs4jpaj4S0cHqKz/2gAMAwEAAgADAAAAELjv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAHBABAAMAAgMAAAAAAAAAAAAAAQARIUFRMWGh/9oACAEBAAE/EBxsBxrF6KnCqVXR7jfXYoH2PIiW9btW9y15n//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Schematic of the build&quot;
        title=&quot;Schematic of the build&quot;
        src=&quot;/tech-blog/static/1332512bf33072f49df30ccd80ee79e7/1c72d/schematic.jpg&quot;
        srcset=&quot;/tech-blog/static/1332512bf33072f49df30ccd80ee79e7/a80bd/schematic.jpg 148w,
/tech-blog/static/1332512bf33072f49df30ccd80ee79e7/1c91a/schematic.jpg 295w,
/tech-blog/static/1332512bf33072f49df30ccd80ee79e7/1c72d/schematic.jpg 590w,
/tech-blog/static/1332512bf33072f49df30ccd80ee79e7/a8a14/schematic.jpg 885w,
/tech-blog/static/1332512bf33072f49df30ccd80ee79e7/fbd2c/schematic.jpg 1180w,
/tech-blog/static/1332512bf33072f49df30ccd80ee79e7/e018a/schematic.jpg 1876w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;figcaption&gt;Schematic of the build&lt;/figcaption&gt;
&lt;h3&gt;Components&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Photoresistor (I used an LXD5537; dark 20M Ohm, light 18-50k Ohm)&lt;/li&gt;
&lt;li&gt;10k Ohm resistor&lt;/li&gt;
&lt;li&gt;Arduino Uno&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Component notes&lt;/h4&gt;
&lt;p&gt;For reading different values (rather than just &lt;code class=&quot;language-text&quot;&gt;HIGH&lt;/code&gt;/&lt;code class=&quot;language-text&quot;&gt;LOW&lt;/code&gt;), we have to use an analog input on the Arduino.&lt;/p&gt;
&lt;p&gt;The resistor is a pull down resistor. I chose 10k Ohm according to &lt;a href=&quot;https://learn.adafruit.com/photocells/using-a-photocell&quot;&gt;this guide&lt;/a&gt; because I’m more concerned with darker values. From that page:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If you’re planning to have the sensor in a bright area and use a 10KΩ pulldown, it will quickly saturate. That means that it will hit the ‘ceiling’ of 5V and not be able to differentiate between kinda bright and really bright. In that case, you should replace the 10KΩ pulldown with a 1KΩ pulldown. In that case, it will not be able to detect dark level differences as well but it will be able to detect bright light differences better. This is a tradeoff that you will have to decide upon&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://forum.arduino.cc/index.php?topic=18241.0&quot;&gt;This page&lt;/a&gt; was also a helpful resource. From it:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The analogue input is high impedance that means when you connect it to the +5 and the input virtually no current flows. If there is no current flowing through a resistor then there is no voltage drop across it, and so it always reads high.&lt;/p&gt;
&lt;p&gt;The pull down resistor makes current flow through the photo resistor and so different light levels result in different currents and hence different voltages (ohms law) which the analogue input can measure.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;Code&lt;/h3&gt;
&lt;p&gt;The code is still being refined, but the basic idea is that when we’re below a “sleep threshold” we should go to sleep and when we’re above a “wake threshold” we should wake. It’s important that these two thresholds are different. Initially I used a single threshold and when it reached that reading, slight fluctuations in light caused it to continuously switch between on and off. Keeping the two thresholds far away enough from each other allowed the switch to happen without immediately flapping back and forth.&lt;/p&gt;
&lt;p&gt;The code grew quite a bit, which is why I linked to the full code above. I’m just going to show the general concept.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// main.cpp&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Use the Analog 0 pin&lt;/span&gt;
&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;define&lt;/span&gt; &lt;span class=&quot;token macro-name&quot;&gt;lightPin&lt;/span&gt; &lt;span class=&quot;token expression&quot;&gt;A0&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// ...set other pins...&lt;/span&gt;

Grandbot gb &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;dataPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; clockPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; loadPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; voicePin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; redPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; greenPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; bluePin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; light &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;analogRead&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;lightPin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Pass the light reading to Grandbot&apos;s update method&lt;/span&gt;
  gb&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Grandbot.h&lt;/span&gt;

class &lt;span class=&quot;token class-name&quot;&gt;Grandbot&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    private&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;wakeup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// -1 = uninitialized&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;//  0 = sleeping&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;//  1 = happy&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;//  2 = neutral&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;//  3 = unhappy&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; mood &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;token comment&quot;&gt;// These thresholds need to be different&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;// to prevent flapping between on/off&lt;/span&gt;
        static const &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; wakeThreshold &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        static const &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; sleepThreshold &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    public&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token function&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; dataPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; clockPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; loadPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; voicePin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; redPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; greenPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; bluePin&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Grandbot.cpp&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; light&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;boolean&lt;/span&gt; awake &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; light &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; Grandbot&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;wakeThreshold&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;boolean&lt;/span&gt; asleep &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; light &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; Grandbot&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;sleepThreshold&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// If mood == sleep and light &gt; wakeThresh: wakeup.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mood &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;awake&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;wakeup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  
  &lt;span class=&quot;token comment&quot;&gt;// If mood != sleep or uninitialized...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mood &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// ...and light &amp;lt; sleepThresh: go to sleep.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;asleep&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;// ...do other stuff here...&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  
  &lt;span class=&quot;token comment&quot;&gt;// Otherwise we&apos;re uninitialized,&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// so we start in sleep mode.&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;sleep&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// Dim the 4D7S display&lt;/span&gt;
  lc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setIntensity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Set mood to sleep&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// and update expression&lt;/span&gt;
  mood &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;setExpression&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Grandbot&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;wakeup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// Kickstart blinking&lt;/span&gt;
  nextBlink &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getNextBlink&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  blinkLength &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getBlinkLength&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Brighten 4D7S display&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// and update expression&lt;/span&gt;
  lc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setIntensity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;updateMood&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;Code notes&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;We keep track of state in the &lt;code class=&quot;language-text&quot;&gt;mood&lt;/code&gt; variable. The facial expressions, RGB LED colors, and sounds are all derived from &lt;code class=&quot;language-text&quot;&gt;mood&lt;/code&gt; and mood is mostly derived from &lt;code class=&quot;language-text&quot;&gt;esteem&lt;/code&gt; (not shown here; it’s based on how often Grandbot is played with). The exceptions are two states: &lt;code class=&quot;language-text&quot;&gt;uninitialized&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;sleeping&lt;/code&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;uninitialized&lt;/code&gt; (-1) is set when booting so I can have special behavior on initial loading.&lt;/li&gt;
&lt;li&gt;As you see here, &lt;code class=&quot;language-text&quot;&gt;sleep&lt;/code&gt; (0) is based on light input.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Grandbot wakes up if it’s been asleep and if light input is above the &lt;code class=&quot;language-text&quot;&gt;wakeThreshold&lt;/code&gt;. Waking up starts blinking behavior, turns up the brightness of the display, and updates &lt;code class=&quot;language-text&quot;&gt;mood&lt;/code&gt; (based on esteem). I didn’t show this, but it also updates &lt;code class=&quot;language-text&quot;&gt;lastPlayTime&lt;/code&gt; so it doesn’t wake up unhappy.&lt;/li&gt;
&lt;li&gt;Grandbot goes to sleep if it’s uninitialized or if it’s in a normal mood and the light reading is below the &lt;code class=&quot;language-text&quot;&gt;sleepThreshold&lt;/code&gt;. Sleep dims the 4D7S display and sets a sleep expression. I didn’t show this, but it also plays sleepy music if it’s going to sleep from a normal mood (not when it’s being initialized).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Hopefully this gets the idea across, but the link to the current state of the code is above. It might clear things up, but it’ll probably just make any sane developer sad.&lt;/p&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;It’s really cute to see Grandbot go to sleep! As I’ll write about in other posts, it plays a little tune when going to bed: a random, arpeggiated, Major 7th chord.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Max7219 Emoji]]></title><description><![CDATA[Blinking expression on display Disclaimer: I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/max7219-emoji/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/max7219-emoji/</guid><pubDate>Mon, 04 May 2020 21:25:23 GMT</pubDate><content:encoded>&lt;p&gt;&lt;img src=&quot;/tech-blog/d8b6a3d50c3450c853be0c122beb3950/blinking.gif&quot; alt=&quot;Blinking expression on display&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I &lt;strong&gt;think&lt;/strong&gt; I learned, but that doesn’t make it the truth.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Project originally inspired by the work of &lt;a href=&quot;https://twitter.com/MohitBhoite&quot;&gt;Mohit Bhoite&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;In my last &lt;a href=&quot;https://handeyeco.github.io/tech-blog/seven-segment-emoji/&quot;&gt;post&lt;/a&gt; on 4-digit, 7-segment displays, I realized I would need help multiplexing if I wanted to free up the Arduino to do more complex things (like using sensors and changing expressions). In the end I decided to use the Max7219 display driver and the LedControl Arduino library.&lt;/p&gt;
&lt;p&gt;The Max7219 is a chip specifically designed to control LED matrices. It replaces the shift register, transistor driver circuits, and limiting resistors I used in the last 4D7S build. It also handles multiplexing so the Arduino doesn’t have to. Arduino has a great &lt;a href=&quot;https://playground.arduino.cc/Main/MAX72XXHardware/&quot;&gt;resource on using the Max7219&lt;/a&gt;; I’d recommend starting there if you’re interested in using the Max7219.&lt;/p&gt;
&lt;h2&gt;The Build&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/2d5050061315212f5f38a230af4ea573/0c969/schematic.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 76.35135135135135%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEAQL/xAAVAQEBAAAAAAAAAAAAAAAAAAABAP/aAAwDAQACEAMQAAABu4Rg0CAv/8QAGRAAAwADAAAAAAAAAAAAAAAAAAERAhAS/9oACAEBAAEFAux5UTLqn//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAAMBAQEAAAAAAAAAAAAAAAABESExQf/aAAgBAQABPyFw4joMPR1tYnmik//aAAwDAQACAAMAAAAQ0C//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPxAn/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAECAQE/EFtb/8QAGxABAAIDAQEAAAAAAAAAAAAAAQARITFRQXH/2gAIAQEAAT8QQNjVJNop8eQPW0sGQcicmUKMz//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Schematic of the build&quot;
        title=&quot;Schematic of the build&quot;
        src=&quot;/tech-blog/static/2d5050061315212f5f38a230af4ea573/1c72d/schematic.jpg&quot;
        srcset=&quot;/tech-blog/static/2d5050061315212f5f38a230af4ea573/a80bd/schematic.jpg 148w,
/tech-blog/static/2d5050061315212f5f38a230af4ea573/1c91a/schematic.jpg 295w,
/tech-blog/static/2d5050061315212f5f38a230af4ea573/1c72d/schematic.jpg 590w,
/tech-blog/static/2d5050061315212f5f38a230af4ea573/a8a14/schematic.jpg 885w,
/tech-blog/static/2d5050061315212f5f38a230af4ea573/fbd2c/schematic.jpg 1180w,
/tech-blog/static/2d5050061315212f5f38a230af4ea573/0c969/schematic.jpg 2411w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;figcaption&gt;Schematic of the build&lt;/figcaption&gt;
&lt;h3&gt;Components&lt;/h3&gt;
&lt;p&gt;I believe you could use any common cathode display, but be sure to check the display’s datasheet for forward voltage and DC forward current. Use those two values in the chart in the Max7219 datasheet to get the appropriate value for R1.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Arduino Uno R3&lt;/li&gt;
&lt;li&gt;TDCG1060M common cathode 4-digit, 7-segment (4D7S) display&lt;/li&gt;
&lt;li&gt;Max7219&lt;/li&gt;
&lt;li&gt;10uF electrolytic capacitor (C1)&lt;/li&gt;
&lt;li&gt;0.1uF ceramic capacitor (C2)&lt;/li&gt;
&lt;li&gt;22k ohm resistor (R1)&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Component notes&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Max7219&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;As mentioned above, it’s a chip that’s specifically designed to drive a bunch of LEDs (up to 64 per chip).&lt;/li&gt;
&lt;li&gt;I believe Dout (pin 24) is used to chain several Max7219s together. Wasn’t needed in this case.&lt;/li&gt;
&lt;li&gt;I only used the first four digit pins. With all eight, you’d be able to control two 4D7S displays.&lt;/li&gt;
&lt;li&gt;Both grounds need to be connected.&lt;/li&gt;
&lt;li&gt;Just like the 74HC595, we’re using serial communication with the Load (12), Clock (13), and Din (1) pins. Doesn’t matter which Arduino pins you connect them to as long as you update the code.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The capacitors are required by the Max7219 datasheet. They clean power-supply ripple…though I’m not 100% sure what that means.&lt;/li&gt;
&lt;li&gt;My understanding of the ISET resistor is that it limits the current going out to the LEDs. As mentioned above, the value depends on the 4D7S display being used.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Code&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token macro property&quot;&gt;&lt;span class=&quot;token directive-hash&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;token directive keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;LedControl.h&quot;&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Arduino Pins&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; dataPin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; clockPin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; loadPin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;/* 
 * Initialize the LedControl object
 * it will set the pin directions for us
 * and provide us with controls for the Max7219
 */&lt;/span&gt;
LedControl lc &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;LedControl&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;dataPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; clockPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; loadPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Gives us a future timestamp&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// between 2 and 10 seconds in the future&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getNextBlink&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;millis&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Random blink length between 100 and 300 ms&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getBlinkLength&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// State&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; nextBlink &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getNextBlink&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; blinkLength &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getBlinkLength&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;boolean&lt;/span&gt; isBlinking &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Expressions:&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// 1 byte/digit describing segment data&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; forward&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  B00000000&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  B11011101&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  B01011101&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  B00000000
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; blinking&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  B00000000&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  B10001000&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  B00001000&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  B00000000
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;writeExpression&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; expr&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// For each digit in the display...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// ...send that digit&apos;s segment data&lt;/span&gt;
    lc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setRow&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; i&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; expr&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;setup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;/*
   The MAX72XX is in power-saving mode on startup,
   we have to do a wakeup call
   */&lt;/span&gt;
  lc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;shutdown&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;/* Set the brightness to high */&lt;/span&gt;
  lc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setIntensity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;/* Only scan the first 4 digits */&lt;/span&gt;
  lc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setScanLimit&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;/* Clear the display */&lt;/span&gt;
  lc&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;clearDisplay&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;millis&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  
  &lt;span class=&quot;token comment&quot;&gt;/* 
   * If not blinking, but should be
   * start blink
   */&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;isBlinking &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; nextBlink&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    isBlinking &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;writeExpression&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;blinking&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  
  &lt;span class=&quot;token comment&quot;&gt;/*
   * If blinking, but we passed the blink length
   * end blink and set next blink times
   */&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;isBlinking &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; nextBlink &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; blinkLength&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    isBlinking &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token function&quot;&gt;writeExpression&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;forward&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    nextBlink &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getNextBlink&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    blinkLength &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;getBlinkLength&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;Code notes&lt;/h4&gt;
&lt;p&gt;I used the &lt;a href=&quot;https://github.com/wayoda/LedControl&quot;&gt;LedControl library&lt;/a&gt;. I actually started writing my own code for the Max7219 since I wasn’t using a lot of the features in the LedControl lib, but eventually I realized I had rewritten almost every function provided by that lib. I learned a lot in the process but ultimately decided not to reinvent the wheel.&lt;/p&gt;
&lt;p&gt;Most of the code is initializing the Max7219 and creating helper functions for improved readability. The basic idea is simple:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;- Create a future timestamp to determine when to blink
- Create a random blink length
- When we pass the timestamp, start blinking
- When we pass the timestamp + blink length, stop blinking
- Repeat&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We want to keep track of whether we’re blinking or not so we only send data to the Max7219 when we need to.&lt;/p&gt;
&lt;p&gt;The only other weird part is the expressions. In my last 4D7S post, I talked about using 8 bits (a byte) to represent the state of each LED in a digit (7 segments + the decimal point). Since we have four digits, we use four bytes per expression. So:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; forward&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  B00000000&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// blank&lt;/span&gt;
  B11011101&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// small circle w/ eyebrow (decimal point)&lt;/span&gt;
  B01011101&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// small circle w/ eyebrow (no decimal point)&lt;/span&gt;
  B00000000  &lt;span class=&quot;token comment&quot;&gt;// blank &lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The difference from the last 4D7S post is that the Max7219 expects the decimal point first rather than last:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;B 0 0 0 0 0 0 0 0
 DP A B C D E F G&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then we just iterate over the expression, setting each digit to each byte in order. This is done in &lt;code class=&quot;language-text&quot;&gt;writeExpression&lt;/code&gt; using the LedControl &lt;code class=&quot;language-text&quot;&gt;setRow&lt;/code&gt; function (if you think of the LEDs as being in a matrix, each digit is a row).&lt;/p&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;This was a fun extension to the last project and freed up even more Arduino pins for other things. My next step is to extract some of the expression logic into a class, add more expressions, and add some sort of sensor to determine which expression should show. I also plan to add a buzzer so it can start making cute sounds.&lt;/p&gt;
&lt;p&gt;Unfortunately it wasn’t all good news. For awhile I thought I had a hardware issue (it was actually a software issue before I started using the LedControl lib) and while tracking down the source of the bug I burnt out my original 4D7S display. It’s sad to lose a friend, but it will always be remembered. RIP.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Arduino Audio Alarm]]></title><description><![CDATA[Disclaimer: I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I think I learned…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/audio-sensor/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/audio-sensor/</guid><pubDate>Sat, 18 Apr 2020 20:29:13 GMT</pubDate><content:encoded>&lt;p&gt;&lt;em&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I &lt;strong&gt;think&lt;/strong&gt; I learned, but that doesn’t make it the truth.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;As a former Audio Engineer, I thought it would be fun to play with reading and making sound with Arduino. I bought a couple of sound detection modules and some ultra-loud piezo buzzers, so I thought I would make a simple alarm with them. Reading the sound was simple thanks to the modules, but I wasn’t sure how to power the buzzers to their full 24V potential since Arduino outputs a max of 5V.&lt;/p&gt;
&lt;p&gt;Seems like my options were using a MOSFET or a relay. I had a relay lying around thanks to the Arduino kit I bought, so that’s what I ended up using. Works like a charm, so I thought I would share what I learned!&lt;/p&gt;
&lt;h2&gt;The Build&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/630406e39f09350b81902cbbfe2d7c3e/3b7f2/schematic.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 54.05405405405405%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAIDBP/EABYBAQEBAAAAAAAAAAAAAAAAAAACA//aAAwDAQACEAMQAAAB1vFihnM6/8QAGhAAAgIDAAAAAAAAAAAAAAAAAAECEBESIf/aAAgBAQABBQLIpd2ds//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABsQAAMAAgMAAAAAAAAAAAAAAAABESFRMUFx/9oACAEBAAE/IaWbghybHqR0a8GdP//aAAwDAQACAAMAAAAQVO//xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAwEBPxAZ/8QAFREBAQAAAAAAAAAAAAAAAAAAAQD/2gAIAQIBAT8QSW//xAAbEAEAAwEAAwAAAAAAAAAAAAABABEhYUFxwf/aAAgBAQABPxAWexCVAJQsC7Zxi75BrHlfJabP/9k=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Schematic of the build&quot;
        title=&quot;Schematic of the build&quot;
        src=&quot;/tech-blog/static/630406e39f09350b81902cbbfe2d7c3e/1c72d/schematic.jpg&quot;
        srcset=&quot;/tech-blog/static/630406e39f09350b81902cbbfe2d7c3e/a80bd/schematic.jpg 148w,
/tech-blog/static/630406e39f09350b81902cbbfe2d7c3e/1c91a/schematic.jpg 295w,
/tech-blog/static/630406e39f09350b81902cbbfe2d7c3e/1c72d/schematic.jpg 590w,
/tech-blog/static/630406e39f09350b81902cbbfe2d7c3e/a8a14/schematic.jpg 885w,
/tech-blog/static/630406e39f09350b81902cbbfe2d7c3e/fbd2c/schematic.jpg 1180w,
/tech-blog/static/630406e39f09350b81902cbbfe2d7c3e/3b7f2/schematic.jpg 1987w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;figcaption&gt;Schematic of the build&lt;/figcaption&gt;
&lt;h3&gt;Components&lt;/h3&gt;
&lt;p&gt;Here are the parts I used for this:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Arduino Uno R3&lt;/li&gt;
&lt;li&gt;Sound detection module for Arduino&lt;/li&gt;
&lt;li&gt;SRD-05VDC-SL-C relay&lt;/li&gt;
&lt;li&gt;95db 3-24V piezo buzzer&lt;/li&gt;
&lt;li&gt;2N3904 NPN transistor&lt;/li&gt;
&lt;li&gt;1k ohm resistor&lt;/li&gt;
&lt;li&gt;1N4007 diode&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Component notes&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Split circuit&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I don’t know if this is the best way, but I basically made two separate circuits that each have their own power and their own ground. So in the schematic, the dotted line next to the relay specifies separate circuits.&lt;/li&gt;
&lt;li&gt;I use a 24V DC power input that I found at Goodwill with a standard barrel input. That goes through the piezo and is switched on/off by the relay.&lt;/li&gt;
&lt;li&gt;Everything else is part of the Arduino circuit.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Sound Detection&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I’m sure you could use anything for the sound detection module - it seems like they’re all clones of one another. I used this &lt;a href=&quot;https://www.amazon.com/Comidox-Sensitivity-Microphone-Detection-Arduino/dp/B07J6N734S&quot;&gt;Comidox Sound Detection Module for Arduino&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;It has both analog and digital outputs. Analog gives you a range of values; I didn’t use this. Digital gives you a HIGH or LOW based on a threshold controlled by a built-in trim potentiometer.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Relay&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The relay is used for switching higher voltage circuits (24V for the buzzer) with logic level controls (5V Arduino).&lt;/li&gt;
&lt;li&gt;It’s strongly encouraged to used a kickback diode with relays. When the relay switches, it can send a short, but very powerful, voltage through the circuit. My understanding is the diode protects the circuit from that voltage. This &lt;a href=&quot;https://www.youtube.com/watch?v=5kjtiY9gxGM&quot;&gt;video&lt;/a&gt; was a really great look at why you should use one.&lt;/li&gt;
&lt;li&gt;It was recommended to use a driver circuit for the relay. I tried without it and it sounded like the relay was struggling to switch. The transistor amplifies the current to help with that and the resistor is a current limiting resistor to protect the transistor.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Buzzer&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;This build could be greatly simplified if you’re fine using a 5V buzzer. I wanted it to be really loud though, so I used &lt;a href=&quot;https://www.amazon.com/DIKAVS-3-24V-Enclosed-Electronic-Buzzer/dp/B072HRZXLG&quot;&gt;this buzzer&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;To be as loud as possible I needed the voltage (I think), which means I needed the relay, which means I needed the driver circuit.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Code&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Pin variables&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; relay &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; input &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Variables we need for the logic&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; startBeep &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; beepLength &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;setup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// Set pin direction&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;pinMode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;relay&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;OUTPUT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;pinMode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;INPUT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// If we&apos;re not currently beeping...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;startBeep &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// ...and we detect sound...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; reading &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;digitalRead&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;input&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;reading &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;// ...start beep and remember when we started.&lt;/span&gt;
      startBeep &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;millis&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;digitalWrite&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;relay&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;HIGH&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;delay&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// Otherwise, if we are currently beeping...&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// ...and we&apos;ve been beeping longer than beepLength...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; now &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;millis&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;startBeep &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; beepLength &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; now&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;// ...reset startBeep and stop beep.&lt;/span&gt;
      startBeep &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;digitalWrite&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;relay&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;LOW&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token function&quot;&gt;delay&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;500&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;Code notes&lt;/h4&gt;
&lt;p&gt;The more correct way of doing things would be split &lt;code class=&quot;language-text&quot;&gt;startBeep&lt;/code&gt; into two variables: &lt;code class=&quot;language-text&quot;&gt;startBeep&lt;/code&gt; to track when we started beeping and &lt;code class=&quot;language-text&quot;&gt;isBeeping&lt;/code&gt; to track whether we’re currently beeping. I combined those concepts so that if &lt;code class=&quot;language-text&quot;&gt;startBeep == 0&lt;/code&gt; we are not beeping and if &lt;code class=&quot;language-text&quot;&gt;startBeep &gt; 0&lt;/code&gt; we are beeping, while holding when we started beeping. The &lt;code class=&quot;language-text&quot;&gt;millis&lt;/code&gt; function is built in to Arduino and tracks the milliseconds since the sketch started running.&lt;/p&gt;
&lt;p&gt;The delays are probably too high, but they’re still essential. Without them the piezo doesn’t have time to stop beeping before we start reading the sensor input - creating an infinite beep. At 95db, you do not want an infinite loop.&lt;/p&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Despite being a fairly simple project, it took me a lot of time to understand switching on/off circuits with Arduino. This has been several months in the making as I watched just about every video on MOSFETs and relays. I learned a great deal in the process and hopefully will be well prepared for my next, hopefully less abrasive, audio project.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[4 Digit, 7 Segment Emoji]]></title><description><![CDATA[Disclaimer: I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I think I learned…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/seven-segment-emoji/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/seven-segment-emoji/</guid><pubDate>Mon, 13 Apr 2020 21:25:23 GMT</pubDate><content:encoded>&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/b886b3b169ef8c3a019d28ce6c78f6e3/e1596/skeptical.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAEDBv/EABcBAAMBAAAAAAAAAAAAAAAAAAECAwD/2gAMAwEAAhADEAAAAef0lDRGXQC+YMf/xAAZEAADAAMAAAAAAAAAAAAAAAAAASEREjH/2gAIAQEAAQUCMx9SNYKDcP/EABgRAAIDAAAAAAAAAAAAAAAAAAABEBFB/9oACAEDAQE/AUmUZH//xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAECAQE/AR//xAAXEAADAQAAAAAAAAAAAAAAAAAAEBEh/9oACAEBAAY/AiOrH//EABsQAQACAwEBAAAAAAAAAAAAAAEAMRARIUFR/9oACAEBAAE/IZ2FRGUORGjc4+GN9FIxPTeP/9oADAMBAAIAAwAAABCUGEH/xAAXEQADAQAAAAAAAAAAAAAAAAABECER/9oACAEDAQE/EMUQyV//xAAXEQEBAQEAAAAAAAAAAAAAAAABABAR/9oACAECAQE/EHkRn//EABkQAQEBAQEBAAAAAAAAAAAAAAERADEhQf/aAAgBAQABPxA7rGFF877kJY+BamRlE4GYENKC8ue+lyVQfRmaBYEguC9Xf//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Skeptical emoji on 4-digit, 7-segment display&quot;
        title=&quot;Skeptical emoji on 4-digit, 7-segment display&quot;
        src=&quot;/tech-blog/static/b886b3b169ef8c3a019d28ce6c78f6e3/1c72d/skeptical.jpg&quot;
        srcset=&quot;/tech-blog/static/b886b3b169ef8c3a019d28ce6c78f6e3/a80bd/skeptical.jpg 148w,
/tech-blog/static/b886b3b169ef8c3a019d28ce6c78f6e3/1c91a/skeptical.jpg 295w,
/tech-blog/static/b886b3b169ef8c3a019d28ce6c78f6e3/1c72d/skeptical.jpg 590w,
/tech-blog/static/b886b3b169ef8c3a019d28ce6c78f6e3/a8a14/skeptical.jpg 885w,
/tech-blog/static/b886b3b169ef8c3a019d28ce6c78f6e3/fbd2c/skeptical.jpg 1180w,
/tech-blog/static/b886b3b169ef8c3a019d28ce6c78f6e3/e1596/skeptical.jpg 2048w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; I don’t know what I’m talking about. I’m a JavaScript dev who’s just learning this stuff too. I’m sharing what I &lt;strong&gt;think&lt;/strong&gt; I learned, but that doesn’t make it the truth.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;While at Eyeo Festival in 2019, I had the chance to hear &lt;a href=&quot;https://twitter.com/MohitBhoite&quot;&gt;Mohit Bhoite&lt;/a&gt; &lt;a href=&quot;https://vimeo.com/354276626&quot;&gt;talk&lt;/a&gt; about the beautiful freeform, electronic sculptures he creates. With just a few commonly found components and a microcontroller, he’s able to craft whimsical and charming creations that really resonated with me. The project that spoke to me the most was his &lt;a href=&quot;https://twitter.com/MohitBhoite/status/1241752124087660546&quot;&gt;Chintoo&lt;/a&gt; project, and I started to think “hey, I could make that! How hard could 4-digit, 7-segment displays be?”&lt;/p&gt;
&lt;p&gt;Apparently they’re pretty tricky. While this isn’t meant to explain 4-digit, 7-segment displays (that’s been covered extensively), hopefully this will augment existing resources that gloss over some things that tripped me up. I’m going to show off what I built and talk a little about what I learned afterwards.&lt;/p&gt;
&lt;h2&gt;The Build&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/tech-blog/static/2171b96c8cbbedde1c677facae80003a/e1596/schematic.jpg&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAEEAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHouNmpOH//xAAYEAEAAwEAAAAAAAAAAAAAAAAAARESAv/aAAgBAQABBQK1plHTTT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAEBAQADAAAAAAAAAAAAAAABACEQQWH/2gAIAQEAAT8hH1Pq04VTq//aAAwDAQACAAMAAAAQYw//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAgIDAAAAAAAAAAAAAAABABEhQTFxgf/aAAgBAQABPxC9k1VncvBVSm4QwV9jpcQprmEZT//Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Schematic of the build&quot;
        title=&quot;Schematic of the build&quot;
        src=&quot;/tech-blog/static/2171b96c8cbbedde1c677facae80003a/1c72d/schematic.jpg&quot;
        srcset=&quot;/tech-blog/static/2171b96c8cbbedde1c677facae80003a/a80bd/schematic.jpg 148w,
/tech-blog/static/2171b96c8cbbedde1c677facae80003a/1c91a/schematic.jpg 295w,
/tech-blog/static/2171b96c8cbbedde1c677facae80003a/1c72d/schematic.jpg 590w,
/tech-blog/static/2171b96c8cbbedde1c677facae80003a/a8a14/schematic.jpg 885w,
/tech-blog/static/2171b96c8cbbedde1c677facae80003a/fbd2c/schematic.jpg 1180w,
/tech-blog/static/2171b96c8cbbedde1c677facae80003a/e1596/schematic.jpg 2048w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;figcaption&gt;Schematic of the build&lt;/figcaption&gt;
&lt;h3&gt;Components&lt;/h3&gt;
&lt;p&gt;This is what I used. I’m sure you can swap out any of these parts, but this is what worked for me. The schematic I posted is written for simplicity, you’ll need to read the datasheets for the components you use to determine which pin is which.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Arduino Uno R3&lt;/li&gt;
&lt;li&gt;3461AS common cathode 4-digit, 7-segment (4D7S) display&lt;/li&gt;
&lt;li&gt;74HC595 shift register&lt;/li&gt;
&lt;li&gt;x4 2N3904 NPN transistors&lt;/li&gt;
&lt;li&gt;x8 220 ohm resistors (R1-R8)&lt;/li&gt;
&lt;li&gt;x4 1k ohm resistors (R9-R12)&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Component notes&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Display&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The 4D7S display I’m using actually has 8 segments per digit (with the addition of the dot).&lt;/li&gt;
&lt;li&gt;Multiplexing is required for 4D7S displays or otherwise they would need a minimum of 28 pins. Multiplexing just means we’re lighting one digit at a time so fast that it seems like they’re all lit at once.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Shift register&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I have no doubt this can be done without the shift register (using Arduino outputs to drive the segment state), but it’d use more pins and the code would be a little more verbose.&lt;/li&gt;
&lt;li&gt;The shift register takes serial data representing which pins on the chip should be on/off. So when I use Arduino’s builtin &lt;code class=&quot;language-text&quot;&gt;shiftOut&lt;/code&gt; function with &lt;code class=&quot;language-text&quot;&gt;shiftOut(dataPin, clockPin, LSBFIRST, B11000000)&lt;/code&gt;, A and B will be HIGH while C thru H will be LOW. &lt;code class=&quot;language-text&quot;&gt;LSBFIRST&lt;/code&gt; seems to specify order. &lt;code class=&quot;language-text&quot;&gt;shiftOut(dataPin, clockPin, MSBFIRST, B00000011)&lt;/code&gt; would be the same.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;SRCLR&lt;/code&gt; clears the shift register. I couldn’t get &lt;code class=&quot;language-text&quot;&gt;SRCLR&lt;/code&gt; working and it turns out I didn’t need it anyway. If unused, it needs to be connected to &lt;code class=&quot;language-text&quot;&gt;Vcc&lt;/code&gt;; otherwise it’ll be floating and you’ll see irregular flickering.&lt;/li&gt;
&lt;li&gt;I don’t know what &lt;code class=&quot;language-text&quot;&gt;OE&lt;/code&gt; is, but all the examples connected it to &lt;code class=&quot;language-text&quot;&gt;GND&lt;/code&gt; so that’s what I did too.&lt;/li&gt;
&lt;li&gt;The unused &lt;code class=&quot;language-text&quot;&gt;Qh&lt;/code&gt; is for chaining shift registers, which I didn’t need to do.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Other components&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A lot of examples omit the current limiting resistors, but it seems like you’d run the risk of blowing out an LED, transistor, or an Arduino I/O pin. &lt;a href=&quot;https://www.onetransistor.eu/2018/12/wiring-of-4digit-7segment-display.html&quot;&gt;This&lt;/a&gt; article was really helpful.&lt;/li&gt;
&lt;li&gt;The transistors amplify current so that there’s enough to evenly light up the digits. For instance if there’s not an optimal amount of current and one digit has one segment lit while another digit has every segments lit, the digit with one segment lit will be brighter.&lt;/li&gt;
&lt;li&gt;I’m not sure if I picked the best resistor values, that’s why I didn’t write them in the schematic. I know I should be able to do the math, but I couldn’t figure out how to get all of the values I needed for the formula.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Code&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;arduino&quot;&gt;&lt;pre class=&quot;language-arduino&quot;&gt;&lt;code class=&quot;language-arduino&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Digit selection to 4D7S&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; digit1 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; digit2 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; digit3 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; digit4 &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Serial to shift register&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; clockPin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; latchPin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; dataPin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;setup&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// Initialize pins out outputs&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;pinMode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;digit1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;OUTPUT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;pinMode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;digit2&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;OUTPUT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;pinMode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;digit3&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;OUTPUT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;pinMode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;digit4&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;OUTPUT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token function&quot;&gt;pinMode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;clockPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;OUTPUT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;pinMode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;latchPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;OUTPUT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;pinMode&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;dataPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;OUTPUT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; digit&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;int&lt;/span&gt; segmentData&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// Disable all digits&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;digitalWrite&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;digit1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;LOW&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;digitalWrite&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;digit2&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;LOW&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;digitalWrite&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;digit3&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;LOW&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;digitalWrite&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;digit4&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;LOW&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  
  &lt;span class=&quot;token comment&quot;&gt;// Set segment data with shift register&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;digitalWrite&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;latchPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;LOW&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;shiftOut&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;dataPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; clockPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; LSBFIRST&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; segmentData&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;digitalWrite&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;latchPin&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;HIGH&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Enable specified digit&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;digitalWrite&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;digit&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;HIGH&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Wait a bit for increased brightness&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;delay&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;loop&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// Using binary to represent each segment&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// (1 = on, 0 = off)&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// should draw: O . o&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;digit1&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; B11111100&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// big circle&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;digit2&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; B00000001&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// just the dot&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;digit3&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; B00000000&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// blank&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;digit4&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; B00111010&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// little circle&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4&gt;Code notes&lt;/h4&gt;
&lt;p&gt;We’re multiplexing, so the order of the code is important. I struggled for weeks trying to figure out why digits had a “ghosting” effect - meaning that they showed a dim residue of the shape from the previous digit. So in pseudocode the solution is:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;- Initialize variables to help legibility
- Set the pins we&apos;re using as outputs
- Loop:
  - Turn all digits off
  - Load the next digit segment data into the shift register
  - Turn the next digit on
  - Delay for a few microseconds
  - Repeat&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The binary is just a way of keeping track of what segment is on and which is off. You can use decimal or hexadecimal, but binary made the most sense to me. With &lt;code class=&quot;language-text&quot;&gt;LSBFIRST&lt;/code&gt; the order is: A-B-C-D-E-F-G-DP. So a big circle is &lt;code class=&quot;language-text&quot;&gt;B11111100&lt;/code&gt; or A1-B1-C1-D1-E1-F1-G0-DP0.&lt;/p&gt;
&lt;p&gt;The delay is important and is a fine balance. Too small of a delay and the light won’t be on long enough for it to register as being bright. Too large of a delay and you’ll see the multiplexing in action. In fact it’s a good experiment to tinker with it, just remember to turn it back.&lt;/p&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;While frustrating at times, this was a very enlightening project. In the end, I realized that I would need to separate multiplexing logic from the logic that determines the facial expression if I hope to have the expression respond to things. It seems there are chips specifically designed for multiplexing and maintaining current display state - the Max7219 seems promising in this regard. Using a chip like that would allow the microcontroller to do more complex processes without interrupting the multiplexing.&lt;/p&gt;
&lt;p&gt;Thanks for everyone who helped me! It actually took a number of people and just about every article on 4D7S with Arduino to get it through my thick skull. If I misspoke or just missed something, let me know!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[The Browser as a Medium]]></title><description><![CDATA[When we think of art we tend to think of New York museums and galleries, people pouring paint onto canvas to the sounds of bebop jazz, or…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/browser-as-a-medium/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/browser-as-a-medium/</guid><pubDate>Wed, 26 Feb 2020 20:29:13 GMT</pubDate><content:encoded>&lt;p&gt;When we think of art we tend to think of New York museums and galleries, people pouring paint onto canvas to the sounds of bebop jazz, or sculptors with rolled up sleeves and clay drying on their faces. We rarely picture computer screens being involved. Alternatively tools available to the artist might come to mind - Photoshop and Illustrator for the visual artists or Ableton and Reason for the sound artists.&lt;/p&gt;
&lt;p&gt;We’ll be taking a look at a different kind of art. Whereas photo editors might be used to make prints and digital audio workstations might be used to make songs, we’ll be looking at art where the program itself is the product.&lt;/p&gt;
&lt;p&gt;Specifically we’ll be looking through the lense of modern web browsers. Tools for making digital art have been available for decades (some notable examples being Processing and openFrameworks), but people, even people within the web development community, are often surprised by wealth of resources available to us natively in the browser.&lt;/p&gt;
&lt;h2&gt;Before We Start&lt;/h2&gt;
&lt;h3&gt;Why make art with code?&lt;/h3&gt;
&lt;p&gt;As a general rule, everyone should make art. It’s fun, therapeutic, and a great opportunity to join larger communities with similar interests. Everyone has the capacity for arts and crafts, and I’d argue that it’s a natural urge intrinsic to all people. By why digital art specifically?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;It’s expressive.&lt;/strong&gt; We have the ability to create mixed media, immersive experiences and surprising, generative pieces.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;It’s open / distributed.&lt;/strong&gt; Open web standards means people around the world can easily access and interact with your art. The web also makes international collaboration a breeze.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;It’s a great way to get better at programming.&lt;/strong&gt; Since there’s not a ton of information available on creative coding for the web, it’s a pastime that forces people to experiment with bleeding edge technology.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;It can be a viral portfolio piece.&lt;/strong&gt; People love quirky web projects, so it’s a great way to have your portfolio spread across the web dev community.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Not enough people are doing it.&lt;/strong&gt; The world needs more web art - it’ll make the world better and it will push browsers to prioritize the development of these web standards.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;JavaScript vs. Browser APIs vs. Libraries&lt;/h3&gt;
&lt;p&gt;JavaScript is a general purpose programming language. It’s standards are guided by a committee and includes functionality that is useful to all programming environment (front-end, back-end, embedded, etc). These are things like &lt;code class=&quot;language-text&quot;&gt;if&lt;/code&gt;/&lt;code class=&quot;language-text&quot;&gt;else&lt;/code&gt; statements, &lt;code class=&quot;language-text&quot;&gt;function&lt;/code&gt; declarations, &lt;code class=&quot;language-text&quot;&gt;Array.map&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;Object.keys&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Then we have environment specific APIs. It doesn’t make sense to try and access GPIO pins from a browser. Similarly it doesn’t make sense to try to access DOM nodes in an embedded environment. We’ll be talking about Browser APIs - APIs agreed upon by committees usually made up of browser developers. These APIs give web developers access to features built into the browser (usually giving access to code written in lower-level languages such as C++ or Rust).&lt;/p&gt;
&lt;p&gt;Finally there are libraries. Libraries are chunks of reusable code that extend JavaScript the language and/or environment APIs. They can be created by anyone, to any specification that they prefer. We’ll be talking about these too.&lt;/p&gt;
&lt;h2&gt;Artistic Browser APIs&lt;/h2&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 52.02702702702703%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAKABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAEDBAX/xAAWAQEBAQAAAAAAAAAAAAAAAAADAQL/2gAMAwEAAhADEAAAAdOO4yRgXP8A/8QAGBABAQADAAAAAAAAAAAAAAAAAgEAAxD/2gAIAQEAAQUCaUuturJ3/8QAFREBAQAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8Bp//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAABISD/2gAIAQEABj8CiKs//8QAGRAAAwADAAAAAAAAAAAAAAAAARARAFFx/9oACAEBAAE/IY6wmshJjjFf/9oADAMBAAIAAwAAABAoD//EABURAQEAAAAAAAAAAAAAAAAAABEQ/9oACAEDAQE/ECBP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAAMAAwEAAAAAAAAAAAAAAQARMRAhQWH/2gAIAQEAAT8QwyTd2n2E1XvdiyGTCfWYeP/Z&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Patatap Canvas API Example&quot;
        title=&quot;Patatap Canvas API Example&quot;
        src=&quot;/tech-blog/static/23f905904d5bd0c22ebbbfaf4d57ae5d/1c72d/patatap.jpg&quot;
        srcset=&quot;/tech-blog/static/23f905904d5bd0c22ebbbfaf4d57ae5d/a80bd/patatap.jpg 148w,
/tech-blog/static/23f905904d5bd0c22ebbbfaf4d57ae5d/1c91a/patatap.jpg 295w,
/tech-blog/static/23f905904d5bd0c22ebbbfaf4d57ae5d/1c72d/patatap.jpg 590w,
/tech-blog/static/23f905904d5bd0c22ebbbfaf4d57ae5d/a8a14/patatap.jpg 885w,
/tech-blog/static/23f905904d5bd0c22ebbbfaf4d57ae5d/fbd2c/patatap.jpg 1180w,
/tech-blog/static/23f905904d5bd0c22ebbbfaf4d57ae5d/eea4a/patatap.jpg 1280w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;figcaption&gt;
  &lt;a href=&quot;https://patatap.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;
    Patatap by Jono Brandel
  &lt;/a&gt;
&lt;/figcaption&gt;
&lt;h3&gt;Canvas API&lt;/h3&gt;
&lt;p&gt;The Canvas API is an API for “painting pixels” to a digital canvas - typically used for 2D art. It’s an extremely versatile and powerful tool for creating and editing raster images (images that are described in pixels). If we were to create a web version of Photoshop or MS Paint, it’d be with the Canvas API.&lt;/p&gt;
&lt;p&gt;The name of the API is very indicative of its use and makes for a great analogy. When using the Canvas API, the artist is layering “paint” (in the form of pixels, shapes, and paths) onto the canvas. The canvas can be reused just like a physical canvas can, but the paint layer has to be covered over before starting again.&lt;/p&gt;
&lt;p&gt;When looking at the underlying DOM of a Canvas API project, you’ll notice there’s just a &lt;code class=&quot;language-text&quot;&gt;&amp;lt;canvas&gt;&lt;/code&gt; DOM node. This is a strength and weakness of the API. On the one hand it’s good: it means there aren’t a lot of DOM nodes to manage so it can be a very performant way to draw graphics or images. On the other hand, since there are no DOM nodes available to us, we aren’t able to manipulate specific parts of the image; if we want to change something we have to paint over and redraw the part we want to change.&lt;/p&gt;
&lt;p&gt;However due to its performant nature, it’s still a great way to animate an image. We can &lt;code class=&quot;language-text&quot;&gt;requestAnimationFrame&lt;/code&gt;, tween the animation, and redraw at around 50 frames per second (FPS depend on a large number of factors). Also thanks to its ability to give us pixel-by-pixel information of the canvas, we’re able to do complex image manipulation with the API.&lt;/p&gt;
&lt;h4&gt;P5&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://p5js.org/&quot;&gt;p5&lt;/a&gt; is an open source (LGPL) library created by &lt;a href=&quot;https://twitter.com/laurenleemack&quot;&gt;Lauren McCarthy&lt;/a&gt; to simplify working with the Canvas API. Probably the most accessible way to get started with creative coding in JavaScript, it handles things like creating the canvas, managing the &lt;code class=&quot;language-text&quot;&gt;canvasContext&lt;/code&gt; (the interface for manipulating the canvas), and requesting animation frames - all while providing helper functions that simplify drawing and math.&lt;/p&gt;
&lt;p&gt;It does a lot of other things too, including 3D and sound, so it’s possible to build an entire career in digital art just on p5.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAADAElEQVQozx2S20/TBxTH+y/tYduTyaKLCaghjEJvtqUXOlihHQXbAm1/7Xr99f7rj/4olwpoV0cLQ0CHwQ0oRnGAiTKXuIuLJsteFh/26Ms++2UPJ59zHs7JJzlfzWC3yPL1bpxdUyj6K7ivTFO39iD7K2xOGsh5Cyr1NKbS/BjS0ghmeRLu50FMZN/fz0ZEYnVinkx/HNkQRSMaHeSvOxH0YxQtdpJmD+vCDRoRgbXwOO24wGbUx0FmmrPCOJ30FIfJCfaTQQ7jI7QTiyxF6yx4Zgn0i2harotMGHOsua7it+Z5GNFxM3OLB2EtJWEVye7k0oUFBi4mmbbV1CN21sUax4kBvi8u8CxjoiU2WYl/jfzFLBqvSaI5oiVqi9MK2LiVrrIdG2IlLTFjV/jsowKGjzPoPyxj+SBGRCvzTDRyUK5ymrayJRZo5nbUvSaNZBNN2hGg7rKSGQmzk/CyGs9xP+6mJixR7AmQu5ai2hNm7lqM+tUwy11+Nqei7GZjdJLDtFIV7qWy1JPrNMVv0OyMXsJnKnDvRi/KV3X2ogbmUjd5NKNl2xjmB72HXV2IJwOjHOmCnPSNshcsc17UsyHWeZXtVc3qat9kI7+GJmjPs+AysyW4OStZ2K8InJYcdApeXg+P8eeg6//62/Y57ywO3pnHeJPo4kwJ8LJs4XzWw4Gi0MrdZjnTRiMMRph3qHHwDfO8oOVQDvGi0Md3UpS/Ir28d46BRce/ZjsYTPyjRujXqo4T2c8v5V6OKyolE9vlddayquGW+xM8liLHgQvsySl+ynWxW8nwc6Gbh0qS17E+3rhdvP+yj7fpML+XPuXpfIo/Spc5nkvzVrrMU5XtfJPV/LeqoS3K0vAQLZ+eo7SRx7OTnEhDdCSfSicd2cujipOXi+P8tujgXBnnhWTledXLK9nCWcXNaVVgu7TC7UwLzYQxwbJrgElTnLbfjCIo3J2xUhVq3A1ZkUIVdmbMNBNV9gUjdxJl9mNmNtMy90MmGup8pD6yFrtDyTvPf9EVPqZcDiH5AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Tangara Fastuosa SVG Example&quot;
        title=&quot;Tangara Fastuosa SVG Example&quot;
        src=&quot;/tech-blog/static/3903a0e2f0c075d30a3ab2bc3ccdef58/fcda8/tangara-fastuosa.png&quot;
        srcset=&quot;/tech-blog/static/3903a0e2f0c075d30a3ab2bc3ccdef58/12f09/tangara-fastuosa.png 148w,
/tech-blog/static/3903a0e2f0c075d30a3ab2bc3ccdef58/e4a3f/tangara-fastuosa.png 295w,
/tech-blog/static/3903a0e2f0c075d30a3ab2bc3ccdef58/fcda8/tangara-fastuosa.png 590w,
/tech-blog/static/3903a0e2f0c075d30a3ab2bc3ccdef58/efc66/tangara-fastuosa.png 885w,
/tech-blog/static/3903a0e2f0c075d30a3ab2bc3ccdef58/c83ae/tangara-fastuosa.png 1180w,
/tech-blog/static/3903a0e2f0c075d30a3ab2bc3ccdef58/f581c/tangara-fastuosa.png 3072w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;figcaption&gt;
  &lt;a href=&quot;https://vimeo.com/282220342&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;
    Tangara Fastuosa by Sarah GHP
  &lt;/a&gt;
&lt;/figcaption&gt;
&lt;h3&gt;SVG&lt;/h3&gt;
&lt;p&gt;Less an API than an addition to the HTML standard, SVG (Scalable Vector Graphics) is a way of describing 2D graphics; in this case vector graphics. Vector images differ from raster images in that rather than describe images on a pixel-by-pixel basis they describe images with shapes primitives. While you might use the Canvas API to make a web equivalent of Photoshop, you’d use the SVG standard to make a web equivalent of Illustrator.&lt;/p&gt;
&lt;p&gt;If you know HTML and CSS, you already know SVG. SVG is just a collection of DOM tags that describe shapes that can be styled with CSS. For instance there’s a &lt;code class=&quot;language-text&quot;&gt;&amp;lt;circle&gt;&lt;/code&gt; for round ellipses and circles, &lt;code class=&quot;language-text&quot;&gt;&amp;lt;rect&gt;&lt;/code&gt; for squares and rectangles, and &lt;code class=&quot;language-text&quot;&gt;&amp;lt;path&gt;&lt;/code&gt; for arbitrary shapes. They can also contain text or images. Similar to Illustrator, you can group shapes (with the &lt;code class=&quot;language-text&quot;&gt;&amp;lt;g&gt;&lt;/code&gt; tag) to manipulate them together.&lt;/p&gt;
&lt;p&gt;Since these are just DOM nodes, they can be animated with CSS transitions or keyframes. More complex behavior can be programmed with JavaScript using &lt;code class=&quot;language-text&quot;&gt;requestAnimationFrame&lt;/code&gt; or an animation library. They can be themed with different CSS classes or resized with CSS media queries.&lt;/p&gt;
&lt;p&gt;The strengths and weaknesses foil those of the Canvas API. All the DOM nodes are there to be pushed around or modified, but manipulating the DOM directly is process intensive. We gain flexibility at the cost of performance. This isn’t much of a problem for simple graphics, but for complex animations or graphics with hundreds of layers it’ll likely be better to use the Canvas API.&lt;/p&gt;
&lt;h4&gt;d3&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://d3js.org/&quot;&gt;d3&lt;/a&gt; is an open source (BSD) library created by &lt;a href=&quot;https://twitter.com/mbostock&quot;&gt;Mike Bostock&lt;/a&gt; that controls SVG generation and provides useful math functionality. It’s used primarily for advanced data visualizations. While d3 should not be someone’s first introduction to SVG (SVG is easy enough to get started with directly), d3 is an amazing tool to generate complex graphics and behaviors with SVG.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 54.72972972972974%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA70lEQVQoz5WSWRKCMAxAuT0KWkBA5MvLqaypR4hJsAOlVfEjk255fYEG+qxQX1LU5RGhODjZxDSnoKx5jbMnArfIzrrOpFjm7zBQA4HFOFjSwXeoSua1cjY04LVxsFaGhcFILfb5AVuKjmKQTnhvAj1z19hraKAMa9IdPpIQbyrE4RTRJbxH5/iia4JDrWQM31oGsSOrbI8dwbo0lPGQx2IqxVuBxg6ouCdIT3lkM7alVpssEjBbbmrZsmQYg0uFHcHYsicg/PtTlnBu/U6wli3FNLasYFX38Rta1txiETsd+N7wT0Pr/Xneq7VWpfgC6YKe94/0HFUAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Bellwoods WebGL Example&quot;
        title=&quot;Bellwoods WebGL Example&quot;
        src=&quot;/tech-blog/static/cde58bbb239bef31f4f46393a4931016/fcda8/bellwoods.png&quot;
        srcset=&quot;/tech-blog/static/cde58bbb239bef31f4f46393a4931016/12f09/bellwoods.png 148w,
/tech-blog/static/cde58bbb239bef31f4f46393a4931016/e4a3f/bellwoods.png 295w,
/tech-blog/static/cde58bbb239bef31f4f46393a4931016/fcda8/bellwoods.png 590w,
/tech-blog/static/cde58bbb239bef31f4f46393a4931016/efc66/bellwoods.png 885w,
/tech-blog/static/cde58bbb239bef31f4f46393a4931016/c83ae/bellwoods.png 1180w,
/tech-blog/static/cde58bbb239bef31f4f46393a4931016/d6853/bellwoods.png 3070w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;figcaption&gt;
  &lt;a href=&quot;https://bellwoods.xyz/&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;
    Bellwoods by Matt DesLauriers
  &lt;/a&gt;
&lt;/figcaption&gt;
&lt;h3&gt;WebGL&lt;/h3&gt;
&lt;p&gt;WebGL (Web Graphics Library) is an API for generating 3D graphics in the browser. It is as wonderful as it is difficult. This is no fault of WebGL - 3D graphics are difficult to work with in general. The 3D artist has to account for perspective, lighting, materials, and geometries among many other things. However the payoff for working with WebGL can be immense. While writing this, I took a quick peek at &lt;a href=&quot;https://www.awwwards.com/&quot;&gt;awwwards&lt;/a&gt; and the first 6 sites they listed were built using WebGL. WebGL is the stuff dreams are made of.&lt;/p&gt;
&lt;p&gt;At the most fundamental level, when working directly with WebGL, you’ll be working with shaders. Shaders are programs written in a C-like language that determine where each pixel should be in a 3D space and the color the pixel should be based on a number of factors.&lt;/p&gt;
&lt;p&gt;While WebGL is pretty standard now, a lot of devices still struggle with it. The fans on most MacBooks will sound like they’re lifting off for an interstellar space mission and phones can hang or blow up. Be smart with WebGL and only re-render when there’s a reason to re-render. Actually this is just good advice for any type of re-rendering.&lt;/p&gt;
&lt;p&gt;I could go on like I know what I’m talking about, but I would recommend skipping right past vanilla WebGL and starting with THREE.&lt;/p&gt;
&lt;h4&gt;THREE&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://threejs.org/&quot;&gt;THREE&lt;/a&gt; is an open source (MIT) library created by &lt;a href=&quot;https://twitter.com/mrdoob&quot;&gt;Ricardo Cabello&lt;/a&gt; that creates a much friendlier WebGL development experience. THREE gives you constructors for cameras with differing perspectives, geometries/materials/meshes, and different types of lights. It’ll handle rendering for you so all you need to manage is animation frames and tweening - things that can be outsourced to animation libraries.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAACWElEQVQoz02SW1OSURSGvW5M84zCdz7yneADBBQZUREU0xS1crSsMSdTU9Qs66aL/kHTZdNffdrBlF2smz2znr2e9a6+u0mJG93mV+ea62qNpQf9tFSdJcOipKp4KQkpkSCRSJFM2kipDIo8i67WGRlaII5e8en2J6X8R9TkJX2fpxQ6ksaXSpXXdprlh4Ns2A6rUUTVdcmZFpYAa5qJYURoVhHbquHYK4yPLGFoT1mYv8Wz32PIVwKYVLgUdWrY7KcUmoNDtGybwzGXRdkiMg0MVUFSNNEcsOHUcY15TKPBxGgdOdnGc95gaaeYyl9gSuXCCzkQTQ0BfCymWjfTVIV21jDYM4uElo9pZ5n25nHEhKa+zMRYHUXaJhu+wzYEsDvhH2UBvMkVONQtGgOP2LAcWpkMc0J92nGZC2N88WEQlAiieXJxizBYZ3x0CU3ZpTx9gWue3ytfTMkcTUk8m5jqKm+6abYKRZq5HAu5vFh8iOsFBOlp2uMVSpkW2XirO2EysYkqvUCXT4TyNX13kzLXmsWPo2MuypVuytt+yE55hmapyNlITM3NYns+gV8kTlcpxGsUC7uMDi8S+i85Pfku3j6gpbopy1zJOt9W1zj2I+r9A7T9gO1SmZV8gUWhGwltVaTsujnCTI2ZSpvZmefdlB1zjyfrXwnTl+hS5z6UTpjlQNa6O9zyesCm0K3me8pBkCGKypSKTeozO1Tn9sUOe6Hk4zNs/f+URZ07HvuS2gOmfdrFEo04RzUbi6MV0LhAJp6lkm9wNdykVt5jfKx3NpH/9h/wN47HRZl5YT/2AAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Latent Cycles Web Audio Example&quot;
        title=&quot;Latent Cycles Web Audio Example&quot;
        src=&quot;/tech-blog/static/c94a153d5db0157065b932716fd968f2/fcda8/latent-cycles.png&quot;
        srcset=&quot;/tech-blog/static/c94a153d5db0157065b932716fd968f2/12f09/latent-cycles.png 148w,
/tech-blog/static/c94a153d5db0157065b932716fd968f2/e4a3f/latent-cycles.png 295w,
/tech-blog/static/c94a153d5db0157065b932716fd968f2/fcda8/latent-cycles.png 590w,
/tech-blog/static/c94a153d5db0157065b932716fd968f2/efc66/latent-cycles.png 885w,
/tech-blog/static/c94a153d5db0157065b932716fd968f2/c83ae/latent-cycles.png 1180w,
/tech-blog/static/c94a153d5db0157065b932716fd968f2/d6853/latent-cycles.png 3070w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;figcaption&gt;
  &lt;a href=&quot;https://codepen.io/teropa/full/rdoPbG&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;
    Latent Cycles by Tero Parviainen
  &lt;/a&gt;
&lt;/figcaption&gt;
&lt;h3&gt;Web Audio API&lt;/h3&gt;
&lt;p&gt;The Web Audio API is a tool useful for playing audio files, analyzing audio, and generating audio. Playing audio has its uses for streaming music or for game development. Analyzing audio can be useful for creating visualizers or for machine learning purposes (think of having a chat bot that you can actually talk to). What excites me the most however is that all modern browser have a fully functioning synthesizer in them!&lt;/p&gt;
&lt;p&gt;The API provides low-level building blocks such as &lt;code class=&quot;language-text&quot;&gt;OscillatorNode&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;GainNode&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;BiquadFilterNode&lt;/code&gt;, and &lt;code class=&quot;language-text&quot;&gt;DelayNode&lt;/code&gt; that can be used to create oscillators, envelope generators, amplifiers, filters, delays, and reverbs. Imagine being able to control a big Moog-style modular synthesizer with JavaScript - that’s now a reality. &lt;/p&gt;
&lt;p&gt;Working with the Web Audio API can be a little tough, but groups are starting to come together to build web-based digital audio workstations, plugin effect and instrument standards, and experimental projects combining machine learning and browser-specific interfaces. It’s likely we’ll see something akin to Ableton Live in the browser before too long.&lt;/p&gt;
&lt;h4&gt;Tone&lt;/h4&gt;
&lt;p&gt;&lt;a href=&quot;https://tonejs.github.io/&quot;&gt;Tone&lt;/a&gt; is an open source (MIT) library created by &lt;a href=&quot;https://twitter.com/yotammann&quot;&gt;Yotam Mann&lt;/a&gt; that abstracts away a lot of the low level Web Audio API into virtual modules that can be combined into instruments. In fact, the library comes with several pre-built synths such as a &lt;code class=&quot;language-text&quot;&gt;FMSynth&lt;/code&gt; and a &lt;code class=&quot;language-text&quot;&gt;PolySynth&lt;/code&gt;. It also handles a lot of the general complexity that comes with music programming such as timing and note-to-frequency conversions.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; &quot;
    &gt;
      &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 52.02702702702703%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAACfklEQVQozzWPWUiUYRSGfykrptK0TEsUZxz3JZ3FcsuQoCDL0mwzKluwm6CrNogwwkQjpCy6SMvSnBRTWlDS0jGX0cnSxrUsClLCgrwqyP55+v5/8uLhnO8czsP7SdpIE9pIo8qqCDN++jgC9bHoQ2LRRZkIEvvwaANfti2HnCXI2R5wTOsiX+8ixxOyl8JODyRdlBGFoCgze+NCOJOXRc6J42iOnEQfYxZCoxAaXcIsDXKuL9zYC8VboWyPqz+wGnYsdgmDo00o6GMS6Ej34mVJPoWWm0ildwk1JKnJI2JMfM5cIVJomD3oj1yajXwzF7niKHL5YeS8AOQskV4klQLC4lHwDzNgjogkPTUV08bNeKdtIVCZh8YTHB7HZIb41vYFsNsLSjLg8ia4milS7oL9KyFzoUipQVqbkobCOoEheQNrElIwmBNJSkhUZwnJaaSkrufNvhCmDwXx9UAQU3l6pg7qBFq1nxR1Dmm6rxyF73PVfodpwTelivcPwWRvBcYXrXi1WPFrteLT1oVPu6CtU+19W9oFVhWJj7WoTFgYbCrFVl+E7VExvY0lyGM18KmW2Yk6Au0DSLZxpC4H7g+e4F79mHm1Tbjfb0TqGRG7UYGoypH83oLsqMT57DzO5gLkhtM4G04hj1TBeA2/xiwE99jVQ01zBwFnL+B9/TZ+F4vxP1fAvOfduPU4cOscRHKKA6cQMlrN0NMr2BuKsNddor++kD/DQvjBwu9xCzrba6TuYeZb+/Esq2BRVSOet+6x7Npt5je9EumGRfp3/4UChHRm4D4/31YyM6jUe/xV5zVC+BCtrV8cDOHW7UDqE9/rGULqHXWh9IpM7P4Br9D1Iu0yw0cAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;A Single Div CSS Example&quot;
        title=&quot;A Single Div CSS Example&quot;
        src=&quot;/tech-blog/static/de01ebc5bd346291f07b1a2deea8ef94/fcda8/single-div.png&quot;
        srcset=&quot;/tech-blog/static/de01ebc5bd346291f07b1a2deea8ef94/12f09/single-div.png 148w,
/tech-blog/static/de01ebc5bd346291f07b1a2deea8ef94/e4a3f/single-div.png 295w,
/tech-blog/static/de01ebc5bd346291f07b1a2deea8ef94/fcda8/single-div.png 590w,
/tech-blog/static/de01ebc5bd346291f07b1a2deea8ef94/efc66/single-div.png 885w,
/tech-blog/static/de01ebc5bd346291f07b1a2deea8ef94/c83ae/single-div.png 1180w,
/tech-blog/static/de01ebc5bd346291f07b1a2deea8ef94/d6853/single-div.png 3070w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;figcaption&gt;
  &lt;a href=&quot;https://a.singlediv.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener noreferrer&quot;&gt;
    A Single Div by Lynn Fisher
  &lt;/a&gt;
&lt;/figcaption&gt;
&lt;h3&gt;CSS&lt;/h3&gt;
&lt;p&gt;People like to lament about working with CSS (Cascading Style Sheets), so much so that it’s almost a rite of passage in the web dev community. However CSS is amazingly powerful with baked-in support for transitions, animations, and responsive behavior. Now that we have Flexbox and CSS Grid, we have even more tools available to us to create beautiful and responsive pieces without needing to venture into the world or JavaScript.&lt;/p&gt;
&lt;p&gt;On top of which making CSS art is a great way to sharpen your web dev skills, and the intrinsic limitations will sharpen your creative muscles.&lt;/p&gt;
&lt;h2&gt;Other Browser APIs&lt;/h2&gt;
&lt;p&gt;There are plenty of other APIs available or soon-to-be available to the artists of the web. Here are a few:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Gamepad API:&lt;/strong&gt; use a standard video controller to control your game or installation.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Web MIDI API:&lt;/strong&gt; (Musical Instrument Digital Interface) use a keyboard, drum pad, or other MIDI device to control your web synth or interactive piece.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Web Bluetooth API:&lt;/strong&gt; an experimental API that could be used trigger interactive elements in an installation.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;WebXR API:&lt;/strong&gt; an experimental API for developing VR (virtual reality) or AR (augmented reality) experiences.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Machine Learning and Web Art&lt;/h2&gt;
&lt;p&gt;This is a whole other topic, but I couldn’t talk about digital art without bringing up two very cool libraries that help make machine learning available to web artists.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;a href=&quot;https://ml5js.org/&quot;&gt;ml5&lt;/a&gt;&lt;/strong&gt; is an open source (MIT) library created by &lt;a href=&quot;https://twitter.com/ahandvanish&quot;&gt;Hannah Davis&lt;/a&gt; and built on Google’s TensorFlow to simplify working with models in the web. Leans more towards visual models.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;a href=&quot;https://magenta.tensorflow.org/&quot;&gt;Magenta&lt;/a&gt;&lt;/strong&gt; is an open source (Apache License 2.0) library created by Google and built on Google’s TensorFlow. It has several handy composition models leaning towards the audio side of things.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Additional Resources&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;a href=&quot;https://www.youtube.com/channel/UCvjgXvBlbQiydffZU7m1_aw&quot;&gt;The Coding Train&lt;/a&gt;&lt;/strong&gt; a great YouTube channel that dives into Processing, p5, and ml5 among other things.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;a href=&quot;https://thebookofshaders.com/&quot;&gt;The Book of Shader&lt;/a&gt;&lt;/strong&gt; a free, online book that walks readers through the usage of fragment shaders in WebGL.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;a href=&quot;https://webaudioapi.com/book/&quot;&gt;Web Audio API&lt;/a&gt;&lt;/strong&gt; a free, online book that goes through some basic uses for the Web Audio API. Doesn’t cover much synthesis, but touches on playback and analysis.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Thanks for reading. If this talk inspired you to try out some Browser APIs in your own creative practice, I’d love to see what you made!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Guiding Principles of Austin Code Mentorship]]></title><description><![CDATA[Within a couple of months after starting Austin Code Mentorship, our now co-organizer Alex Doll contacted me offering to provide support. At…]]></description><link>https://gatsby-starter-blog-demo.netlify.com/acm-principles/</link><guid isPermaLink="false">https://gatsby-starter-blog-demo.netlify.com/acm-principles/</guid><pubDate>Wed, 22 Jan 2020 20:29:13 GMT</pubDate><content:encoded>&lt;p&gt;Within a couple of months after starting &lt;a href=&quot;https://www.meetup.com/Austin-Code-Mentorship&quot;&gt;Austin Code Mentorship&lt;/a&gt;, our now co-organizer &lt;a href=&quot;https://www.linkedin.com/in/alexander-doll/&quot;&gt;Alex Doll&lt;/a&gt; contacted me offering to provide support. At the time I was terrified of the offer. I was afraid that without a strong focus, the group would collapse into an aimless social group of clicks and language-bashing and I was worried that distributing responsibility would lead to a “design by committee”-style catastrophe. ACM was inspired by Portland’s long-running &lt;a href=&quot;https://www.meetup.com/Mentorship-Saturdays/&quot;&gt;Mentorship Saturdays&lt;/a&gt; and I wanted to create a similarly encouraging and welcoming community. While I had a general idea of what I wanted the group to stand for, I hadn’t ever organized these thoughts into cohesive directives. &lt;/p&gt;
&lt;p&gt;I didn’t respond to Alex for several days. Instead I took time to analyze what I liked about Mentorship Saturdays and what I considered “success” for Austin Code Mentorship. Eventually I responded with an outline of four ideals that really all boiled down to one core goal: to try to make Austin Code Mentorship as inclusive as possible to everyone interested in programming.&lt;/p&gt;
&lt;p&gt;Recently these guiding principles came up again with another member of the group. That, plus our group passing 2000 members, made me think that it might be beneficial to share an outline of these ideals with the members of Austin Code Mentorship.&lt;/p&gt;
&lt;h2&gt;Four Guiding Principles&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Inclusive:&lt;/strong&gt; We want to create a safe, welcoming environment for anyone interested in programming. We recognize that inclusivity means more than just opening the door - it’s a lofty and worthy goal that requires proactive attention. It affects everything we do and everyone involved.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Language agnostic:&lt;/strong&gt; While we think groups that specialize are great, we also think there’s great value in chatting with someone from a different tech stack. People can take over rooms and do talks about niche tech, but those are opt-in activities for people rather than the default.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Loosely structured:&lt;/strong&gt; Similarly, we think hackathons and lectures are invaluable resources for developing as a developer; however they can be daunting to newbies or irrelevant to people in different stacks.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Everyone’s a mentor, everyone’s a mentee:&lt;/strong&gt; We believe everyone has something to contribute to the community. Even people who haven’t written a single line of code can give feedback on projects or just provide encouragement to others. At the same time, we believe everyone still has something to learn.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As you can see, these all circle back to inclusivity - inclusive of people, their tech preference, and their level of experience.&lt;/p&gt;
&lt;h2&gt;Inclusivity’s Effect on Structure&lt;/h2&gt;
&lt;p&gt;Just to illustrate how Austin Code Mentorship is almost self-organizing once there’s a clear priority in place, I wanted to detail how we made some of our decisions.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;We start each event with introductions. This is to reinforce everyone’s value and contribution to the group as well as helps us find people to chat with later.&lt;/li&gt;
&lt;li&gt;People are welcome to come and go as they need to. We realize that people have families and lives outside of tech. We also realize that there are introverts that don’t like doing the introductions: that’s cool too.&lt;/li&gt;
&lt;li&gt;We don’t charge members ever. This can be prohibitive to people who are currently struggling with finances and thus non-inclusive. We believe in socioeconomic inclusivity, especially since many of our members are working on improving their socioeconomic position.&lt;/li&gt;
&lt;li&gt;Our events are on Saturday mornings. Not everyone can make it, but we feel like it’s a time when a majority of people are off from work, when traffic is a little more bearable, and still gives people most of their weekend. Plus this gives an alternative to the typical weekday afternoon tech event.&lt;/li&gt;
&lt;li&gt;Our events repeat like clockwork: every first Saturday of the month from 10am-2pm, except December. This helps people plan accordingly and anticipate future events.&lt;/li&gt;
&lt;li&gt;We don’t organize lectures as we like to keep things language agnostic and loosely structured. However since it &lt;em&gt;&lt;strong&gt;is&lt;/strong&gt;&lt;/em&gt; loosely structured and everyone’s a mentor, we’re happy when members take a room over to make a presentation - as long as there’s still space for others to do their own thing.&lt;/li&gt;
&lt;li&gt;We work hard at crafting language and branding that is inclusive. This affects our aesthetic more than any other factor.&lt;/li&gt;
&lt;li&gt;We realize there is no true inclusivity. Paradoxically, to be inclusive means being non-inclusive of those that are non-inclusive. With every rule there are exceptions. That’s why we encourage all members to read our &lt;a href=&quot;https://berlincodeofconduct.org/&quot;&gt;code of conduct&lt;/a&gt; so they know in advance what behavior is acceptable.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We’re not perfect. In fact we are quite imperfect. We try, we fail, and we try again. However having codified principles helps us keep focused on what’s important when things start to get foggy.&lt;/p&gt;
&lt;p&gt;I’m very grateful to be a part of a community that shares these ideals. Alex was on-board with these core values from the beginning and we’ve only grown in the number of people who take these principles to heart.&lt;/p&gt;</content:encoded></item></channel></rss>